(function(e,b){b.dataexplorer=b.dataexplorer||{};b.dataexplorer.filter=b.dataexplorer.filter||{};var a=b.dataexplorer.filter.wizard=b.dataexplorer.filter.wizard||{};var d=new b.RestClient();a.openFilterWizardModal=function(i,h){var j=g(h);c(i,h,j);j.modal("show")};function g(h){e("#filter-wizard-modal").remove();var i=e("#filter-wizard-modal");var j=Handlebars.compile(e("#filter-wizard-modal-template").html());i=e(j({}));f(i,h);return i}function f(i,h){e(".filter-wizard-apply-btn",i).unbind("click");e(".filter-wizard-apply-btn",i).click(function(){var j=b.dataexplorer.filter.createFilters(e("form",i));e(document).trigger("updateAttributeFilters",{filters:j})});i.unbind("shown.bs.modal");i.on("shown.bs.modal",function(){e("form input:visible:first",i).focus()});i.unbind("keypress");i.keypress(function(j){if(j.which==13){j.preventDefault();e(".filter-wizard-apply-btn",i).click()}})}function c(i,h,j){var l=e(".filter-wizard",j);if(l.data("bootstrapWizard")){e.removeData(l.get(0))}var k=[];var m=[];var n=b.getCompoundAttributes(i.attributes,d);n.unshift(i);e.each(n,function(q,s){var p=s.name+"-tab";var o=s.label||s.name;k.push('<li><a href="#'+p+'" data-toggle="tab">'+o+"</a></li>");var t=e('<div class="tab-pane'+(q===0?' active"':'"')+' id="'+p+'">');var r=e('<div class="well filter-wizard-fixed-height"></div>');e.each(s.attributes,function(u,v){if(v.fieldType!=="COMPOUND"&&v.visible){r.append(b.dataexplorer.filter.createFilter(v,h[v.href],true))}});t.append(r);m.push(t)});if(n.length>1){e(".wizard-steps",l).show();e(".wizard-steps",l).html(k.join(""));e(".pager",l).show()}else{e(".wizard-steps",l).hide();e(".pager",l).hide()}e(".tab-content",l).html(m);e("#filter-wizard-modal ul.pager.wizard").html('<li class="previous"><a href="#">Previous</a></li><li class="next"><a href="#">Next</a></li>');l.bootstrapWizard({tabClass:"wizard-steps nav nav-pills",onTabShow:function(s,o,q){var p=o.find("li").length;var r=q+1;if(p===1){l.find(".pager .previous").hide();l.find(".pager .next").hide()}else{if(r===1){l.find(".pager .previous").hide();l.find(".pager .next").show()}else{if(r>1&&r<p){l.find(".pager .previous").show();l.find(".pager .next").show()}else{if(r===p&&r>1){l.find(".pager .previous").show();l.find(".pager .next").hide()}else{l.find(".pager .previous").hide();l.find(".pager .next").hide()}}}}}})}})($,window.top.molgenis=window.top.molgenis||{});