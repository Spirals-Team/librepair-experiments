<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_121) on Tue May 29 07:27:07 CEST 2018 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>org.matsim.core.mobsim.qsim.qnetsimengine (MATSim 0.11.0-SNAPSHOT API)</title>
<meta name="date" content="2018-05-29">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="org.matsim.core.mobsim.qsim.qnetsimengine (MATSim 0.11.0-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">MATSim API</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/matsim/core/mobsim/qsim/pt/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/linkspeedcalculator/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/matsim/core/mobsim/qsim/qnetsimengine/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;org.matsim.core.mobsim.qsim.qnetsimengine</h1>
<div class="docSummary">
<div class="block"> From a recent email</div>
</div>
<p>See:&nbsp;<a href="#package.description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/NetsimEngine.html" title="interface in org.matsim.core.mobsim.qsim.qnetsimengine">NetsimEngine</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/QLaneI.html" title="interface in org.matsim.core.mobsim.qsim.qnetsimengine">QLaneI</a></td>
<td class="colLast">
<div class="block">Interface for QLanes, which (can) make up the QLinks.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/QLaneI.VisData.html" title="interface in org.matsim.core.mobsim.qsim.qnetsimengine">QLaneI.VisData</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/QLinkI.html" title="interface in org.matsim.core.mobsim.qsim.qnetsimengine">QLinkI</a></td>
<td class="colLast">
<div class="block">Contains all the logic for the QLinks which make up the QNetwork.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/QLinkImpl.LaneFactory.html" title="interface in org.matsim.core.mobsim.qsim.qnetsimengine">QLinkImpl.LaneFactory</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/QNetsimEngine.NetsimInternalInterface.html" title="interface in org.matsim.core.mobsim.qsim.qnetsimengine">QNetsimEngine.NetsimInternalInterface</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/TurnAcceptanceLogic.html" title="interface in org.matsim.core.mobsim.qsim.qnetsimengine">TurnAcceptanceLogic</a></td>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/ConfigurableQNetworkFactory.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">ConfigurableQNetworkFactory</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/DefaultQNetworkFactory.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">DefaultQNetworkFactory</a></td>
<td class="colLast">
<div class="block">The idea here is that there are the following levels:
  Run-specific objects, such as <a href="../../../../../../org/matsim/core/config/groups/QSimConfigGroup.html" title="class in org.matsim.core.config.groups"><code>QSimConfigGroup</code></a>, <a href="../../../../../../org/matsim/core/api/experimental/events/EventsManager.html" title="interface in org.matsim.core.api.experimental.events"><code>EventsManager</code></a>, etc.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/DefaultSignalizeableItem.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">DefaultSignalizeableItem</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/DefaultTurnAcceptanceLogic.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">DefaultTurnAcceptanceLogic</a></td>
<td class="colLast">
<div class="block">this class checks whether turning is physically possible, i.e.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/NetsimEngineContext.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">NetsimEngineContext</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/QLanesNetworkFactory.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">QLanesNetworkFactory</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/QLinkImpl.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">QLinkImpl</a></td>
<td class="colLast">
<div class="block">Please read the docu of QBufferItem, QLane, QLinkInternalI (arguably to be renamed
 into something like AbstractQLink) and QLinkImpl jointly.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/QLinkImpl.Builder.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">QLinkImpl.Builder</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/QLinkLanesImpl.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">QLinkLanesImpl</a></td>
<td class="colLast">
<div class="block">Please read the docu of QBufferItem, QLane, QLinkInternalI (arguably to be renamed into something
 like AbstractQLink) and QLinkImpl jointly.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/QNetsimEngine.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">QNetsimEngine</a></td>
<td class="colLast">
<div class="block">Coordinates the movement of vehicles on the links and the nodes.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/QNetsimEngineModule.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">QNetsimEngineModule</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/QNetsimEnginePlugin.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">QNetsimEnginePlugin</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/QNetwork.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">QNetwork</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/QNetworkFactory.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">QNetworkFactory</a></td>
<td class="colLast">
<div class="block">The current design idea of this is as follows:
  It is now possible to inject this.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/QVehicle.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">QVehicle</a></td>
<td class="colLast">
<div class="block">The ``Q'' implementation of the MobsimVehicle.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/RunConfigurableQNetworkFactoryExample.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">RunConfigurableQNetworkFactoryExample</a></td>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/RunFlexibleQNetworkFactoryExample.html" title="class in org.matsim.core.mobsim.qsim.qnetsimengine">RunFlexibleQNetworkFactoryExample</a></td>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Enum Summary table, listing enums, and an explanation">
<caption><span>Enum Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Enum</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/TurnAcceptanceLogic.AcceptTurn.html" title="enum in org.matsim.core.mobsim.qsim.qnetsimengine">TurnAcceptanceLogic.AcceptTurn</a></td>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package.description">
<!--   -->
</a>
<h2 title="Package org.matsim.core.mobsim.qsim.qnetsimengine Description">Package org.matsim.core.mobsim.qsim.qnetsimengine Description</h2>
<div class="block"><h3> From a recent email </h3>
 
 Hallo,

Habe QNetworkFactory und related restrukturiert.  

Im Grunde sieht's jetzt m.E. ganz gut aus, aber es ging wie meistens nicht ganz so, wie ich mir das gedacht hatte, und dann wurde die Zeit etwas knapp.

Im Prinzip:

QLaneI

... wird hineingesteckt in ...

QLinkI

Die zentralen Service-Implementations davon sind

 QueueWithBuffer

und

 AbstractQLink bzw. QLinkImpl

In beiden Fällen gibt es Builder, um die (jetzt recht vielen) constructor-parameters abzufangen.

In den meisten Fällen baut die QNetworkFactory erst eine QLaneI-Factory, und übergibt die an den QLinkI-Creator.  Das geht u.a. deswegen nicht anders, weil QLinkLanesImpl mehr als eine Instanz von QLane braucht.

Siehe DefaultQNetworkFactory und ConfigurableQNetworkFactory (bei letzterer könnte man bei Bedarf noch den einen oder anderen setter einbauen).

---

Ich habe versucht, zwischen 

 zentralen Objekten eines runs (Scenario, EventsManager)
 zentralen Objekten der Mobsim (in jeder Iteration neu)
 QLinkI-spezifischen Objekten

zu unterscheiden.

Zu letzterem habe ich auch VehicleQ und LinkSpeedCalculator gezählt; die können somit nun im Prinzip für jede Kante separat gesetzt werden.

---

Weiterhin bin ich davon ausgegangen, dass Objekte back pointer (also z.B. QLaneI auf QLinkI) haben, aber diese die back pointer nicht rausgeben.  Somit sind Verkettungen von back pointers nun nicht mehr möglich; QLane kommt bis auf QLink hoch und dann ist Schluss.  "Weiter oben" habe ich das allerdings noch nicht durchgeführt.  Generell scheint das aber zu reichen; die nötigen zentralen Objekte sind im NetsimEngineContext.

---

Wenn gewünscht, ist QNetworkFactory nun über die addOverridingModule-Syntax per guice setzbar.  Siehe <code>LinkSpeedCalculatorIntegrationTest</code> sowie Beispiele unten.

---

Gregor: M.E. könnte es sein, dass Du für "CA" nur noch QLaneI und gar nicht mehr QLink austauschen musst.  Auf jeden Fall sollte es möglich sein, "AbstractQLink" zu verwenden und damit auf zentrale Infrastruktur zurückzugreifen.  Weiß nicht, wie viel Du hier noch Zeit hast.

---

Derzeit ist das alles immer noch package-protected, weil ich es gerne ein wenig ruhen lassen würde.  

Ich hoffe, dass das alles so funktioniert, oder Ihr Euch zurecht findet.  Ich schaue morgen noch in die Email, danach erstmal nicht mehr.

Viele Grüße

Kai
 
 <h3> OLD MATERIAL, NOT CHECKED </h3>
 
 This package is <i>ancient</i> and correspondingly <i>archaic.</i>  The queue simulation was (evidently) one of the first pieces
 which had to be in place.  It then got patched up and patched up, for example by becoming more deterministic, including the public transit
 dynamics, including lanes, including signals, including "additional agents on link", etc. etc.
 <p>
 Eventually, the qnetsimengine was carved out of the monolithic mess.  Now the qnetsimengine attempts to provide a somewhat meaningful
 interface to the outside world, but internally it is still more complex than is good.
 <p>
 With respect to that public interface: The QSim needs one simengine which provides a "service network" to other pieces, where for example
 agents at activities or waiting for pt can be located, in particular for the visualizer.  This "service network" capability could, in principle, be
 moved to a separate simengine.  This would result in cleaner code ... but the provision for visualization (otfvis) would need to be
 extracted as well.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><code>RunConfigurableQNetworkFactoryExample</code>, 
<code>RunFlexibleQNetworkFactoryExample</code></dd>
</dl>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">MATSim API</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/matsim/core/mobsim/qsim/pt/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../../../../org/matsim/core/mobsim/qsim/qnetsimengine/linkspeedcalculator/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/matsim/core/mobsim/qsim/qnetsimengine/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2005&#x2013;2018. All rights reserved.</small></p>
</body>
</html>
