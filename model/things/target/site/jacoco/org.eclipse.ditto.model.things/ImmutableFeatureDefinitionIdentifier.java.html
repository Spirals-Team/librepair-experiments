<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ImmutableFeatureDefinitionIdentifier.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Eclipse Ditto :: Model :: Things</a> &gt; <a href="index.source.html" class="el_package">org.eclipse.ditto.model.things</a> &gt; <span class="el_source">ImmutableFeatureDefinitionIdentifier.java</span></div><h1>ImmutableFeatureDefinitionIdentifier.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2017 Bosch Software Innovations GmbH.
 *
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v2.0
 * which accompanies this distribution, and is available at
 * https://www.eclipse.org/org/documents/epl-2.0/index.php
 *
 * Contributors:
 *    Bosch Software Innovations GmbH - initial contribution
 */
package org.eclipse.ditto.model.things;

import static org.eclipse.ditto.model.base.common.ConditionChecker.argumentNotEmpty;
import static org.eclipse.ditto.model.base.common.ConditionChecker.checkNotNull;

import java.util.Objects;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import javax.annotation.concurrent.Immutable;
import javax.annotation.concurrent.NotThreadSafe;

/**
 * An immutable implementation of {@link org.eclipse.ditto.model.things.FeatureDefinition.Identifier}.
 */
@Immutable
final class ImmutableFeatureDefinitionIdentifier implements FeatureDefinition.Identifier {

<span class="fc" id="L30">    private static final Pattern IDENTIFIER_PATTERN = FeatureIdentifierPatternBuilder.getInstance()</span>
<span class="fc" id="L31">            .addCapturingGroup(CapturingGroup.NAMESPACE)</span>
<span class="fc" id="L32">            .addCapturingGroup(CapturingGroup.NAME)</span>
<span class="fc" id="L33">            .addCapturingGroup(CapturingGroup.VERSION)</span>
<span class="fc" id="L34">            .build();</span>

    private static final String COLON = &quot;:&quot;;

    private final String namespace;
    private final String name;
    private final String version;
    private final String stringRepresentation;

    private ImmutableFeatureDefinitionIdentifier(final CharSequence theNamespace, final CharSequence theName,
<span class="fc" id="L44">            final CharSequence theVersion) {</span>

<span class="fc" id="L46">        namespace = argumentNotEmpty(theNamespace, &quot;namespace&quot;).toString();</span>
<span class="fc" id="L47">        name = argumentNotEmpty(theName, &quot;name&quot;).toString();</span>
<span class="fc" id="L48">        version = argumentNotEmpty(theVersion, &quot;version&quot;).toString();</span>
<span class="fc" id="L49">        stringRepresentation = namespace + COLON + name + COLON + version;</span>
<span class="fc" id="L50">    }</span>

    /**
     * Returns an instance of {@code ImmutableFeatureDefinitionIdentifier}.
     *
     * @param namespace the namespace of the returned Identifier.
     * @param name the name of the returned Identifier.
     * @param version the version of the returned Identifier.
     * @return the instance.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if any argument is empty.
     */
    public static ImmutableFeatureDefinitionIdentifier getInstance(final CharSequence namespace,
            final CharSequence name, final CharSequence version) {

<span class="fc" id="L65">        return new ImmutableFeatureDefinitionIdentifier(namespace, name, version);</span>
    }

    /**
     * Parses the specified CharSequence and returns an instance of {@code ImmutableFeatureDefinitionIdentifier}.
     *
     * @param featureIdentifierAsCharSequence CharSequence-representation of an FeatureDefinition Identifier.
     * @return the instance.
     * @throws NullPointerException if {@code featureIdentifierAsCharSequence} is {@code null}.
     * @throws FeatureDefinitionIdentifierInvalidException if {@code featureIdentifierAsCharSequence} is invalid.
     */
    public static ImmutableFeatureDefinitionIdentifier ofParsed(final CharSequence featureIdentifierAsCharSequence) {
<span class="fc" id="L77">        checkNotNull(featureIdentifierAsCharSequence, &quot;CharSequence-representation of the identifier&quot;);</span>
<span class="fc" id="L78">        final Matcher matcher = IDENTIFIER_PATTERN.matcher(featureIdentifierAsCharSequence);</span>
<span class="fc bfc" id="L79" title="All 2 branches covered.">        if (!matcher.matches()) {</span>
<span class="fc" id="L80">            throw new FeatureDefinitionIdentifierInvalidException(featureIdentifierAsCharSequence);</span>
        }

<span class="fc" id="L83">        final String parsedNamespace = matcher.group(CapturingGroup.NAMESPACE);</span>
<span class="fc" id="L84">        final String parsedName = matcher.group(CapturingGroup.NAME);</span>
<span class="fc" id="L85">        final String parsedVersion = matcher.group(CapturingGroup.VERSION);</span>

<span class="fc" id="L87">        return getInstance(parsedNamespace, parsedName, parsedVersion);</span>
    }

    @Override
    public String getNamespace() {
<span class="fc" id="L92">        return namespace;</span>
    }

    @Override
    public String getName() {
<span class="fc" id="L97">        return name;</span>
    }

    @Override
    public String getVersion() {
<span class="fc" id="L102">        return version;</span>
    }

    @Override
    public boolean equals(final Object o) {
<span class="fc bfc" id="L107" title="All 2 branches covered.">        if (this == o) {</span>
<span class="fc" id="L108">            return true;</span>
        }
<span class="fc bfc" id="L110" title="All 4 branches covered.">        if (o == null || getClass() != o.getClass()) {</span>
<span class="fc" id="L111">            return false;</span>
        }
<span class="fc" id="L113">        final ImmutableFeatureDefinitionIdentifier that = (ImmutableFeatureDefinitionIdentifier) o;</span>
<span class="fc bfc" id="L114" title="All 2 branches covered.">        return Objects.equals(namespace, that.namespace) &amp;&amp;</span>
<span class="fc bfc" id="L115" title="All 2 branches covered.">                Objects.equals(name, that.name) &amp;&amp;</span>
<span class="fc bfc" id="L116" title="All 2 branches covered.">                Objects.equals(version, that.version);</span>
    }

    @Override
    public int hashCode() {
<span class="fc" id="L121">        return Objects.hash(namespace, name, version);</span>
    }

    @Override
    public int length() {
<span class="nc" id="L126">        return stringRepresentation.length();</span>
    }

    @Override
    public char charAt(final int index) {
<span class="nc" id="L131">        return stringRepresentation.charAt(index);</span>
    }

    @Override
    public CharSequence subSequence(final int start, final int end) {
<span class="nc" id="L136">        return stringRepresentation.subSequence(start, end);</span>
    }

    @Override
    public String toString() {
<span class="fc" id="L141">        return stringRepresentation;</span>
    }

    /**
     * This class provides constants for names of regex pattern capturing group.
     */
    @Immutable
    private static final class CapturingGroup {

        /**
         * Name of the capturing group for the namespace.
         */
        public static final String NAMESPACE = &quot;NAMESPACE&quot;;

        /**
         * Name of the capturing group for the name.
         */
        public static final String NAME = &quot;NAME&quot;;

        /**
         * Name of the capturing group for the version.
         */
        public static final String VERSION = &quot;VERSION&quot;;

<span class="nc" id="L165">        private CapturingGroup() {</span>
<span class="nc" id="L166">            throw new AssertionError();</span>
        }

    }

    /**
     * A mutable builder with a fluent API for a {@link Pattern} for parsing string representations of a
     * FeatureDefinitionIdentifier.
     */
    @NotThreadSafe
    private static final class FeatureIdentifierPatternBuilder {

<span class="fc" id="L178">        private static final Pattern ELEMENT_PATTERN = Pattern.compile(&quot;[_a-zA-Z0-9\\-.]+&quot;);</span>

        private final StringBuilder stringBuilder;

<span class="fc" id="L182">        private FeatureIdentifierPatternBuilder() {</span>
<span class="fc" id="L183">            stringBuilder = new StringBuilder();</span>
<span class="fc" id="L184">        }</span>

        /**
         * Returns an instance of {@code FeatureIdentifierPatternBuilder}.
         *
         * @return the instance.
         */
        public static FeatureIdentifierPatternBuilder getInstance() {
<span class="fc" id="L192">            return new FeatureIdentifierPatternBuilder();</span>
        }

        /**
         * Adds a capturing group with the specified name.
         *
         * @param elementCapturingGroupName the name of the capturing group to be added.
         * @return this builder instance to allow method chaining.
         */
        public FeatureIdentifierPatternBuilder addCapturingGroup(final CharSequence elementCapturingGroupName) {
<span class="fc bfc" id="L202" title="All 2 branches covered.">            if (0 &lt; stringBuilder.length()) {</span>
<span class="fc" id="L203">                stringBuilder.append(COLON);</span>
            }
<span class="fc" id="L205">            stringBuilder.append(&quot;(?&lt;&quot;).append(elementCapturingGroupName).append(&quot;&gt;&quot;);</span>
<span class="fc" id="L206">            stringBuilder.append(ELEMENT_PATTERN).append(&quot;)&quot;);</span>
<span class="fc" id="L207">            return this;</span>
        }

        /**
         * Returns a Pattern consisting of the named capturing groups which were added to this builder. The capturing
         * groups are delimited by {@link #COLON}.
         *
         * @return the new Pattern.
         */
        public Pattern build() {
<span class="fc" id="L217">            return Pattern.compile(stringBuilder.toString());</span>
        }

    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.0.201801022044</span></div></body></html>