<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PolicyBuilder.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Eclipse Ditto :: Model :: Policies</a> &gt; <a href="index.source.html" class="el_package">org.eclipse.ditto.model.policies</a> &gt; <span class="el_source">PolicyBuilder.java</span></div><h1>PolicyBuilder.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2017 Bosch Software Innovations GmbH.
 *
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v2.0
 * which accompanies this distribution, and is available at
 * https://www.eclipse.org/org/documents/epl-2.0/index.php
 *
 * Contributors:
 *    Bosch Software Innovations GmbH - initial contribution
 */
package org.eclipse.ditto.model.policies;

import static org.eclipse.ditto.model.base.common.ConditionChecker.checkNotNull;

import java.time.Instant;

import javax.annotation.Nullable;
import javax.annotation.concurrent.NotThreadSafe;

import org.eclipse.ditto.json.JsonPointer;

/**
 * A mutable builder for a {@link Policy} with a fluent API.
 */
@NotThreadSafe
public interface PolicyBuilder {

    /**
     * Sub-Interface extending PolicyBuilder by awareness of the {@link Label} to use.
     *
     */
    interface LabelScoped extends PolicyBuilder {

        /**
         * Returns the label the LabelScoped builder is scoped to.
         *
         * @return the label.
         */
        Label getLabel();

        /**
         * Sets the given {@link Subjects} to the specified {@code label} to this builder. All previous entries with the
         * same
         * {@code subjectId} in the {@link Label} are replaced by the specified ones.
         *
         * @param subjects the Subjects to set for the PolicyEntry identified by the {@code label}.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setSubjects(final Subjects subjects) {
<span class="nc" id="L52">            setSubjectsFor(getLabel(), subjects);</span>
<span class="nc" id="L53">            return this;</span>
        }

        /**
         * Sets the given {@link Subject} to the specified {@code label} to this builder. A previous entry with the same
         * {@code subjectId} in the {@link Label} is replaced by the specified one.
         *
         * @param issuer the SubjectId's {@code issuer}.
         * @param subject the character sequence for the SubjectId's {@code subject}.
         * @param subjectType the type of the subject to set.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setSubject(final SubjectIssuer issuer, final CharSequence subject,
                final SubjectType subjectType) {

<span class="nc" id="L69">            setSubjectFor(getLabel(), Subject.newInstance(issuer, subject, subjectType));</span>
<span class="nc" id="L70">            return this;</span>
        }

        /**
         * Sets the given {@link Subject} to the specified {@code label} to this builder. A previous entry with the same
         * {@code subjectId} in the {@link Label} is replaced by the specified one. Sets the subject type
         * to {@link SubjectType#UNKNOWN}.
         *
         * @param issuer the SubjectId's {@code issuer}.
         * @param subject the character sequence for the SubjectId's {@code subject}.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setSubject(final SubjectIssuer issuer, final CharSequence subject) {

<span class="nc" id="L85">            setSubjectFor(getLabel(), Subject.newInstance(issuer, subject));</span>
<span class="nc" id="L86">            return this;</span>
        }


        /**
         * Sets the given {@link Subject} to the specified {@code label} to this builder. A previous entry with the same
         * {@code subjectIssuerWithId} in the {@link Label} is replaced by the specified one.
         *
         * @param subjectIssuerWithId the Subject issuer + Subject ID (separated with a &quot;{@value
         * SubjectId#ISSUER_DELIMITER}&quot;) of the Subject to set.
         * @param subjectType the type of the subject to set.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setSubject(final CharSequence subjectIssuerWithId, final SubjectType subjectType) {
<span class="fc" id="L101">            setSubjectFor(getLabel(), Subject.newInstance(subjectIssuerWithId, subjectType));</span>
<span class="fc" id="L102">            return this;</span>
        }

        /**
         * Sets the given {@link Subject} to the specified {@code label} to this builder. A previous entry with the same
         * {@code subjectId} in the {@link Label} is replaced by the specified one.
         *
         * @param subject the Subject to set for the PolicyEntry identified by the {@code label}.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setSubject(final Subject subject) {
<span class="nc" id="L114">            setSubjectFor(getLabel(), subject);</span>
<span class="nc" id="L115">            return this;</span>
        }

        /**
         * Removes the subject identified by the specified {@code subjectIssuerWithId} from this builder.
         *
         * @param subjectIssuerWithId the Subject issuer + Subject ID (separated with a &quot;{@value
         * SubjectId#ISSUER_DELIMITER}&quot;) of the Subject to remove from the PolicyEntry identified by the {@code label}.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped removeSubject(final CharSequence subjectIssuerWithId) {
<span class="nc" id="L127">            removeSubjectFor(getLabel(), SubjectId.newInstance(subjectIssuerWithId));</span>
<span class="nc" id="L128">            return this;</span>
        }

        /**
         * Removes the subject identified by the specified {@code issuer} and {@code subject} from this builder.
         *
         * @param issuer the SubjectId's {@code issuer} to remove from the PolicyEntry identified by the {@code label}.
         * @param subject the character sequence for the SubjectId's {@code subject} to remove from the PolicyEntry
         * identified by the {@code label}.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped removeSubject(final SubjectIssuer issuer, final CharSequence subject) {
<span class="nc" id="L141">            removeSubjectFor(getLabel(), SubjectId.newInstance(issuer, subject));</span>
<span class="nc" id="L142">            return this;</span>
        }

        /**
         * Removes the subject identified by the specified {@code subjectId} from this builder.
         *
         * @param subjectId the Subject ID to remove from the PolicyEntry identified by the {@code label}.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped removeSubject(final SubjectId subjectId) {
<span class="nc" id="L153">            removeSubjectFor(getLabel(), subjectId);</span>
<span class="nc" id="L154">            return this;</span>
        }

        /**
         * Removes the specified {@code subject} from this builder.
         *
         * @param subject the Subject to remove from the PolicyEntry identified by the {@code label}.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped removeSubject(final Subject subject) {
<span class="nc" id="L165">            removeSubjectFor(getLabel(), subject);</span>
<span class="nc" id="L166">            return this;</span>
        }

        /**
         * Sets the given {@link Resources} to the specified {@code label} to this builder. All previous entries with
         * the same {@code resourcePath} in the {@link Label} are replaced by the specified ones.
         *
         * @param resources the Resources to set for the PolicyEntry identified by the {@code label}.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setResources(final Resources resources) {
<span class="nc" id="L178">            setResourcesFor(getLabel(), resources);</span>
<span class="nc" id="L179">            return this;</span>
        }

        /**
         * Sets the given {@link Resource} to the specified {@code label} to this builder. A previous entry with the
         * same {@code resourcePath} in the {@link Label} is replaced by the specified one.
         *
         * @param resource the Resource to set for the PolicyEntry identified by the {@code label}.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setResource(final Resource resource) {
<span class="nc" id="L191">            setResourceFor(getLabel(), resource);</span>
<span class="nc" id="L192">            return this;</span>
        }

        /**
         * Removes the resource identified by the specified {@code resourceKey} from this builder.
         *
         * @param resourceKey the ResourceKey to remove from the PolicyEntry identified by the {@code label}.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped removeResource(final ResourceKey resourceKey) {
<span class="nc" id="L203">            removeResourceFor(getLabel(), resourceKey);</span>
<span class="nc" id="L204">            return this;</span>
        }

        /**
         * Removes the specified {@code resource} from this builder.
         *
         * @param resource the Resource to remove from the PolicyEntry identified by the {@code label}.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped removeResource(final Resource resource) {
<span class="nc" id="L215">            removeResourceFor(getLabel(), resource);</span>
<span class="nc" id="L216">            return this;</span>
        }

        /**
         * Set the given {@link EffectedPermissions} on the specified {@code resourceKey} to this builder.
         *
         * @param resourceKey the ResourceKey to set the effected permissions on.
         * @param effectedPermissions the EffectedPermissions to set on the resource in the label.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setPermissions(final ResourceKey resourceKey,
                final EffectedPermissions effectedPermissions) {
<span class="nc" id="L229">            setPermissionsFor(getLabel(), resourceKey, effectedPermissions);</span>
<span class="nc" id="L230">            return this;</span>
        }

        /**
         * Set the given {@link Permissions} on the specified {@code resourceType} and {@code resourcePath}
         * as &quot;granted&quot; to this builder.
         *
         * @param resourceType the type of the Resource to set the permissions on.
         * @param resourcePath the path of the Resource to set the permissions on.
         * @param grantedPermissions the Permissions to set as &quot;grant&quot;ed on the Resource in the label.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setGrantedPermissions(final String resourceType, final CharSequence resourcePath,
                final Permissions grantedPermissions) {
<span class="nc" id="L245">            setGrantedPermissions(resourceType, JsonPointer.of(resourcePath), grantedPermissions);</span>
<span class="nc" id="L246">            return this;</span>
        }

        /**
         * Set the given {@link Permissions} on the specified {@code resourceType} and {@code resourcePath} as &quot;granted&quot;
         * to this builder.
         *
         * @param resourceType the type of the Resource to set the permissions on.
         * @param resourcePath the path of the Resource to set the permissions on.
         * @param grantedPermissions the Permissions to set as &quot;grant&quot;ed on the Resource in the label.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         * @throws IllegalArgumentException if {@code resourceType} is empty.
         */
        default LabelScoped setGrantedPermissions(final String resourceType, final JsonPointer resourcePath,
                final Permissions grantedPermissions) {

<span class="nc" id="L263">            setGrantedPermissionsFor(getLabel(), resourceType, resourcePath, grantedPermissions);</span>
<span class="nc" id="L264">            return this;</span>
        }

        /**
         * Set the given {@link Permissions} on the specified {@code resourceKey}
         * as &quot;granted&quot; to this builder.
         *
         * @param resourceKey the ResourceKey to set the permissions on.
         * @param grantedPermissions the Permissions to set as &quot;grant&quot;ed on the resource in the label.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setGrantedPermissions(final ResourceKey resourceKey, final Permissions grantedPermissions) {
<span class="nc" id="L277">            setGrantedPermissionsFor(getLabel(), resourceKey, grantedPermissions);</span>
<span class="nc" id="L278">            return this;</span>
        }

        /**
         * Set the given {@link String}s on the specified {@code resourceKey}
         * as &quot;granted&quot; to this builder.
         *
         * @param resourceKey the ResourceKey to set the permissions on.
         * @param grantedPermission the Permission to set as &quot;grant&quot;ed on the Resource in the label.
         * @param furtherGrantedPermissions further Permissions to set as &quot;grant&quot;ed on the Resource in the label.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setGrantedPermissions(final ResourceKey resourceKey, final String grantedPermission,
                final String... furtherGrantedPermissions) {

<span class="nc" id="L294">            setGrantedPermissionsFor(getLabel(), resourceKey, grantedPermission, furtherGrantedPermissions);</span>
<span class="nc" id="L295">            return this;</span>
        }

        /**
         * Set the given permissions on the specified {@code resourceType} and {@code resourcePath} as &quot;granted&quot; to
         * this builder.
         *
         * @param resourceType the type of the Resource to set the permissions on.
         * @param resourcePath the path of the Resource to set the permissions on.
         * @param grantedPermission the Permission to set as &quot;grant&quot;ed on the Resource in the label.
         * @param furtherGrantedPermissions further Permissions to set as &quot;grant&quot;ed on the Resource in the label.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         * @throws IllegalArgumentException if {@code resourceType} is empty.
         */
        default LabelScoped setGrantedPermissions(final String resourceType,
                final CharSequence resourcePath,
                final String grantedPermission,
                final String... furtherGrantedPermissions) {

<span class="fc" id="L315">            setGrantedPermissions(resourceType, JsonPointer.of(resourcePath), grantedPermission,</span>
                    furtherGrantedPermissions);
<span class="fc" id="L317">            return this;</span>
        }

        /**
         * Set the given permissions on the specified {@code resourcePath} as &quot;granted&quot; to this
         * builder.
         *
         * @param resourceType the type of the Resource to set the permissions on.
         * @param resourcePath the path of the Resource to set the permissions on.
         * @param grantedPermission the Permission to set as &quot;grant&quot;ed on the Resource in the label.
         * @param furtherGrantedPermissions further Permissions to set as &quot;grant&quot;ed on the Resource in the label.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         * @throws IllegalArgumentException if {@code resourceType} is empty.
         */
        default LabelScoped setGrantedPermissions(final String resourceType,
                final JsonPointer resourcePath,
                final String grantedPermission,
                final String... furtherGrantedPermissions) {

<span class="fc" id="L337">            setGrantedPermissionsFor(getLabel(), resourceType, resourcePath, grantedPermission,</span>
                    furtherGrantedPermissions);
<span class="fc" id="L339">            return this;</span>
        }

        /**
         * Set the given permissions on the specified {@code resourceType} and {@code resourcePath} as &quot;revoked&quot; to this
         * builder.
         *
         * @param resourceType the type of the Resource to set the permissions on.
         * @param resourcePath the path of the Resource to set the permissions on.
         * @param revokedPermissions the Permissions to set as &quot;revoke&quot;ed on the Resource in the label.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setRevokedPermissions(final String resourceType, final CharSequence resourcePath,
                final Permissions revokedPermissions) {

<span class="nc" id="L355">            setRevokedPermissions(resourceType, JsonPointer.of(resourcePath), revokedPermissions);</span>
<span class="nc" id="L356">            return this;</span>
        }

        /**
         * Set the given permissions on the specified {@code resourceType} and {@code resourcePath} as &quot;revoked&quot; to
         * this builder.
         *
         * @param resourceType the type of the Resource to set the permissions on.
         * @param resourcePath the path of the Resource to set the permissions on.
         * @param revokedPermissions the Permissions to set as &quot;revoke&quot;ed on the Resource in the label.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setRevokedPermissions(final String resourceType, final JsonPointer resourcePath,
                final Permissions revokedPermissions) {
<span class="nc" id="L371">            setRevokedPermissionsFor(getLabel(), resourceType, resourcePath, revokedPermissions);</span>
<span class="nc" id="L372">            return this;</span>
        }

        /**
         * Set the given permissions on the specified {@code resourceKey} as &quot;revoked&quot; to this builder.
         *
         * @param resourceKey the ResourceKey to set the permissions on.
         * @param revokedPermissions the Permissions to set as &quot;revoke&quot;ed on the resource in the label.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setRevokedPermissions(final ResourceKey resourceKey, final Permissions revokedPermissions) {
<span class="nc" id="L384">            setRevokedPermissionsFor(getLabel(), resourceKey, revokedPermissions);</span>
<span class="nc" id="L385">            return this;</span>
        }

        /**
         * Set the given permissions on the specified {@code resourceKey} as &quot;revoked&quot; to this builder.
         *
         * @param resourceKey the ResourceKey to set the permissions on.
         * @param revokedPermission the Permission to set as &quot;revoke&quot;ed on the Resource in the label.
         * @param furtherRevokedPermissions further Permissions to set as &quot;revoke&quot;ed on the Resource in the label.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setRevokedPermissions(final ResourceKey resourceKey, final String revokedPermission,
                final String... furtherRevokedPermissions) {
<span class="nc" id="L399">            setRevokedPermissionsFor(getLabel(), resourceKey, revokedPermission, furtherRevokedPermissions);</span>
<span class="nc" id="L400">            return this;</span>
        }

        /**
         * Set the given permissions on the specified {@code resourceType} and {@code resourcePath} as &quot;revoked&quot; to this
         * builder.
         *
         * @param resourceType the type of the Resource to set the permissions on.
         * @param resourcePath the path of the Resource to set the permissions on.
         * @param revokedPermission the Permission to set as &quot;revoke&quot;ed on the Resource in the label.
         * @param furtherRevokedPermissions further Permissions to set as &quot;revoke&quot;ed on the Resource in the label.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setRevokedPermissions(final String resourceType, final CharSequence resourcePath,
                final String revokedPermission, final String... furtherRevokedPermissions) {
<span class="fc" id="L416">            setRevokedPermissions(resourceType, JsonPointer.of(resourcePath), revokedPermission,</span>
                    furtherRevokedPermissions);
<span class="fc" id="L418">            return this;</span>
        }

        /**
         * Set the given permissions on the specified {@code resourceType} and {@code resourcePath} as &quot;revoked&quot;
         * to this builder.
         *
         * @param resourceType the type of the Resource to set the permissions on.
         * @param resourcePath the path of the Resource to set the permissions on.
         * @param revokedPermission the Permission to set as &quot;revoke&quot;ed on the Resource in the label.
         * @param furtherRevokedPermissions further Permissions to set as &quot;revoke&quot;ed on the Resource in the label.
         * @return this builder to allow method chaining.
         * @throws NullPointerException if any argument is {@code null}.
         */
        default LabelScoped setRevokedPermissions(final String resourceType, final JsonPointer resourcePath,
                final String revokedPermission, final String... furtherRevokedPermissions) {
<span class="fc" id="L434">            setRevokedPermissionsFor(getLabel(), resourceType, resourcePath, revokedPermission,</span>
                    furtherRevokedPermissions);
<span class="fc" id="L436">            return this;</span>
        }

        /**
         * Exits the currently provided {@link Label} to the {@link PolicyBuilder} level again where a new
         * {@link #forLabel(Label)} can be done.
         *
         * @return the non-Label scoped PolicyBuilder.
         */
        PolicyBuilder exitLabel();
    }

    /**
     * Returns a {@code label} scoped PolicyBuilder where the {@link Label} can be omitted in the builder methods.
     *
     * @param label the Label to scope to.
     * @return the label scoped PolicyBuilder.
     */
    default LabelScoped forLabel(final CharSequence label) {
<span class="fc" id="L455">        return forLabel(Label.of(label));</span>
    }

    /**
     * Returns a {@code label} scoped PolicyBuilder where the {@link Label} can be omitted in the builder methods.
     *
     * @param label the Label to scope to.
     * @return the label scoped PolicyBuilder.
     */
    LabelScoped forLabel(Label label);

    /**
     * Sets the Policy ID. The previous ID is overwritten.
     *
     * @param id the Policy ID to set.
     * @return this builder to allow method chaining.
     * @throws PolicyIdInvalidException if {@code policyId} did not comply to {@link Policy#ID_REGEX}.
     */
    PolicyBuilder setId(CharSequence id);

    /**
     * Sets the given lifecycle to this builder.
     *
     * @param lifecycle the lifecycle to be set.
     * @return this builder to allow method chaining.
     */
    PolicyBuilder setLifecycle(@Nullable PolicyLifecycle lifecycle);

    /**
     * Sets the given revision number to this builder.
     *
     * @param revisionNumber the revision number to be set.
     * @return this builder to allow method chaining.
     */
    default PolicyBuilder setRevision(final long revisionNumber) {
<span class="nc" id="L490">        return setRevision(PolicyRevision.newInstance(revisionNumber));</span>
    }

    /**
     * Sets the given revision to this builder.
     *
     * @param revision the revision to be set.
     * @return this builder to allow method chaining.
     */
    PolicyBuilder setRevision(@Nullable PolicyRevision revision);

    /**
     * Sets the given modified timestamp to this builder.
     *
     * @param modified the timestamp to be set.
     * @return this builder to allow method chaining.
     */
    PolicyBuilder setModified(@Nullable Instant modified);

    /**
     * Sets the given entry to this builder. A previous entry with the same {@link Label} as the one of the
     * provided {@code entry} is replaced.
     *
     * @param entry the entry to be set.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if {@code entry} is {@code null}.
     */
    PolicyBuilder set(PolicyEntry entry);

    /**
     * Sets the given entries to this builder. All previous entries with the same {@link Label}s as the ones of the
     * provided {@code entries} are replaced. Be aware: if there are several entries with the same {@link Label} in the
     * given Iterable, later entries will replace earlier ones.
     *
     * @param entries the entries to be set.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if {@code entries} is {@code null}.
     */
    PolicyBuilder setAll(Iterable&lt;PolicyEntry&gt; entries);

    /**
     * Removes the entry identified by the passed {@code label} from this builder.
     *
     * @param label the label to be removed.
     * @return label builder to allow method chaining.
     * @throws NullPointerException if {@code label} is {@code null}.
     * @throws IllegalArgumentException if {@code label} is empty.
     */
    PolicyBuilder remove(CharSequence label);

    /**
     * Removes the given entry from this builder.
     *
     * @param entry the entry to be removed.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if {@code entry} is {@code null}.
     */
    default PolicyBuilder remove(final PolicyEntry entry) {
<span class="nc" id="L548">        return remove(checkNotNull(entry, &quot;entry to be removed&quot;).getLabel());</span>
    }

    /**
     * Removes all entries from this builder which have the same {@link Label} like the given entries.
     *
     * @param entries the entries to be removed.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if {@code entries} is {@code null}.
     */
    PolicyBuilder removeAll(Iterable&lt;PolicyEntry&gt; entries);

    /**
     * Sets the given {@link Subjects} to the specified {@code label} to this builder. All previous entries with the
     * same {@code subjectId} in the {@link Label} are replaced by the specified ones.
     *
     * @param label the Label identifying the PolicyEntry to modify.
     * @param subjects the Subjects to set for the PolicyEntry identified by the {@code label}.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} is empty.
     */
    PolicyBuilder setSubjectsFor(CharSequence label, Subjects subjects);

    /**
     * Sets the given {@link Subject} to the specified {@code label} to this builder. A previous entry with the same
     * {@code issuer} and {@code subject} in the {@link Label} is replaced by the specified one.
     *
     * @param label the Label identifying the PolicyEntry to modify.
     * @param issuer the SubjectId's {@code issuer}.
     * @param subject the character sequence for the SubjectId's {@code subject}.
     * @param subjectType the type of the subject to set.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} is empty.
     */
    default PolicyBuilder setSubjectFor(final CharSequence label,
            final SubjectIssuer issuer,
            final CharSequence subject,
            final SubjectType subjectType) {

<span class="fc" id="L589">        return setSubjectFor(label, Subject.newInstance(issuer, subject, subjectType));</span>
    }

    /**
     * Sets the given {@link Subject} to the specified {@code label} to this builder. A previous entry with the same
     * {@code subjectIssuerWithId} in the {@link Label} is replaced by the specified one.
     *
     * @param label the Label identifying the PolicyEntry to modify.
     * @param subjectIssuerWithId the Subject issuer + Subject ID (separated with a &quot;{@value
     * SubjectId#ISSUER_DELIMITER}&quot;) of the Subject to set.
     * @param subjectType the type of the subject to set.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} is empty.
     */
    default PolicyBuilder setSubjectFor(final CharSequence label, final CharSequence subjectIssuerWithId,
            final SubjectType subjectType) {

<span class="fc" id="L607">        return setSubjectFor(label, Subject.newInstance(subjectIssuerWithId, subjectType));</span>
    }

    /**
     * Sets the given {@link Subject} to the specified {@code label} to this builder. A previous entry with the same
     * {@code subjectId} in the {@link Label} is replaced by the specified one.
     *
     * @param label the Label identifying the PolicyEntry to modify.
     * @param subject the Subject to set for the PolicyEntry identified by the {@code label}.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} is empty.
     */
    PolicyBuilder setSubjectFor(CharSequence label, Subject subject);

    /**
     * Removes the subject identified by the specified {@code subjectIssuerWithId} from this builder.
     *
     * @param label the Label identifying the PolicyEntry to modify.
     * @param subjectIssuerWithId the Subject issuer + Subject ID (separated with a &quot;{@value
     * SubjectId#ISSUER_DELIMITER}&quot;) of the Subject to remove from the PolicyEntry identified by the {@code label}.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if any argument is empty.
     */
    PolicyBuilder removeSubjectFor(CharSequence label, CharSequence subjectIssuerWithId);

    /**
     * Removes the subject identified by the specified {@code issuer} and {@code subject} from this builder.
     *
     * @param label the label identifying the PolicyEntry to modify.
     * @param issuer the SubjectId's {@code issuer} to remove from the PolicyEntry identified by the {@code label}.
     * @param subject the character sequence for the SubjectId's {@code subject} to remove from the PolicyEntry
     * identified by the {@code label}.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} is empty.
     */
    default PolicyBuilder removeSubjectFor(final CharSequence label, final SubjectIssuer issuer,
            final CharSequence subject) {

<span class="nc" id="L648">        return removeSubjectFor(label, SubjectId.newInstance(issuer, subject));</span>
    }

    /**
     * Removes the specified {@code subject} from this builder.
     *
     * @param label the label identifying the PolicyEntry to modify.
     * @param subject the Subject to remove from the PolicyEntry identified by the {@code label}.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} is empty.
     */
    PolicyBuilder removeSubjectFor(CharSequence label, Subject subject);

    /**
     * Sets the given {@link Resources} to the specified {@code label} to this builder. All previous entries with the
     * same {@code resourceKey} in the label are replaced by the specified ones.
     *
     * @param label the label identifying the PolicyEntry to modify.
     * @param resources the Resources to set for the PolicyEntry identified by the {@code label}.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} is empty.
     */
    PolicyBuilder setResourcesFor(CharSequence label, Resources resources);

    /**
     * Sets the given {@link Resource} to the specified {@code label} to this builder. A previous entry with the same
     * {@code resourceKey} in the label is replaced by the specified one.
     *
     * @param label the label identifying the PolicyEntry to modify.
     * @param resource the Resource to set for the PolicyEntry identified by the {@code label}.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} is empty.
     */
    PolicyBuilder setResourceFor(CharSequence label, Resource resource);

    /**
     * Removes the resource identified by the specified {@code resourceKey} from this builder.
     *
     * @param label the label identifying the PolicyEntry to modify.
     * @param resourceKey the ResourceKey to remove from the PolicyEntry identified by the {@code label}.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} is empty.
     */
    PolicyBuilder removeResourceFor(CharSequence label, ResourceKey resourceKey);

    /**
     * Removes the specified {@code resource} from this builder.
     *
     * @param label the label identifying the PolicyEntry to modify.
     * @param resource the Resource to remove from the PolicyEntry identified by the {@code label}.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} is empty.
     */
    PolicyBuilder removeResourceFor(CharSequence label, Resource resource);

    /**
     * Set the given {@link EffectedPermissions} on the specified {@code resourceKey} in the specified {@code label}
     * to this builder.
     *
     * @param label the label identifying the PolicyEntry to modify.
     * @param resourceKey the ResourceKey to set the effected permissions on.
     * @param effectedPermissions the EffectedPermissions to set on the resource in the label.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} is empty.
     */
    PolicyBuilder setPermissionsFor(CharSequence label, ResourceKey resourceKey,
            EffectedPermissions effectedPermissions);

    /**
     * Set the given permissions on the specified {@code resourcePath} in the specified {@code label}
     * as &quot;granted&quot; to this builder.
     *
     * @param label the label identifying the PolicyEntry to modify.
     * @param resourceType the type of the Resource to set the permissions on.
     * @param resourcePath the path of the Resource to set the permissions on.
     * @param grantedPermissions the Permissions to set as &quot;grant&quot;ed on the Resource in the label.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} or {@code resourceType} is empty.
     */
    default PolicyBuilder setGrantedPermissionsFor(final CharSequence label,
            final String resourceType,
            final CharSequence resourcePath,
            final Permissions grantedPermissions) {

<span class="nc" id="L739">        return setGrantedPermissionsFor(label, ResourceKey.newInstance(resourceType, resourcePath), grantedPermissions);</span>
    }

    /**
     * Set the given permissions on the specified {@code resourceKey} in the specified {@code label}
     * as &quot;granted&quot; to this builder.
     *
     * @param label the label identifying the PolicyEntry to modify.
     * @param resourceKey the ResourceKey to set the permissions on.
     * @param grantedPermissions the Permissions to set as &quot;grant&quot;ed on the resource in the label.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     */
    PolicyBuilder setGrantedPermissionsFor(CharSequence label, ResourceKey resourceKey, Permissions grantedPermissions);

    /**
     * Set the given permissions on the specified {@code resourceType} and {@code resourcePath} in the specified
     * {@code label} as &quot;granted&quot; to this builder.
     *
     * @param label the label identifying the PolicyEntry to modify.
     * @param resourceType the type of the Resource to set the permissions on.
     * @param resourcePath the path of the Resource to set the permissions on.
     * @param grantedPermission the Permission to set as &quot;grant&quot;ed on the Resource in the label.
     * @param furtherGrantedPermissions further Permissions to set as &quot;grant&quot;ed on the Resource in the label.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} or {@code resourceType} is empty.
     */
    default PolicyBuilder setGrantedPermissionsFor(final CharSequence label,
            final String resourceType,
            final CharSequence resourcePath,
            final String grantedPermission,
            final String... furtherGrantedPermissions) {

<span class="fc" id="L773">        return setGrantedPermissionsFor(label, ResourceKey.newInstance(resourceType, resourcePath),</span>
<span class="fc" id="L774">                Permissions.newInstance(grantedPermission, furtherGrantedPermissions));</span>
    }

    /**
     * Set the given permissions on the specified {@code resourceKey} in the specified {@code label}
     * as &quot;granted&quot; to this builder.
     *
     * @param label the label identifying the PolicyEntry to modify.
     * @param resourceKey the ResourceKey to set the permissions on.
     * @param grantedPermission the Permission to set as &quot;grant&quot;ed on the resource in the label.
     * @param furtherGrantedPermissions further Permissions to set as &quot;grant&quot;ed on the resource in the label.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} is empty.
     */
    default PolicyBuilder setGrantedPermissionsFor(final CharSequence label,
            final ResourceKey resourceKey,
            final String grantedPermission,
            final String... furtherGrantedPermissions) {

<span class="nc" id="L794">        return setGrantedPermissionsFor(label, resourceKey, Permissions.newInstance(grantedPermission,</span>
                furtherGrantedPermissions));
    }

    /**
     * Set the given permissions on the specified {@code resourceType} and {@code resourcePath} in the specified
     * {@code label} as &quot;revoked&quot; to this builder.
     *
     * @param label the label identifying the PolicyEntry to modify.
     * @param resourceType the type of the Resource to set the permissions on.
     * @param resourcePath the path of the Resource to set the permissions on.
     * @param revokedPermissions the Permissions to set as &quot;revoke&quot;ed on the Resource in the label.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} or {@code resourceType} is empty.
     */
    default PolicyBuilder setRevokedPermissionsFor(final CharSequence label,
            final String resourceType,
            final CharSequence resourcePath,
            final Permissions revokedPermissions) {

<span class="nc" id="L815">        return setRevokedPermissionsFor(label, ResourceKey.newInstance(resourceType, resourcePath), revokedPermissions);</span>
    }

    /**
     * Set the given permissions on the specified {@code resourceKey} in the specified {@code label}
     * as &quot;revoked&quot; to this builder.
     *
     * @param label the label identifying the PolicyEntry to modify.
     * @param resourceKey the ResourceKey to set the permissions on.
     * @param revokedPermissions the Permissions to set as &quot;revoke&quot;ed on the resource in the label.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} is empty.
     */
    PolicyBuilder setRevokedPermissionsFor(CharSequence label, ResourceKey resourceKey, Permissions revokedPermissions);

    /**
     * Set the given permissions on the specified {@code resourceType} and {@code resourcePath} in the specified
     * {@code label} as &quot;revoked&quot; to this builder.
     *
     * @param label the label identifying the PolicyEntry to modify.
     * @param resourceType the type of the Resource to set the permissions on.
     * @param resourcePath the path of the Resource to set the permissions on.
     * @param revokedPermission the Permission to set as &quot;revoke&quot;ed on the Resource in the label.
     * @param furtherRevokedPermissions further Permissions to set as &quot;revoke&quot;ed on the Resource in the label.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     * @throws IllegalArgumentException if {@code label} or {@code resourceType} is empty.
     */
    default PolicyBuilder setRevokedPermissionsFor(final CharSequence label,
            final String resourceType,
            final CharSequence resourcePath,
            final String revokedPermission,
            final String... furtherRevokedPermissions) {

<span class="fc" id="L850">        return setRevokedPermissionsFor(label,</span>
<span class="fc" id="L851">                ResourceKey.newInstance(resourceType, JsonPointer.of(resourcePath)),</span>
<span class="fc" id="L852">                Permissions.newInstance(revokedPermission, furtherRevokedPermissions));</span>
    }

    /**
     * Set the given permissions on the specified {@code resourceKey} in the specified {@code label}
     * as &quot;revoked&quot; to this builder.
     *
     * @param label the label identifying the PolicyEntry to modify.
     * @param resourceKey the ResourceKey to set the permissions on.
     * @param revokedPermission the Permission to set as &quot;revoke&quot;ed on the resource in the label.
     * @param furtherRevokedPermissions further Permissions to set as &quot;revoke&quot;ed on the resource in the label.
     * @return this builder to allow method chaining.
     * @throws NullPointerException if any argument is {@code null}.
     */
    default PolicyBuilder setRevokedPermissionsFor(final CharSequence label,
            final ResourceKey resourceKey,
            final String revokedPermission,
            final String... furtherRevokedPermissions) {

<span class="nc" id="L871">        return setRevokedPermissionsFor(label, resourceKey,</span>
<span class="nc" id="L872">                Permissions.newInstance(revokedPermission, furtherRevokedPermissions));</span>
    }

    /**
     * Returns a new immutable {@link Policy} which contains all the entries which were set to this builder beforehand.
     *
     * @return a new {@code Policy}.
     */
    Policy build();

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.0.201801022044</span></div></body></html>