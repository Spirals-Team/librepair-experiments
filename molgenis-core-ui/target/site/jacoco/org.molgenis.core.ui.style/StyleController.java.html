<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>StyleController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">core-ui</a> &gt; <a href="index.source.html" class="el_package">org.molgenis.core.ui.style</a> &gt; <span class="el_source">StyleController.java</span></div><h1>StyleController.java</h1><pre class="source lang-java linenums">package org.molgenis.core.ui.style;

import org.apache.commons.io.IOUtils;
import org.molgenis.web.ErrorMessageResponse;
import org.springframework.core.io.Resource;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.*;

import javax.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.io.InputStream;

import static java.util.Collections.singletonList;
import static java.util.Objects.requireNonNull;
import static org.molgenis.core.ui.style.BootstrapVersion.BOOTSTRAP_VERSION_3;
import static org.molgenis.core.ui.style.BootstrapVersion.BOOTSTRAP_VERSION_4;
import static org.springframework.http.HttpStatus.NOT_FOUND;

@Controller
public class StyleController
{
	private final StyleService styleService;

	public StyleController(StyleService styleService)
<span class="fc" id="L27">	{</span>
<span class="fc" id="L28">		this.styleService = requireNonNull(styleService);</span>
<span class="fc" id="L29">	}</span>

	@GetMapping(&quot;/css/bootstrap-{bootstrap-version}/{theme}&quot;)
	public ResponseEntity getThemeCss(@PathVariable(&quot;bootstrap-version&quot;) String bootstrapVersion,
			@PathVariable(&quot;theme&quot;) String theme, HttpServletResponse response) throws MolgenisStyleException
	{
<span class="fc" id="L35">		response.setHeader(&quot;Content-Type&quot;, &quot;text/css&quot;);</span>
<span class="fc" id="L36">		response.setHeader(&quot;Cache-Control&quot;, &quot;max-age=31536000&quot;);</span>

<span class="pc bpc" id="L38" title="1 of 2 branches missed.">		final String themeName = theme.endsWith(&quot;.css&quot;) ? theme : theme + &quot;.css&quot;;</span>

<span class="fc bfc" id="L40" title="All 2 branches covered.">		BootstrapVersion version = bootstrapVersion.equals(&quot;4&quot;) ? BOOTSTRAP_VERSION_4 : BOOTSTRAP_VERSION_3;</span>
<span class="fc" id="L41">		Resource styleSheetResource = styleService.getThemeData(themeName, version);</span>

		try
		{
<span class="fc" id="L45">			InputStream inputStream = styleSheetResource.getInputStream();</span>
<span class="fc" id="L46">			IOUtils.copy(inputStream, response.getOutputStream());</span>
<span class="fc" id="L47">			IOUtils.closeQuietly(inputStream);</span>
<span class="fc" id="L48">			response.flushBuffer();</span>
		}
<span class="nc" id="L50">		catch (IOException e)</span>
		{
<span class="nc" id="L52">			throw new MolgenisStyleException(&quot;Unable to return theme data&quot;, e);</span>
<span class="fc" id="L53">		}</span>

<span class="fc" id="L55">		return new ResponseEntity(HttpStatus.OK);</span>
	}

	@ResponseBody
	@ResponseStatus(NOT_FOUND)
	@ExceptionHandler({ MolgenisStyleException.class, IOException.class })
	public ErrorMessageResponse handleStyleException(Exception e)
	{
<span class="nc" id="L63">		return new ErrorMessageResponse(singletonList(new ErrorMessageResponse.ErrorMessage(e.getMessage())));</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>