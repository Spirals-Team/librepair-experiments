<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>HealthConfigReader.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Eclipse Ditto :: Services :: Base</a> &gt; <a href="index.source.html" class="el_package">org.eclipse.ditto.services.base.config</a> &gt; <span class="el_source">HealthConfigReader.java</span></div><h1>HealthConfigReader.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2017 Bosch Software Innovations GmbH.
 *
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v2.0
 * which accompanies this distribution, and is available at
 * https://www.eclipse.org/org/documents/epl-2.0/index.php
 *
 * Contributors:
 *    Bosch Software Innovations GmbH - initial contribution
 */
package org.eclipse.ditto.services.base.config;

import java.time.Duration;

import com.typesafe.config.Config;

/**
 * Health-check configurations.
 */
public final class HealthConfigReader extends AbstractConfigReader {

    /**
     * Default: Whether the health check should be enabled (globally) or not.
     */
    private static final boolean DEFAULT_ENABLED = true;

    /**
     * Default: The interval of the health check.
     */
<span class="nc" id="L31">    private static final Duration DEFAULT_INTERVAL = Duration.ofSeconds(60L);</span>


    /**
     * Default: Whether the persistence health check should be enabled or not.
     */
    private static final boolean DEFAULT_PERSISTENCE_ENABLED = false;

    /**
     * Default: The timeout of the health check for persistence. If the persistence takes longer than that to respond,
     * it is considered &quot;DOWN&quot;.
     */
<span class="nc" id="L43">    private static final Duration DEFAULT_PERSISTENCE_TIMEOUT = Duration.ofSeconds(60L);</span>

    private static final String KEY_ENABLED = &quot;enabled&quot;;
    private static final String PATH_ENABLED = KEY_ENABLED;
    private static final String PATH_INTERVAL = &quot;interval&quot;;

    private static final String PATH_PERSISTENCE = &quot;persistence&quot;;
<span class="nc" id="L50">    private static final String PATH_PERSISTENCE_ENABLED = path(PATH_PERSISTENCE, KEY_ENABLED);</span>
<span class="nc" id="L51">    private static final String PATH_PERSISTENCE_TIMEOUT = path(PATH_PERSISTENCE, &quot;timeout&quot;);</span>

    HealthConfigReader(final Config config) {
<span class="nc" id="L54">        super(config);</span>
<span class="nc" id="L55">    }</span>

    /**
     * Get whether the health check should be enabled (globally) or not.
     *
     * @return whether the health check should be enabled (globally) or not.
     */
    public boolean enabled() {
<span class="nc" id="L63">        return getIfPresent(PATH_ENABLED, config::getBoolean).orElse(DEFAULT_ENABLED);</span>
    }

    /**
     * Get the interval of the health check.
     *
     * @return the interval of the health check.
     */
    public Duration getInterval() {
<span class="nc" id="L72">        return getIfPresent(PATH_INTERVAL, config::getDuration).orElse(DEFAULT_INTERVAL);</span>
    }

    /**
     * Get whether the persistence health check should be enabled or not.
     *
     * @return whether the  persistence health check should be enabled or not.
     */
    public boolean persistenceEnabled() {
<span class="nc" id="L81">        return getIfPresent(PATH_PERSISTENCE_ENABLED, config::getBoolean).orElse(DEFAULT_PERSISTENCE_ENABLED);</span>
    }

    /**
     * Get the timeout of the health check for persistence. If the persistence takes longer than that to respond,
     * it is considered &quot;DOWN&quot;.
     *
     * @return the timeout of the health check for persistence.
     */
    public Duration getPersistenceTimeout() {
<span class="nc" id="L91">        return getIfPresent(PATH_PERSISTENCE_TIMEOUT, config::getDuration).orElse(DEFAULT_PERSISTENCE_TIMEOUT);</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.0.201801022044</span></div></body></html>