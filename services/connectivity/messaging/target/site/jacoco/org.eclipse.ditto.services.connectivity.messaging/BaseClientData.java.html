<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BaseClientData.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Eclipse Ditto :: Services :: Connectivity :: Messaging</a> &gt; <a href="index.source.html" class="el_package">org.eclipse.ditto.services.connectivity.messaging</a> &gt; <span class="el_source">BaseClientData.java</span></div><h1>BaseClientData.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2017 Bosch Software Innovations GmbH.
 *
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v2.0
 * which accompanies this distribution, and is available at
 * https://www.eclipse.org/org/documents/epl-2.0/index.php
 *
 * Contributors:
 *    Bosch Software Innovations GmbH - initial contribution
 */
package org.eclipse.ditto.services.connectivity.messaging;

import java.time.Instant;
import java.util.Objects;
import java.util.Optional;

import javax.annotation.Nullable;
import javax.annotation.concurrent.Immutable;

import org.eclipse.ditto.model.connectivity.Connection;
import org.eclipse.ditto.model.connectivity.ConnectionStatus;

import akka.actor.ActorRef;

/**
 * The data the {@link BaseClientActor} has in its different {@link BaseClientState States}.
 */
@Immutable
public final class BaseClientData {

    /**
     * MDC (logging) field name for the connection ID.
     */
    public static final String MDC_CONNECTION_ID = &quot;connection-id&quot;;

    private final String connectionId;
    private final Connection connection;
    private final ConnectionStatus connectionStatus;
    private final ConnectionStatus desiredConnectionStatus;
    @Nullable private final String connectionStatusDetails;
    private final Instant inConnectionStatusSince;
    @Nullable private final ActorRef origin;

    /**
     * Constructs new instance of BaseClientData, the data of the {@link BaseClientActor}.
     * @param connectionId the ID of the {@link Connection}.
     * @param connection the optional {@link Connection}.
     * @param connectionStatus the current {@link ConnectionStatus} of the Connection.
     * @param desiredConnectionStatus the desired {@link ConnectionStatus} of the Connection.
     * @param connectionStatusDetails the optional details about the ConnectionStatus.
     * @param inConnectionStatusSince the instant since when the Client is in its current ConnectionStatus.
     * @param origin the ActorRef which caused the latest state data change.
     */
    BaseClientData(final String connectionId, final Connection connection,
            final ConnectionStatus connectionStatus,
            final ConnectionStatus desiredConnectionStatus,
            @Nullable final String connectionStatusDetails,
            final Instant inConnectionStatusSince,
<span class="fc" id="L60">            @Nullable final ActorRef origin) {</span>
<span class="fc" id="L61">        this.connectionId = connectionId;</span>
<span class="fc" id="L62">        this.connection = connection;</span>
<span class="fc" id="L63">        this.connectionStatus = connectionStatus;</span>
<span class="fc" id="L64">        this.desiredConnectionStatus = desiredConnectionStatus;</span>
<span class="fc" id="L65">        this.connectionStatusDetails = connectionStatusDetails;</span>
<span class="fc" id="L66">        this.inConnectionStatusSince = inConnectionStatusSince;</span>
<span class="fc" id="L67">        this.origin = origin;</span>
<span class="fc" id="L68">    }</span>

    public String getConnectionId() {
<span class="fc" id="L71">        return connectionId;</span>
    }

    public Connection getConnection() {
<span class="fc" id="L75">        return connection;</span>
    }

    public ConnectionStatus getConnectionStatus() {
<span class="nc" id="L79">        return connectionStatus;</span>
    }

    public ConnectionStatus getDesiredConnectionStatus() {
<span class="fc" id="L83">        return desiredConnectionStatus;</span>
    }

    public Optional&lt;String&gt; getConnectionStatusDetails() {
<span class="nc" id="L87">        return Optional.ofNullable(connectionStatusDetails);</span>
    }

    public Instant getInConnectionStatusSince() {
<span class="nc" id="L91">        return inConnectionStatusSince;</span>
    }

    public Optional&lt;ActorRef&gt; getOrigin() {
<span class="fc" id="L95">        return Optional.ofNullable(origin);</span>
    }

    public BaseClientData setConnection(final Connection connection) {
<span class="fc" id="L99">        return new BaseClientData(connectionId, connection, connectionStatus, desiredConnectionStatus,</span>
                connectionStatusDetails, inConnectionStatusSince, origin);
    }

    public BaseClientData setConnectionStatus(final ConnectionStatus connectionStatus) {
<span class="fc" id="L104">        return new BaseClientData(connectionId, connection, connectionStatus, desiredConnectionStatus,</span>
<span class="fc" id="L105">                connectionStatusDetails, Instant.now(), origin);</span>
    }

    public BaseClientData setDesiredConnectionStatus(final ConnectionStatus desiredConnectionStatus) {
<span class="fc" id="L109">        return new BaseClientData(connectionId, connection, connectionStatus, desiredConnectionStatus,</span>
                connectionStatusDetails, inConnectionStatusSince, origin);
    }

    public BaseClientData setConnectionStatusDetails(@Nullable final String connectionStatusDetails) {
<span class="fc" id="L114">        return new BaseClientData(connectionId, connection, connectionStatus, desiredConnectionStatus,</span>
                connectionStatusDetails, inConnectionStatusSince, origin);
    }

    public BaseClientData setOrigin(@Nullable final ActorRef origin) {
<span class="fc" id="L119">        return new BaseClientData(connectionId, connection, connectionStatus, desiredConnectionStatus,</span>
                connectionStatusDetails, inConnectionStatusSince, origin);
    }

    @Override
    public boolean equals(final Object o) {
<span class="nc bnc" id="L125" title="All 2 branches missed.">        if (this == o) {return true;}</span>
<span class="nc bnc" id="L126" title="All 2 branches missed.">        if (!(o instanceof BaseClientData)) {return false;}</span>
<span class="nc" id="L127">        final BaseClientData that = (BaseClientData) o;</span>
<span class="nc bnc" id="L128" title="All 2 branches missed.">        return Objects.equals(connectionId, that.connectionId) &amp;&amp;</span>
<span class="nc bnc" id="L129" title="All 6 branches missed.">                Objects.equals(connection, that.connection) &amp;&amp;</span>
                connectionStatus == that.connectionStatus &amp;&amp;
                desiredConnectionStatus == that.desiredConnectionStatus &amp;&amp;
<span class="nc bnc" id="L132" title="All 2 branches missed.">                Objects.equals(connectionStatusDetails, that.connectionStatusDetails) &amp;&amp;</span>
<span class="nc bnc" id="L133" title="All 2 branches missed.">                Objects.equals(inConnectionStatusSince, that.inConnectionStatusSince) &amp;&amp;</span>
<span class="nc bnc" id="L134" title="All 2 branches missed.">                Objects.equals(origin, that.origin);</span>
    }

    @Override
    public int hashCode() {
<span class="nc" id="L139">        return Objects.hash(connectionId, connection, connectionStatus, desiredConnectionStatus,</span>
                connectionStatusDetails, inConnectionStatusSince, origin);
    }

    @Override
    public String toString() {
<span class="nc" id="L145">        return getClass().getSimpleName() + &quot; [&quot; +</span>
                &quot;connectionId=&quot; + connectionId +
                &quot;, connection=&quot; + connection +
                &quot;, connectionStatus=&quot; + connectionStatus +
                &quot;, desiredConnectionStatus=&quot; + desiredConnectionStatus +
                &quot;, connectionStatusDetails=&quot; + connectionStatusDetails +
                &quot;, inConnectionStatusSince=&quot; + inConnectionStatusSince +
                &quot;, origin=&quot; + origin +
                &quot;]&quot;;
    }
}

</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.0.201801022044</span></div></body></html>