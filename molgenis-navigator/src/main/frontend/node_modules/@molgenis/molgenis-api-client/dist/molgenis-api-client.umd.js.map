{"version":3,"file":null,"sources":["../src/molgenis-api-client.js"],"sourcesContent":["import fetch from 'isomorphic-fetch'\nimport { merge } from 'lodash'\nimport FormData from 'form-data'\n\nconst defaultOptions = {\n  'headers': {\n    'Accept': 'application/json',\n    'Content-Type': 'application/json',\n    'X-Requested-With': 'XMLHttpRequest'\n  },\n  'credentials': 'same-origin'\n}\n\nconst handleJobResponse = response => {\n  return response.text().then(text => response.ok ? text : Promise.reject(response))\n}\n\nconst handleResponse = (response) => {\n  if (response.headers.get('content-type') === 'application/json') {\n    return response.json().then(json => response.ok ? json : Promise.reject(json.errors[0].message))\n  } else {\n    return response.ok ? response : Promise.reject(response)\n  }\n}\n\nconst mergeOptions = (method, options) => {\n  return merge({method: method}, defaultOptions, options)\n}\n\n/**\n * Get a JSON object from the server\n * Uses your session ID to authenticate\n *\n * @example <caption>Example of how to use the get method</caption>\n * // Handle a promise from calling /api/v2/EntityType\n * get('/api/v2/EntityType').then(response => {...}, error => {...}))\n *\n * @example <caption>Example of how to use the get method with an added option</caption>\n * // Handle a promise from calling /api/v2/EntityType with different content type\n * get('/api/v2/EntityType', { headers: { 'Content-type': 'text' } }).then(response => {...}, error => {...})\n *\n * @param url The URL to post to e.g. /api/v2/my_data_set\n * @param options_ An object containing additional options like headers or body\n */\nconst get = (url, options_) => {\n  const options = mergeOptions('GET', options_)\n  return fetch(url, options).then(handleResponse).then(response => response)\n}\n\n/**\n * Post a body of data to the server\n * Uses your session ID to authenticate\n *\n * @example <caption>Example of how to use the post method</caption>\n * // Post a data object and handle the response\n * const data = {\n *  items: ['1', '2'],\n *  id: 'example'\n * }\n *\n * const options = {\n *  body: data\n * }\n *\n * post('api/v2/PostData', options).then(response => {...}, error => {...})\n *\n * @param url\n * @param options_\n */\nconst post = (url, options_) => {\n  const options = mergeOptions('POST', options_)\n  return fetch(url, options).then(handleResponse).then(response => response)\n}\n\n/**\n * Call a delete method on the server\n * Uses your session ID to authenticate\n *\n * @example <caption>Example of how to use the delete_ method</caption>\n * // Handle the response from calling DELETE on /api/v2/deleteById/1\n * delete_('/api/v2/deleteById/1').then(response => {...}, error => {...})\n *\n * @param url\n * @param options_\n */\nconst delete_ = (url, options_) => {\n  const options = mergeOptions('DELETE', options_)\n  return fetch(url, options).then(handleResponse).then(response => response)\n}\n\n/**\n * Post a file to the server\n * FormData is created with a 'file' parameter. A POST is then automatically created.\n * Uses your session ID to authenticate\n *\n * Expects the response from the server to contain a Job URL\n *\n * @example <caption>Example of how the use the postFile method</caption>\n * // Post a file and handle the response\n * postFile('/plugin/one-click-importer/upload', myAwesomeFile).then(response => {...}, error => {...})\n *\n * @param url\n * @param file\n */\nconst postFile = (url, file) => {\n  const form = new FormData()\n  form.append('file', file)\n\n  const options = {\n    body: form,\n    method: 'POST',\n    credentials: 'same-origin'\n  }\n\n  return fetch(url, options).then(handleJobResponse).then(response => response)\n}\n\nexport default {get, post, delete_, postFile}\n"],"names":["defaultOptions","handleJobResponse","response","text","then","ok","reject","handleResponse","headers","get","json","errors","message","mergeOptions","method","options","merge","url","options_","fetch","post","delete_","postFile","file","form","FormData","append"],"mappings":";;;;;;;;;;AAIA,IAAMA,iBAAiB;aACV;cACC,kBADD;oBAEO,kBAFP;wBAGW;GAJD;iBAMN;CANjB;;AASA,IAAMC,oBAAoB,SAApBA,iBAAoB,WAAY;SAC7BC,SAASC,IAAT,GAAgBC,IAAhB,CAAqB;WAAQF,SAASG,EAAT,GAAcF,IAAd,GAAqB,SAAQG,MAAR,CAAeJ,QAAf,CAA7B;GAArB,CAAP;CADF;;AAIA,IAAMK,iBAAiB,SAAjBA,cAAiB,CAACL,QAAD,EAAc;MAC/BA,SAASM,OAAT,CAAiBC,GAAjB,CAAqB,cAArB,MAAyC,kBAA7C,EAAiE;WACxDP,SAASQ,IAAT,GAAgBN,IAAhB,CAAqB;aAAQF,SAASG,EAAT,GAAcK,IAAd,GAAqB,SAAQJ,MAAR,CAAeI,KAAKC,MAAL,CAAY,CAAZ,EAAeC,OAA9B,CAA7B;KAArB,CAAP;GADF,MAEO;WACEV,SAASG,EAAT,GAAcH,QAAd,GAAyB,SAAQI,MAAR,CAAeJ,QAAf,CAAhC;;CAJJ;;AAQA,IAAMW,eAAe,SAAfA,YAAe,CAACC,MAAD,EAASC,OAAT,EAAqB;SACjCC,aAAM,EAACF,QAAQA,MAAT,EAAN,EAAwBd,cAAxB,EAAwCe,OAAxC,CAAP;CADF;;;;;;;;;;;;;;;;;AAmBA,IAAMN,MAAM,SAANA,GAAM,CAACQ,GAAD,EAAMC,QAAN,EAAmB;MACvBH,UAAUF,aAAa,KAAb,EAAoBK,QAApB,CAAhB;SACOC,MAAMF,GAAN,EAAWF,OAAX,EAAoBX,IAApB,CAAyBG,cAAzB,EAAyCH,IAAzC,CAA8C;WAAYF,QAAZ;GAA9C,CAAP;CAFF;;;;;;;;;;;;;;;;;;;;;;AAyBA,IAAMkB,OAAO,SAAPA,IAAO,CAACH,GAAD,EAAMC,QAAN,EAAmB;MACxBH,UAAUF,aAAa,MAAb,EAAqBK,QAArB,CAAhB;SACOC,MAAMF,GAAN,EAAWF,OAAX,EAAoBX,IAApB,CAAyBG,cAAzB,EAAyCH,IAAzC,CAA8C;WAAYF,QAAZ;GAA9C,CAAP;CAFF;;;;;;;;;;;;;AAgBA,IAAMmB,UAAU,SAAVA,OAAU,CAACJ,GAAD,EAAMC,QAAN,EAAmB;MAC3BH,UAAUF,aAAa,QAAb,EAAuBK,QAAvB,CAAhB;SACOC,MAAMF,GAAN,EAAWF,OAAX,EAAoBX,IAApB,CAAyBG,cAAzB,EAAyCH,IAAzC,CAA8C;WAAYF,QAAZ;GAA9C,CAAP;CAFF;;;;;;;;;;;;;;;;AAmBA,IAAMoB,WAAW,SAAXA,QAAW,CAACL,GAAD,EAAMM,IAAN,EAAe;MACxBC,OAAO,IAAIC,QAAJ,EAAb;OACKC,MAAL,CAAY,MAAZ,EAAoBH,IAApB;;MAEMR,UAAU;UACRS,IADQ;YAEN,MAFM;iBAGD;GAHf;;SAMOL,MAAMF,GAAN,EAAWF,OAAX,EAAoBX,IAApB,CAAyBH,iBAAzB,EAA4CG,IAA5C,CAAiD;WAAYF,QAAZ;GAAjD,CAAP;CAVF;;AAaA,wBAAe,EAACO,QAAD,EAAMW,UAAN,EAAYC,gBAAZ,EAAqBC,kBAArB,EAAf;;;;"}