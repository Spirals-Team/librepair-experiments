<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>HPOAnnotator.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">data-annotators</a> &gt; <a href="index.source.html" class="el_package">org.molgenis.data.annotation.core.entity.impl.hpo</a> &gt; <span class="el_source">HPOAnnotator.java</span></div><h1>HPOAnnotator.java</h1><pre class="source lang-java linenums">package org.molgenis.data.annotation.core.entity.impl.hpo;

import org.molgenis.data.DataService;
import org.molgenis.data.Entity;
import org.molgenis.data.annotation.core.RepositoryAnnotator;
import org.molgenis.data.annotation.core.entity.AnnotatorConfig;
import org.molgenis.data.annotation.core.entity.AnnotatorInfo;
import org.molgenis.data.annotation.core.entity.EntityAnnotator;
import org.molgenis.data.annotation.core.entity.impl.framework.AbstractAnnotator;
import org.molgenis.data.annotation.core.entity.impl.framework.RepositoryAnnotatorImpl;
import org.molgenis.data.annotation.core.query.GeneNameQueryCreator;
import org.molgenis.data.annotation.core.resources.Resource;
import org.molgenis.data.annotation.core.resources.Resources;
import org.molgenis.data.annotation.core.resources.impl.RepositoryFactory;
import org.molgenis.data.annotation.core.resources.impl.ResourceImpl;
import org.molgenis.data.annotation.core.resources.impl.SingleResourceConfig;
import org.molgenis.data.annotation.web.settings.SingleFileLocationCmdLineAnnotatorSettingsConfigurer;
import org.molgenis.data.meta.model.Attribute;
import org.molgenis.data.meta.model.AttributeFactory;
import org.molgenis.data.meta.model.EntityTypeFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import java.util.ArrayList;
import java.util.List;

import static org.molgenis.data.annotation.web.settings.HPOAnnotatorSettings.Meta.HPO_LOCATION;
import static org.molgenis.data.meta.AttributeType.TEXT;

/**
 * Typical HPO terms for a gene dataType (already present via SnpEff) Source:
 * http://compbio.charite.de/hudson/job/hpo. annotations.monthly/lastStableBuild/artifact/annotation/
 * ALL_SOURCES_TYPICAL_FEATURES_diseases_to_genes_to_phenotypes .txt
 * &lt;p&gt;
 * Add resource file path to RuntimeProperty 'hpo_location'
 */
@Configuration
<span class="fc" id="L39">public class HPOAnnotator implements AnnotatorConfig</span>
{
	public static final String NAME = &quot;hpo&quot;;

	public static final String HPO_IDS = &quot;HPOIDS&quot;;
	public static final String HPO_TERMS = &quot;HPOTERMS&quot;;

	private static final String HPO_RESOURCE = &quot;HPOResource&quot;;

	@Autowired
	private Entity HPOAnnotatorSettings;

	@Autowired
	private DataService dataService;

	@Autowired
	private Resources resources;

	@Autowired
	private EntityTypeFactory entityTypeFactory;

	@Autowired
	GeneNameQueryCreator geneNameQueryCreator;

	@Autowired
	private AttributeFactory attributeFactory;
	private RepositoryAnnotatorImpl annotator;

	@Bean
	public RepositoryAnnotator hpo()
	{
<span class="fc" id="L70">		annotator = new RepositoryAnnotatorImpl(NAME);</span>
<span class="fc" id="L71">		return annotator;</span>
	}

	public Attribute getIdsAttr()
	{
<span class="fc" id="L76">		return attributeFactory.create().setName(HPO_IDS).setDataType(TEXT).setDescription(&quot;HPO identifiers&quot;);</span>
	}

	public Attribute getTermsAttr()
	{
<span class="fc" id="L81">		return attributeFactory.create().setName(HPO_TERMS).setDataType(TEXT).setDescription(&quot;HPO terms&quot;);</span>
	}

	@Override
	public void init()
	{
<span class="nc" id="L87">		List&lt;Attribute&gt; attributes = createHpoOutputAttributes();</span>

<span class="nc" id="L89">		AnnotatorInfo info = AnnotatorInfo.create(AnnotatorInfo.Status.READY, AnnotatorInfo.Type.PHENOTYPE_ASSOCIATION,</span>
				NAME,
				&quot;The Human Phenotype Ontology (HPO) aims to provide a standardized vocabulary of phenotypic abnormalities encountered in human disease.&quot;
						+ &quot;Terms in the HPO describes a phenotypic abnormality, such as atrial septal defect.The HPO is currently being developed using the medical literature, Orphanet, DECIPHER, and OMIM. HPO currently contains approximately 11,000 terms and over 115,000 annotations to hereditary diseases.&quot;
						+ &quot;Please note that if SnpEff was used to annotate in order to add the gene symbols to the variants, than this annotator should be used on the result entity rather than the variant entity itself.&quot;,
				attributes);

<span class="nc" id="L96">		EntityAnnotator entityAnnotator = new AbstractAnnotator(HPO_RESOURCE, info, geneNameQueryCreator,</span>
				new HpoResultFilter(entityTypeFactory, this), dataService, resources,
				new SingleFileLocationCmdLineAnnotatorSettingsConfigurer(HPO_LOCATION, HPOAnnotatorSettings))
<span class="nc" id="L99">		{</span>
			@Override
			public List&lt;Attribute&gt; createAnnotatorAttributes(AttributeFactory attributeFactory)
			{
<span class="nc" id="L103">				return createHpoOutputAttributes();</span>
			}
		};

<span class="nc" id="L107">		annotator.init(entityAnnotator);</span>
<span class="nc" id="L108">	}</span>

	private List&lt;Attribute&gt; createHpoOutputAttributes()
	{
<span class="nc" id="L112">		List&lt;Attribute&gt; attributes = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L113">		attributes.add(getIdsAttr());</span>
<span class="nc" id="L114">		attributes.add(getTermsAttr());</span>
<span class="nc" id="L115">		return attributes;</span>
	}

	@Bean
	public Resource hpoResource()
	{
<span class="fc" id="L121">		return new ResourceImpl(HPO_RESOURCE, new SingleResourceConfig(HPO_LOCATION, HPOAnnotatorSettings))</span>
<span class="fc" id="L122">		{</span>
			@Override
			public RepositoryFactory getRepositoryFactory()
			{
<span class="nc" id="L126">				return file -&gt; new HPORepository(file, entityTypeFactory, attributeFactory);</span>
			}
		};
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>