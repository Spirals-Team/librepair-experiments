[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building Cassandra Reaper 0.0.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ cassandra-reaper ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 23 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ cassandra-reaper ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ cassandra-reaper ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 7 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ cassandra-reaper ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-surefire-plugin:2.19:test (default-test) @ cassandra-reaper ---
[INFO] Downloading: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19/surefire-junit4-2.19.pom
[INFO] Downloaded: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19/surefire-junit4-2.19.pom (4 KB at 2.9 KB/sec)
[INFO] Downloading: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-providers/2.19/surefire-providers-2.19.pom
[INFO] Downloaded: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-providers/2.19/surefire-providers-2.19.pom (3 KB at 51.0 KB/sec)
[INFO] Downloading: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19/surefire-junit4-2.19.jar
[INFO] Downloaded: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19/surefire-junit4-2.19.jar (75 KB at 627.2 KB/sec)

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running com.spotify.reaper.resources.CommonToolsTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.381 sec - in com.spotify.reaper.resources.CommonToolsTest
Running com.spotify.reaper.resources.view.RepairRunStatusTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in com.spotify.reaper.resources.view.RepairRunStatusTest
Running com.spotify.reaper.resources.view.RepairScheduleStatusTest
20:43:43.568 [main] INFO com.spotify.reaper.resources.view.RepairScheduleStatusTest - DATA: {"id":1,"owner":"testuser","state":"ACTIVE","intensity":0.75,"cluster_name":"testCluster","keyspace_name":"testKeyspace","column_families":[],"incremental_repair":false,"segment_count":0,"repair_parallelism":"parallel","scheduled_days_between":2,"creation_time":"1970-01-01T01:00:00+01:00","next_activation":null,"pause_time":null}
Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 0.603 sec <<< FAILURE! - in com.spotify.reaper.resources.view.RepairScheduleStatusTest
testJacksonJSONParsing(com.spotify.reaper.resources.view.RepairScheduleStatusTest)  Time elapsed: 0.603 sec  <<< ERROR!
java.lang.RuntimeException: 
com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "parallel": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":1,"owner":"testuser","state":"ACTIVE","intensity":0.75,"cluster_name":"testCluster","keyspace_name":"testKeyspace","column_families":[],"incremental_repair":false,"segment_count":0,"repair_parallelism":"parallel","scheduled_days_between":2,"creation_time":"1970-01-01T01:00:00+01:00","next_activation":null,"pause_time":null}; line: 1, column: 209] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
	at com.spotify.reaper.resources.view.RepairScheduleStatusTest.testJacksonJSONParsing(RepairScheduleStatusTest.java:41)
Caused by: com.fasterxml.jackson.databind.exc.InvalidFormatException: 
Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "parallel": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":1,"owner":"testuser","state":"ACTIVE","intensity":0.75,"cluster_name":"testCluster","keyspace_name":"testKeyspace","column_families":[],"incremental_repair":false,"segment_count":0,"repair_parallelism":"parallel","scheduled_days_between":2,"creation_time":"1970-01-01T01:00:00+01:00","next_activation":null,"pause_time":null}; line: 1, column: 209] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
	at com.spotify.reaper.resources.view.RepairScheduleStatusTest.testJacksonJSONParsing(RepairScheduleStatusTest.java:41)

Running com.spotify.reaper.acceptance.AddClusterTest
20:43:43.990 [main] INFO com.spotify.reaper.acceptance.BasicSteps - setting up testing Reaper runner with 2 seed hosts defined
Worker started
INFO  [2017-06-26 18:43:46,465] org.eclipse.jetty.util.log: Logging initialized @5484ms to org.eclipse.jetty.util.log.Slf4jLog
INFO  [2017-06-26 18:43:46,623] io.dropwizard.server.DefaultServerFactory: Registering jersey handler with root path prefix: /
INFO  [2017-06-26 18:43:46,626] io.dropwizard.server.DefaultServerFactory: Registering admin handler with root path prefix: /
INFO  [2017-06-26 18:43:46,631] io.dropwizard.assets.AssetsBundle: Registering AssetBundle with name: assets for path /webui/*
DEBUG [2017-06-26 18:43:46,687] com.spotify.reaper.ReaperApplication: repairIntensity: 0.95
DEBUG [2017-06-26 18:43:46,687] com.spotify.reaper.ReaperApplication: incrementalRepair: false
DEBUG [2017-06-26 18:43:46,687] com.spotify.reaper.ReaperApplication: repairRunThreadCount: 15
DEBUG [2017-06-26 18:43:46,687] com.spotify.reaper.ReaperApplication: segmentCount: 200
DEBUG [2017-06-26 18:43:46,687] com.spotify.reaper.ReaperApplication: repairParallelism: sequential
DEBUG [2017-06-26 18:43:46,687] com.spotify.reaper.ReaperApplication: hangingRepairTimeoutMins: 1
DEBUG [2017-06-26 18:43:46,687] com.spotify.reaper.ReaperApplication: jmxPorts: {127.0.0.1=7100, 127.0.0.2=7200, 127.0.0.3=7300}
DEBUG [2017-06-26 18:43:46,687] com.spotify.reaper.ReaperApplication: adding signal handler for SIGHUP
INFO  [2017-06-26 18:43:46,688] com.spotify.reaper.ReaperApplication: initializing runner thread pool with 15 threads
INFO  [2017-06-26 18:43:46,698] com.spotify.reaper.ReaperApplication: initializing storage of type: memory
DEBUG [2017-06-26 18:43:46,699] com.spotify.reaper.ReaperApplication: using JMX ports mapping: {127.0.0.1=7100, 127.0.0.2=7200, 127.0.0.3=7300}
INFO  [2017-06-26 18:43:46,700] com.spotify.reaper.ReaperApplication: creating and registering health checks
INFO  [2017-06-26 18:43:46,700] com.spotify.reaper.ReaperApplication: creating resources and registering endpoints
INFO  [2017-06-26 18:43:47,711] com.spotify.reaper.service.SchedulingManager: Starting new SchedulingManager instance
INFO  [2017-06-26 18:43:47,713] com.spotify.reaper.ReaperApplication: resuming pending repair runs
INFO  [2017-06-26 18:43:47,714] io.dropwizard.server.DefaultServerFactory: Registering jersey handler with root path prefix: /
INFO  [2017-06-26 18:43:47,715] io.dropwizard.server.DefaultServerFactory: Registering admin handler with root path prefix: /
INFO  [2017-06-26 18:43:47,725] io.dropwizard.server.ServerFactory: Starting cassandra-reaper
_________                                          .___               __________
\_   ___ \_____    ______ ___________    ____    __| _/___________    \______   \ ____ _____  ______   ___________
/    \  \/\__  \  /  ___//  ___/\__  \  /    \  / __ |\_  __ \__  \    |       _// __ \\__  \ \____ \_/ __ \_  __ \
\     \____/ __ \_\___ \ \___ \  / __ \|   |  \/ /_/ | |  | \// __ \_  |    |   \  ___/ / __ \|  |_> >  ___/|  | \/
 \______  (____  /____  >____  >(____  /___|  /\____ | |__|  (____  /  |____|_  /\___  >____  /   __/ \___  >__|
        \/     \/     \/     \/      \/     \/      \/            \/          \/     \/     \/|__|        \/

Worker started
INFO  [2017-06-26 18:43:47,873] org.eclipse.jetty.setuid.SetUIDListener: Opened application@4ce25e47{HTTP/1.1,[http/1.1]}{127.0.0.1:8083}
INFO  [2017-06-26 18:43:47,873] org.eclipse.jetty.setuid.SetUIDListener: Opened admin@6380e9e9{HTTP/1.1,[http/1.1]}{127.0.0.1:8084}
INFO  [2017-06-26 18:43:47,876] org.eclipse.jetty.server.Server: jetty-9.4.2.v20170220
DEBUG [2017-06-26 18:43:48,716] com.spotify.reaper.service.SchedulingManager: Checking for repair schedules...
INFO  [2017-06-26 18:43:49,059] io.dropwizard.jersey.DropwizardResourceConfig: The following paths were found for the configured resources:

    GET     /cluster (com.spotify.reaper.resources.ClusterResource)
    POST    /cluster (com.spotify.reaper.resources.ClusterResource)
    DELETE  /cluster/{cluster_name} (com.spotify.reaper.resources.ClusterResource)
    GET     /cluster/{cluster_name} (com.spotify.reaper.resources.ClusterResource)
    PUT     /cluster/{cluster_name} (com.spotify.reaper.resources.ClusterResource)
    GET     /ping (com.spotify.reaper.resources.PingResource)
    GET     /repair_run (com.spotify.reaper.resources.RepairRunResource)
    POST    /repair_run (com.spotify.reaper.resources.RepairRunResource)
    GET     /repair_run/cluster/{cluster_name} (com.spotify.reaper.resources.RepairRunResource)
    DELETE  /repair_run/{id} (com.spotify.reaper.resources.RepairRunResource)
    GET     /repair_run/{id} (com.spotify.reaper.resources.RepairRunResource)
    PUT     /repair_run/{id} (com.spotify.reaper.resources.RepairRunResource)
    GET     /repair_schedule (com.spotify.reaper.resources.RepairScheduleResource)
    POST    /repair_schedule (com.spotify.reaper.resources.RepairScheduleResource)
    GET     /repair_schedule/cluster/{cluster_name} (com.spotify.reaper.resources.RepairScheduleResource)
    DELETE  /repair_schedule/{id} (com.spotify.reaper.resources.RepairScheduleResource)
    GET     /repair_schedule/{id} (com.spotify.reaper.resources.RepairScheduleResource)
    PUT     /repair_schedule/{id} (com.spotify.reaper.resources.RepairScheduleResource)

INFO  [2017-06-26 18:43:49,067] org.eclipse.jetty.server.handler.ContextHandler: Started i.d.j.MutableServletContextHandler@216c22ce{/,null,AVAILABLE}
INFO  [2017-06-26 18:43:49,076] io.dropwizard.setup.AdminEnvironment: tasks = 

    POST    /tasks/log-level (io.dropwizard.servlets.tasks.LogConfigurationTask)
    POST    /tasks/gc (io.dropwizard.servlets.tasks.GarbageCollectionTask)

INFO  [2017-06-26 18:43:49,088] org.eclipse.jetty.server.handler.ContextHandler: Started i.d.j.MutableServletContextHandler@708769b7{/,null,AVAILABLE}
INFO  [2017-06-26 18:43:49,121] org.eclipse.jetty.server.AbstractConnector: Started application@4ce25e47{HTTP/1.1,[http/1.1]}{127.0.0.1:8083}
INFO  [2017-06-26 18:43:49,129] org.eclipse.jetty.server.AbstractConnector: Started admin@6380e9e9{HTTP/1.1,[http/1.1]}{127.0.0.1:8084}
INFO  [2017-06-26 18:43:49,129] org.eclipse.jetty.server.Server: Started @8148ms
INFO  [2017-06-26 18:43:49,280] com.spotify.reaper.SimpleReaperClient: calling (GET) Reaper in resource: http://localhost:8083/cluster/test_cluster
DEBUG [2017-06-26 18:43:49,931] com.spotify.reaper.resources.ClusterResource: get cluster called with cluster_name: test_cluster
127.0.0.1 - - [26/Jun/2017:18:43:49 +0000] "GET /cluster/test_cluster HTTP/1.1" 404 42 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 288
INFO  [2017-06-26 18:43:49,971] com.spotify.reaper.acceptance.BasicSteps: Got response data: cluster with name "test_cluster" not found
INFO  [2017-06-26 18:43:49,975] com.spotify.reaper.SimpleReaperClient: calling (POST) Reaper in resource: http://localhost:8083/cluster
DEBUG [2017-06-26 18:43:50,090] com.spotify.reaper.resources.ClusterResource: add cluster called with seedHost: 127.0.0.1
DEBUG [2017-06-26 18:43:50,092] com.spotify.reaper.resources.ClusterResource: Seeds [127.0.0.1]
INFO  [2017-06-26 18:43:50,093] com.spotify.reaper.resources.ClusterResource: creating new cluster based on given seed host: test_cluster
INFO  [2017-06-26 18:43:50,128] com.spotify.reaper.SimpleReaperClient: calling (GET) Reaper in resource: http://localhost:8083/cluster/test_cluster
127.0.0.1 - - [26/Jun/2017:18:43:50 +0000] "POST /cluster?seedHost=127.0.0.1 HTTP/1.1" 201 89 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 71
DEBUG [2017-06-26 18:43:50,196] com.spotify.reaper.resources.ClusterResource: get cluster called with cluster_name: test_cluster
127.0.0.1 - - [26/Jun/2017:18:43:50 +0000] "GET /cluster/test_cluster HTTP/1.1" 200 89 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 6
INFO  [2017-06-26 18:43:50,202] com.spotify.reaper.acceptance.BasicSteps: Got response data: {"name":"test_cluster","seed_hosts":["127.0.0.1"],"repair_runs":[],"repair_schedules":[]}
INFO  [2017-06-26 18:43:50,210] com.spotify.reaper.acceptance.BasicSteps: setting up testing Reaper runner with 2 seed hosts defined
INFO  [2017-06-26 18:43:50,214] com.spotify.reaper.SimpleReaperClient: calling (GET) Reaper in resource: http://localhost:8083/cluster/test_cluster
DEBUG [2017-06-26 18:43:50,259] com.spotify.reaper.resources.ClusterResource: get cluster called with cluster_name: test_cluster
INFO  [2017-06-26 18:43:50,261] com.spotify.reaper.acceptance.BasicSteps: Got response data: {"name":"test_cluster","seed_hosts":["127.0.0.1"],"repair_runs":[],"repair_schedules":[]}
INFO  [2017-06-26 18:43:50,264] com.spotify.reaper.SimpleReaperClient: calling (GET) Reaper in resource: http://localhost:8083/repair_schedule/cluster/test_cluster
127.0.0.1 - - [26/Jun/2017:18:43:50 +0000] "GET /cluster/test_cluster HTTP/1.1" 200 89 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 3
DEBUG [2017-06-26 18:43:50,315] com.spotify.reaper.resources.RepairScheduleResource: get repair schedules for cluster called with: cluster_name = test_cluster
127.0.0.1 - - [26/Jun/2017:18:43:50 +0000] "GET /repair_schedule/cluster/test_cluster HTTP/1.1" 200 2 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 23
INFO  [2017-06-26 18:43:50,323] com.spotify.reaper.acceptance.BasicSteps: Got 0 schedules
INFO  [2017-06-26 18:43:50,325] com.spotify.reaper.SimpleReaperClient: calling (POST) Reaper in resource: http://localhost:8083/repair_schedule
INFO  [2017-06-26 18:43:50,364] com.spotify.reaper.resources.RepairScheduleResource: add repair schedule called with: clusterName = Optional.of(test_cluster), keyspace = Optional.of(test_keyspace), tables = Optional.absent(), owner = Optional.of(test_user), segmentCount = Optional.absent(), repairParallelism = Optional.absent(), intensity = Optional.of(0.9), incrementalRepair = Optional.absent(), scheduleDaysBetween = Optional.of(1), scheduleTriggerTime = Optional.absent()
INFO  [2017-06-26 18:43:50,367] com.spotify.reaper.resources.RepairScheduleResource: no schedule_trigger_time given, so setting first scheduling next night: 2017-06-27T00:00:00Z
DEBUG [2017-06-26 18:43:50,367] com.spotify.reaper.resources.RepairScheduleResource: no incremental repair given, so using default value: false
DEBUG [2017-06-26 18:43:50,367] com.spotify.reaper.resources.RepairScheduleResource: using given schedule days between 1 instead of configured value 7
INFO  [2017-06-26 18:43:50,369] com.spotify.reaper.resources.CommonTools: create new repair unit for cluster 'test_cluster', keyspace 'test_keyspace', and column families: []
127.0.0.1 - - [26/Jun/2017:18:43:50 +0000] "POST /repair_schedule?owner=test_user&intensity=0.9&keyspace=test_keyspace&clusterName=test_cluster&scheduleDaysBetween=1 HTTP/1.1" 201 365 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 48
INFO  [2017-06-26 18:43:50,420] com.spotify.reaper.acceptance.BasicSteps: setting up testing Reaper runner with 2 seed hosts defined
INFO  [2017-06-26 18:43:50,425] com.spotify.reaper.SimpleReaperClient: calling (GET) Reaper in resource: http://localhost:8083/cluster/test_cluster
DEBUG [2017-06-26 18:43:50,461] com.spotify.reaper.resources.ClusterResource: get cluster called with cluster_name: test_cluster
INFO  [2017-06-26 18:43:50,464] com.spotify.reaper.acceptance.BasicSteps: Got response data: {"name":"test_cluster","seed_hosts":["127.0.0.1"],"repair_runs":[],"repair_schedules":[{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]}
127.0.0.1 - - [26/Jun/2017:18:43:50 +0000] "GET /cluster/test_cluster HTTP/1.1" 200 454 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 3
INFO  [2017-06-26 18:43:50,470] com.spotify.reaper.SimpleReaperClient: calling (GET) Reaper in resource: http://localhost:8083/repair_schedule/cluster/test_cluster
DEBUG [2017-06-26 18:43:50,533] com.spotify.reaper.resources.RepairScheduleResource: get repair schedules for cluster called with: cluster_name = test_cluster
127.0.0.1 - - [26/Jun/2017:18:43:50 +0000] "GET /repair_schedule/cluster/test_cluster HTTP/1.1" 200 367 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 12
INFO  [2017-06-26 18:43:50,564] com.spotify.reaper.acceptance.BasicSteps: setting up testing Reaper runner with 2 seed hosts defined
INFO  [2017-06-26 18:43:50,568] com.spotify.reaper.SimpleReaperClient: calling (GET) Reaper in resource: http://localhost:8083/cluster/test_cluster
DEBUG [2017-06-26 18:43:50,614] com.spotify.reaper.resources.ClusterResource: get cluster called with cluster_name: test_cluster
127.0.0.1 - - [26/Jun/2017:18:43:50 +0000] "GET /cluster/test_cluster HTTP/1.1" 200 454 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 3
INFO  [2017-06-26 18:43:50,624] com.spotify.reaper.acceptance.BasicSteps: Got response data: {"name":"test_cluster","seed_hosts":["127.0.0.1"],"repair_runs":[],"repair_schedules":[{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]}
INFO  [2017-06-26 18:43:50,627] com.spotify.reaper.SimpleReaperClient: calling (GET) Reaper in resource: http://localhost:8083/repair_schedule/cluster/test_cluster
DEBUG [2017-06-26 18:43:50,741] com.spotify.reaper.resources.RepairScheduleResource: get repair schedules for cluster called with: cluster_name = test_cluster
127.0.0.1 - - [26/Jun/2017:18:43:50 +0000] "GET /repair_schedule/cluster/test_cluster HTTP/1.1" 200 367 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 14
INFO  [2017-06-26 18:43:50,769] com.spotify.reaper.acceptance.BasicSteps: setting up testing Reaper runner with 2 seed hosts defined
INFO  [2017-06-26 18:43:50,778] com.spotify.reaper.SimpleReaperClient: calling (GET) Reaper in resource: http://localhost:8083/cluster/other_cluster
DEBUG [2017-06-26 18:43:50,848] com.spotify.reaper.resources.ClusterResource: get cluster called with cluster_name: other_cluster
127.0.0.1 - - [26/Jun/2017:18:43:50 +0000] "GET /cluster/other_cluster HTTP/1.1" 404 43 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 6
INFO  [2017-06-26 18:43:50,853] com.spotify.reaper.acceptance.BasicSteps: Got response data: cluster with name "other_cluster" not found
INFO  [2017-06-26 18:43:50,856] com.spotify.reaper.SimpleReaperClient: calling (POST) Reaper in resource: http://localhost:8083/cluster
DEBUG [2017-06-26 18:43:50,919] com.spotify.reaper.resources.ClusterResource: add cluster called with seedHost: 127.0.0.2
DEBUG [2017-06-26 18:43:50,920] com.spotify.reaper.resources.ClusterResource: Seeds [127.0.0.2]
INFO  [2017-06-26 18:43:50,920] com.spotify.reaper.resources.ClusterResource: creating new cluster based on given seed host: other_cluster
127.0.0.1 - - [26/Jun/2017:18:43:50 +0000] "POST /cluster?seedHost=127.0.0.2 HTTP/1.1" 201 90 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 3
INFO  [2017-06-26 18:43:50,955] com.spotify.reaper.SimpleReaperClient: calling (GET) Reaper in resource: http://localhost:8083/cluster/other_cluster
DEBUG [2017-06-26 18:43:50,986] com.spotify.reaper.resources.ClusterResource: get cluster called with cluster_name: other_cluster
127.0.0.1 - - [26/Jun/2017:18:43:50 +0000] "GET /cluster/other_cluster HTTP/1.1" 200 90 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 2
INFO  [2017-06-26 18:43:50,988] com.spotify.reaper.acceptance.BasicSteps: Got response data: {"name":"other_cluster","seed_hosts":["127.0.0.2"],"repair_runs":[],"repair_schedules":[]}
INFO  [2017-06-26 18:43:50,991] com.spotify.reaper.SimpleReaperClient: calling (GET) Reaper in resource: http://localhost:8083/repair_schedule/cluster/other_cluster
DEBUG [2017-06-26 18:43:51,022] com.spotify.reaper.resources.RepairScheduleResource: get repair schedules for cluster called with: cluster_name = other_cluster
127.0.0.1 - - [26/Jun/2017:18:43:51 +0000] "GET /repair_schedule/cluster/other_cluster HTTP/1.1" 200 2 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 2
INFO  [2017-06-26 18:43:51,028] com.spotify.reaper.acceptance.BasicSteps: Got 0 schedules
INFO  [2017-06-26 18:43:51,039] com.spotify.reaper.SimpleReaperClient: calling (POST) Reaper in resource: http://localhost:8083/repair_schedule
INFO  [2017-06-26 18:43:51,126] com.spotify.reaper.resources.RepairScheduleResource: add repair schedule called with: clusterName = Optional.of(other_cluster), keyspace = Optional.of(other_keyspace), tables = Optional.absent(), owner = Optional.of(test_user), segmentCount = Optional.absent(), repairParallelism = Optional.absent(), intensity = Optional.of(0.9), incrementalRepair = Optional.absent(), scheduleDaysBetween = Optional.of(1), scheduleTriggerTime = Optional.absent()
INFO  [2017-06-26 18:43:51,126] com.spotify.reaper.resources.RepairScheduleResource: no schedule_trigger_time given, so setting first scheduling next night: 2017-06-27T00:00:00Z
DEBUG [2017-06-26 18:43:51,126] com.spotify.reaper.resources.RepairScheduleResource: no incremental repair given, so using default value: false
DEBUG [2017-06-26 18:43:51,126] com.spotify.reaper.resources.RepairScheduleResource: using given schedule days between 1 instead of configured value 7
INFO  [2017-06-26 18:43:51,127] com.spotify.reaper.resources.CommonTools: create new repair unit for cluster 'other_cluster', keyspace 'other_keyspace', and column families: []
127.0.0.1 - - [26/Jun/2017:18:43:51 +0000] "POST /repair_schedule?owner=test_user&intensity=0.9&keyspace=other_keyspace&clusterName=other_cluster&scheduleDaysBetween=1 HTTP/1.1" 201 367 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 4
INFO  [2017-06-26 18:43:51,152] com.spotify.reaper.acceptance.BasicSteps: setting up testing Reaper runner with 2 seed hosts defined
INFO  [2017-06-26 18:43:51,158] com.spotify.reaper.SimpleReaperClient: calling (GET) Reaper in resource: http://localhost:8083/cluster/other_cluster
DEBUG [2017-06-26 18:43:51,202] com.spotify.reaper.resources.ClusterResource: get cluster called with cluster_name: other_cluster
127.0.0.1 - - [26/Jun/2017:18:43:51 +0000] "GET /cluster/other_cluster HTTP/1.1" 200 457 "-" "Jersey/2.25.1 (HttpUrlConnection 1.8.0_121)" 3
INFO  [2017-06-26 18:43:51,205] com.spotify.reaper.acceptance.BasicSteps: Got response data: {"name":"other_cluster","seed_hosts":["127.0.0.2"],"repair_runs":[],"repair_schedules":[{"id":2,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"other_cluster","keyspace_name":"other_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:51Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]}

[31mFailed scenarios:[0m
[31mcom.spotify.reaper.acceptance/basic_reaper_functionality.feature:21 [0m# Scenario: Registering a scheduled repair
[31mcom.spotify.reaper.acceptance/basic_reaper_functionality.feature:28 [0m# Scenario: Deleting a scheduled repair
[31mcom.spotify.reaper.acceptance/basic_reaper_functionality.feature:39 [0m# Scenario: Adding a scheduled repair that already exists
[31mcom.spotify.reaper.acceptance/basic_reaper_functionality.feature:46 [0m# Scenario: Create a cluster and a repair run and delete them
[31mcom.spotify.reaper.acceptance/basic_reaper_functionality.feature:63 [0m# Scenario: Create a cluster and one incremental repair run and one full repair run on the same keyspace

6 Scenarios ([31m5 failed[0m, [32m1 passed[0m)
94 Steps ([31m5 failed[0m, [36m28 skipped[0m, [32m61 passed[0m)
0m7.347s

java.lang.RuntimeException: com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 228] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
	at com.spotify.reaper.SimpleReaperClient.parseJSON(SimpleReaperClient.java:92)
	at com.spotify.reaper.SimpleReaperClient.parseRepairScheduleStatusJSON(SimpleReaperClient.java:103)
	at com.spotify.reaper.acceptance.BasicSteps.a_new_daily_repair_schedule_is_added_for(BasicSteps.java:224)
	at ✽.When a new daily repair schedule is added for "test_cluster" and keyspace "test_keyspace"(com.spotify.reaper.acceptance/basic_reaper_functionality.feature:24)
Caused by: com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 228] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:74)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1410)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:926)
	at com.fasterxml.jackson.databind.deser.std.EnumDeserializer._deserializeAltString(EnumDeserializer.java:189)
	at com.fasterxml.jackson.databind.deser.std.EnumDeserializer.deserialize(EnumDeserializer.java:126)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:504)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:101)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:276)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:140)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:3798)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:2861)
	at com.spotify.reaper.SimpleReaperClient.parseJSON(SimpleReaperClient.java:89)
	at com.spotify.reaper.SimpleReaperClient.parseRepairScheduleStatusJSON(SimpleReaperClient.java:103)
	at com.spotify.reaper.acceptance.BasicSteps.a_new_daily_repair_schedule_is_added_for(BasicSteps.java:224)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at cucumber.runtime.Utils$1.call(Utils.java:40)
	at cucumber.runtime.Timeout.timeout(Timeout.java:16)
	at cucumber.runtime.Utils.invoke(Utils.java:34)
	at cucumber.runtime.java.JavaStepDefinition.execute(JavaStepDefinition.java:38)
	at cucumber.runtime.StepDefinitionMatch.runStep(StepDefinitionMatch.java:37)
	at cucumber.runtime.Runtime.runStep(Runtime.java:300)
	at cucumber.runtime.model.StepContainer.runStep(StepContainer.java:44)
	at cucumber.runtime.model.StepContainer.runSteps(StepContainer.java:39)
	at cucumber.runtime.model.CucumberScenario.run(CucumberScenario.java:44)
	at cucumber.runtime.junit.ExecutionUnitRunner.run(ExecutionUnitRunner.java:102)
	at cucumber.runtime.junit.FeatureRunner.runChild(FeatureRunner.java:63)
	at cucumber.runtime.junit.FeatureRunner.runChild(FeatureRunner.java:18)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at cucumber.runtime.junit.FeatureRunner.run(FeatureRunner.java:70)
	at cucumber.api.junit.Cucumber.runChild(Cucumber.java:95)
	at cucumber.api.junit.Cucumber.runChild(Cucumber.java:38)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at cucumber.api.junit.Cucumber.run(Cucumber.java:100)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:344)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:269)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:240)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:184)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:286)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:240)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:121)

java.lang.RuntimeException: com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
	at com.spotify.reaper.SimpleReaperClient.parseJSON(SimpleReaperClient.java:92)
	at com.spotify.reaper.SimpleReaperClient.parseRepairScheduleStatusListJSON(SimpleReaperClient.java:98)
	at com.spotify.reaper.SimpleReaperClient.getRepairSchedulesForCluster(SimpleReaperClient.java:140)
	at com.spotify.reaper.acceptance.BasicSteps.reaper_has_scheduled_repairs_for_cluster_called(BasicSteps.java:275)
	at ✽.And reaper has 1 scheduled repairs for cluster called "test_cluster"(com.spotify.reaper.acceptance/basic_reaper_functionality.feature:30)
Caused by: com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:74)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1410)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:926)
	at com.fasterxml.jackson.databind.deser.std.EnumDeserializer._deserializeAltString(EnumDeserializer.java:189)
	at com.fasterxml.jackson.databind.deser.std.EnumDeserializer.deserialize(EnumDeserializer.java:126)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:504)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:101)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:276)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:140)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:287)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:259)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:26)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:3798)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:2861)
	at com.spotify.reaper.SimpleReaperClient.parseJSON(SimpleReaperClient.java:89)
	at com.spotify.reaper.SimpleReaperClient.parseRepairScheduleStatusListJSON(SimpleReaperClient.java:98)
	at com.spotify.reaper.SimpleReaperClient.getRepairSchedulesForCluster(SimpleReaperClient.java:140)
	at com.spotify.reaper.acceptance.BasicSteps.reaper_has_scheduled_repairs_for_cluster_called(BasicSteps.java:275)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at cucumber.runtime.Utils$1.call(Utils.java:40)
	at cucumber.runtime.Timeout.timeout(Timeout.java:16)
	at cucumber.runtime.Utils.invoke(Utils.java:34)
	at cucumber.runtime.java.JavaStepDefinition.execute(JavaStepDefinition.java:38)
	at cucumber.runtime.StepDefinitionMatch.runStep(StepDefinitionMatch.java:37)
	at cucumber.runtime.Runtime.runStep(Runtime.java:300)
	at cucumber.runtime.model.StepContainer.runStep(StepContainer.java:44)
	at cucumber.runtime.model.StepContainer.runSteps(StepContainer.java:39)
	at cucumber.runtime.model.CucumberScenario.run(CucumberScenario.java:44)
	at cucumber.runtime.junit.ExecutionUnitRunner.run(ExecutionUnitRunner.java:102)
	at cucumber.runtime.junit.FeatureRunner.runChild(FeatureRunner.java:63)
	at cucumber.runtime.junit.FeatureRunner.runChild(FeatureRunner.java:18)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at cucumber.runtime.junit.FeatureRunner.run(FeatureRunner.java:70)
	at cucumber.api.junit.Cucumber.runChild(Cucumber.java:95)
	at cucumber.api.junit.Cucumber.runChild(Cucumber.java:38)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at cucumber.api.junit.Cucumber.run(Cucumber.java:100)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:344)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:269)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:240)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:184)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:286)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:240)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:121)

java.lang.RuntimeException: com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
	at com.spotify.reaper.SimpleReaperClient.parseJSON(SimpleReaperClient.java:92)
	at com.spotify.reaper.SimpleReaperClient.parseRepairScheduleStatusListJSON(SimpleReaperClient.java:98)
	at com.spotify.reaper.SimpleReaperClient.getRepairSchedulesForCluster(SimpleReaperClient.java:140)
	at com.spotify.reaper.acceptance.BasicSteps.reaper_has_scheduled_repairs_for_cluster_called(BasicSteps.java:275)
	at ✽.And reaper has 2 scheduled repairs for cluster called "test_cluster"(com.spotify.reaper.acceptance/basic_reaper_functionality.feature:41)
Caused by: com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:74)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1410)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:926)
	at com.fasterxml.jackson.databind.deser.std.EnumDeserializer._deserializeAltString(EnumDeserializer.java:189)
	at com.fasterxml.jackson.databind.deser.std.EnumDeserializer.deserialize(EnumDeserializer.java:126)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:504)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:101)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:276)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:140)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:287)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:259)
	at com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:26)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:3798)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:2861)
	at com.spotify.reaper.SimpleReaperClient.parseJSON(SimpleReaperClient.java:89)
	at com.spotify.reaper.SimpleReaperClient.parseRepairScheduleStatusListJSON(SimpleReaperClient.java:98)
	at com.spotify.reaper.SimpleReaperClient.getRepairSchedulesForCluster(SimpleReaperClient.java:140)
	at com.spotify.reaper.acceptance.BasicSteps.reaper_has_scheduled_repairs_for_cluster_called(BasicSteps.java:275)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at cucumber.runtime.Utils$1.call(Utils.java:40)
	at cucumber.runtime.Timeout.timeout(Timeout.java:16)
	at cucumber.runtime.Utils.invoke(Utils.java:34)
	at cucumber.runtime.java.JavaStepDefinition.execute(JavaStepDefinition.java:38)
	at cucumber.runtime.StepDefinitionMatch.runStep(StepDefinitionMatch.java:37)
	at cucumber.runtime.Runtime.runStep(Runtime.java:300)
	at cucumber.runtime.model.StepContainer.runStep(StepContainer.java:44)
	at cucumber.runtime.model.StepContainer.runSteps(StepContainer.java:39)
	at cucumber.runtime.model.CucumberScenario.run(CucumberScenario.java:44)
	at cucumber.runtime.junit.ExecutionUnitRunner.run(ExecutionUnitRunner.java:102)
	at cucumber.runtime.junit.FeatureRunner.runChild(FeatureRunner.java:63)
	at cucumber.runtime.junit.FeatureRunner.runChild(FeatureRunner.java:18)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at cucumber.runtime.junit.FeatureRunner.run(FeatureRunner.java:70)
	at cucumber.api.junit.Cucumber.runChild(Cucumber.java:95)
	at cucumber.api.junit.Cucumber.runChild(Cucumber.java:38)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at cucumber.api.junit.Cucumber.run(Cucumber.java:100)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:344)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:269)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:240)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:184)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:286)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:240)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:121)

java.lang.RuntimeException: com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":2,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"other_cluster","keyspace_name":"other_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:51Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 230] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
	at com.spotify.reaper.SimpleReaperClient.parseJSON(SimpleReaperClient.java:92)
	at com.spotify.reaper.SimpleReaperClient.parseRepairScheduleStatusJSON(SimpleReaperClient.java:103)
	at com.spotify.reaper.acceptance.BasicSteps.a_new_daily_repair_schedule_is_added_for(BasicSteps.java:224)
	at ✽.When a new daily repair schedule is added for "other_cluster" and keyspace "other_keyspace"(com.spotify.reaper.acceptance/basic_reaper_functionality.feature:52)
Caused by: com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":2,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"other_cluster","keyspace_name":"other_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:51Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 230] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
	at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:74)
	at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1410)
	at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(DeserializationContext.java:926)
	at com.fasterxml.jackson.databind.deser.std.EnumDeserializer._deserializeAltString(EnumDeserializer.java:189)
	at com.fasterxml.jackson.databind.deser.std.EnumDeserializer.deserialize(EnumDeserializer.java:126)
	at com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:504)
	at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:101)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:276)
	at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:140)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:3798)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:2861)
	at com.spotify.reaper.SimpleReaperClient.parseJSON(SimpleReaperClient.java:89)
	at com.spotify.reaper.SimpleReaperClient.parseRepairScheduleStatusJSON(SimpleReaperClient.java:103)
	at com.spotify.reaper.acceptance.BasicSteps.a_new_daily_repair_schedule_is_added_for(BasicSteps.java:224)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at cucumber.runtime.Utils$1.call(Utils.java:40)
	at cucumber.runtime.Timeout.timeout(Timeout.java:16)
	at cucumber.runtime.Utils.invoke(Utils.java:34)
	at cucumber.runtime.java.JavaStepDefinition.execute(JavaStepDefinition.java:38)
	at cucumber.runtime.StepDefinitionMatch.runStep(StepDefinitionMatch.java:37)
	at cucumber.runtime.Runtime.runStep(Runtime.java:300)
	at cucumber.runtime.model.StepContainer.runStep(StepContainer.java:44)
	at cucumber.runtime.model.StepContainer.runSteps(StepContainer.java:39)
	at cucumber.runtime.model.CucumberScenario.run(CucumberScenario.java:44)
	at cucumber.runtime.junit.ExecutionUnitRunner.run(ExecutionUnitRunner.java:102)
	at cucumber.runtime.junit.FeatureRunner.runChild(FeatureRunner.java:63)
	at cucumber.runtime.junit.FeatureRunner.runChild(FeatureRunner.java:18)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at cucumber.runtime.junit.FeatureRunner.run(FeatureRunner.java:70)
	at cucumber.api.junit.Cucumber.runChild(Cucumber.java:95)
	at cucumber.api.junit.Cucumber.runChild(Cucumber.java:38)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at cucumber.api.junit.Cucumber.run(Cucumber.java:100)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:344)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:269)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:240)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:184)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:286)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:240)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:121)

java.lang.AssertionError: expected:<404> but was:<200>
	at org.junit.Assert.fail(Assert.java:88)
	at org.junit.Assert.failNotEquals(Assert.java:743)
	at org.junit.Assert.assertEquals(Assert.java:118)
	at org.junit.Assert.assertEquals(Assert.java:555)
	at org.junit.Assert.assertEquals(Assert.java:542)
	at com.spotify.reaper.acceptance.BasicSteps.callAndExpect(BasicSteps.java:105)
	at com.spotify.reaper.acceptance.BasicSteps.reaper_has_no_cluster_with_name_in_storage(BasicSteps.java:158)
	at ✽.Given reaper has no cluster with name "other_cluster" in storage(com.spotify.reaper.acceptance/basic_reaper_functionality.feature:64)

Tests run: 100, Failures: 2, Errors: 8, Skipped: 28, Time elapsed: 7.518 sec <<< FAILURE! - in com.spotify.reaper.acceptance.AddClusterTest
When a new daily repair schedule is added for "test_cluster" and keyspace "test_keyspace"(Scenario: Registering a scheduled repair)  Time elapsed: 0 sec  <<< ERROR!
java.lang.RuntimeException: 
com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 228] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
Caused by: com.fasterxml.jackson.databind.exc.InvalidFormatException: 
Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 228] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])

Scenario: Registering a scheduled repair  Time elapsed: 0 sec  <<< ERROR!
java.lang.RuntimeException: 
com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 228] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
Caused by: com.fasterxml.jackson.databind.exc.InvalidFormatException: 
Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 228] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])

And reaper has 1 scheduled repairs for cluster called "test_cluster"(Scenario: Deleting a scheduled repair)  Time elapsed: 0 sec  <<< ERROR!
java.lang.RuntimeException: 
com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
Caused by: com.fasterxml.jackson.databind.exc.InvalidFormatException: 
Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])

Scenario: Deleting a scheduled repair  Time elapsed: 0.002 sec  <<< ERROR!
java.lang.RuntimeException: 
com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
Caused by: com.fasterxml.jackson.databind.exc.InvalidFormatException: 
Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])

And reaper has 2 scheduled repairs for cluster called "test_cluster"(Scenario: Adding a scheduled repair that already exists)  Time elapsed: 0.001 sec  <<< ERROR!
java.lang.RuntimeException: 
com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
Caused by: com.fasterxml.jackson.databind.exc.InvalidFormatException: 
Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])

Scenario: Adding a scheduled repair that already exists  Time elapsed: 0.01 sec  <<< ERROR!
java.lang.RuntimeException: 
com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
Caused by: com.fasterxml.jackson.databind.exc.InvalidFormatException: 
Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])

When a new daily repair schedule is added for "other_cluster" and keyspace "other_keyspace"(Scenario: Create a cluster and a repair run and delete them)  Time elapsed: 0.004 sec  <<< ERROR!
java.lang.RuntimeException: 
com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":2,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"other_cluster","keyspace_name":"other_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:51Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 230] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
Caused by: com.fasterxml.jackson.databind.exc.InvalidFormatException: 
Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":2,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"other_cluster","keyspace_name":"other_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:51Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 230] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])

Scenario: Create a cluster and a repair run and delete them  Time elapsed: 0.004 sec  <<< ERROR!
java.lang.RuntimeException: 
com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":2,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"other_cluster","keyspace_name":"other_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:51Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 230] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
Caused by: com.fasterxml.jackson.databind.exc.InvalidFormatException: 
Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":2,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"other_cluster","keyspace_name":"other_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:51Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 230] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])

Given reaper has no cluster with name "other_cluster" in storage(Scenario: Create a cluster and one incremental repair run and one full repair run on the same keyspace)  Time elapsed: 0.002 sec  <<< FAILURE!
java.lang.AssertionError: expected:<404> but was:<200>

Scenario: Create a cluster and one incremental repair run and one full repair run on the same keyspace  Time elapsed: 0.005 sec  <<< FAILURE!
java.lang.AssertionError: expected:<404> but was:<200>

Running com.spotify.reaper.ReaperApplicationConfigurationTest
DEBUG [2017-06-26 18:43:51,281] org.hibernate.validator.internal.engine.resolver.DefaultTraversableResolver: Cannot find javax.persistence.Persistence on classpath. Assuming non JPA 2 environment. All properties will per default be traversable.
DEBUG [2017-06-26 18:43:51,281] org.hibernate.validator.internal.xml.ValidationXmlParser: Trying to load META-INF/validation.xml for XML based Validator configuration.
DEBUG [2017-06-26 18:43:51,282] org.hibernate.validator.internal.xml.ResourceLoaderHelper: Trying to load META-INF/validation.xml via TCCL
DEBUG [2017-06-26 18:43:51,283] org.hibernate.validator.internal.xml.ResourceLoaderHelper: Trying to load META-INF/validation.xml via Hibernate Validator's class loader
DEBUG [2017-06-26 18:43:51,283] org.hibernate.validator.internal.xml.ValidationXmlParser: No META-INF/validation.xml found. Using annotation based configuration only.
DEBUG [2017-06-26 18:43:51,291] org.hibernate.validator.internal.metadata.descriptor.ConstraintDescriptorImpl: Adding composing constraint: ConstraintDescriptorImpl{annotation=javax.validation.constraints.NotNull, payloads=[], hasComposingConstraints=true, isReportAsSingleInvalidConstraint=false, elementType=FIELD, definedOn=DEFINED_LOCALLY, groups=[interface javax.validation.groups.Default], attributes={message={javax.validation.constraints.NotNull.message}, payload=[Ljava.lang.Class;@27dc81be, groups=[Ljava.lang.Class;@3595086b}, constraintType=GENERIC}.
DEBUG [2017-06-26 18:43:51,292] org.hibernate.validator.internal.metadata.descriptor.ConstraintDescriptorImpl: Adding composing constraint: ConstraintDescriptorImpl{annotation=javax.validation.constraints.Size, payloads=[], hasComposingConstraints=true, isReportAsSingleInvalidConstraint=false, elementType=FIELD, definedOn=DEFINED_LOCALLY, groups=[interface javax.validation.groups.Default], attributes={groups=[Ljava.lang.Class;@7157413e, min=1, message={javax.validation.constraints.Size.message}, payload=[Ljava.lang.Class;@3245efdb, max=2147483647}, constraintType=GENERIC}.
DEBUG [2017-06-26 18:43:51,329] org.hibernate.validator.resourceloading.PlatformResourceBundleLocator: ValidationMessages not found.
DEBUG [2017-06-26 18:43:51,331] org.hibernate.validator.resourceloading.PlatformResourceBundleLocator: ContributorValidationMessages not found.
DEBUG [2017-06-26 18:43:51,348] org.hibernate.validator.resourceloading.PlatformResourceBundleLocator: org.hibernate.validator.ValidationMessages found.
DEBUG [2017-06-26 18:43:51,439] org.hibernate.validator.internal.metadata.descriptor.ConstraintDescriptorImpl: Adding composing constraint: ConstraintDescriptorImpl{annotation=javax.validation.constraints.NotNull, payloads=[], hasComposingConstraints=true, isReportAsSingleInvalidConstraint=false, elementType=FIELD, definedOn=DEFINED_LOCALLY, groups=[interface javax.validation.groups.Default], attributes={message={javax.validation.constraints.NotNull.message}, payload=[Ljava.lang.Class;@467a2584, groups=[Ljava.lang.Class;@121dce2}, constraintType=GENERIC}.
DEBUG [2017-06-26 18:43:51,439] org.hibernate.validator.internal.metadata.descriptor.ConstraintDescriptorImpl: Adding composing constraint: ConstraintDescriptorImpl{annotation=javax.validation.constraints.Size, payloads=[], hasComposingConstraints=true, isReportAsSingleInvalidConstraint=false, elementType=FIELD, definedOn=DEFINED_LOCALLY, groups=[interface javax.validation.groups.Default], attributes={groups=[Ljava.lang.Class;@6df31abf, min=1, message={javax.validation.constraints.Size.message}, payload=[Ljava.lang.Class;@5a57cf90, max=2147483647}, constraintType=GENERIC}.
DEBUG [2017-06-26 18:43:51,440] org.hibernate.validator.internal.metadata.descriptor.ConstraintDescriptorImpl: Adding composing constraint: ConstraintDescriptorImpl{annotation=javax.validation.constraints.NotNull, payloads=[], hasComposingConstraints=true, isReportAsSingleInvalidConstraint=false, elementType=FIELD, definedOn=DEFINED_LOCALLY, groups=[interface javax.validation.groups.Default], attributes={message={javax.validation.constraints.NotNull.message}, payload=[Ljava.lang.Class;@4d16975b, groups=[Ljava.lang.Class;@425f94d7}, constraintType=GENERIC}.
DEBUG [2017-06-26 18:43:51,441] org.hibernate.validator.internal.metadata.descriptor.ConstraintDescriptorImpl: Adding composing constraint: ConstraintDescriptorImpl{annotation=javax.validation.constraints.Size, payloads=[], hasComposingConstraints=true, isReportAsSingleInvalidConstraint=false, elementType=FIELD, definedOn=DEFINED_LOCALLY, groups=[interface javax.validation.groups.Default], attributes={groups=[Ljava.lang.Class;@2a16d393, min=1, message={javax.validation.constraints.Size.message}, payload=[Ljava.lang.Class;@14d1032a, max=2147483647}, constraintType=GENERIC}.
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.15 sec - in com.spotify.reaper.ReaperApplicationConfigurationTest
Running com.spotify.reaper.unit.resources.RepairRunResourceTest
WARN  [2017-06-26 18:43:51,823] com.spotify.reaper.resources.RepairRunResource: Listing repair runs called with erroneous states: NOT_EXISTING
! java.lang.IllegalArgumentException: No enum constant com.spotify.reaper.core.RepairRun.RunState.NOT_EXISTING
! at java.lang.Enum.valueOf(Enum.java:238)
! at com.spotify.reaper.core.RepairRun$RunState.valueOf(RepairRun.java:156)
! at com.spotify.reaper.resources.RepairRunResource.splitStateParam(RepairRunResource.java:476)
! at com.spotify.reaper.unit.resources.RepairRunResourceTest.testSplitStateParam(RepairRunResourceTest.java:304)
! at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
! at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
! at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
! at java.lang.reflect.Method.invoke(Method.java:498)
! at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
! at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
! at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
! at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
! at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
! at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
! at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
! at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
! at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
! at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
! at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
! at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
! at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
! at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
! at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:344)
! at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:269)
! at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:240)
! at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:184)
! at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:286)
! at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:240)
! at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:121)
WARN  [2017-06-26 18:43:51,824] com.spotify.reaper.resources.RepairRunResource: Listing repair runs called with erroneous states: NOT_EXISTING,RUNNING
! java.lang.IllegalArgumentException: No enum constant com.spotify.reaper.core.RepairRun.RunState.NOT_EXISTING
! at java.lang.Enum.valueOf(Enum.java:238)
! at com.spotify.reaper.core.RepairRun$RunState.valueOf(RepairRun.java:156)
! at com.spotify.reaper.resources.RepairRunResource.splitStateParam(RepairRunResource.java:476)
! at com.spotify.reaper.unit.resources.RepairRunResourceTest.testSplitStateParam(RepairRunResourceTest.java:306)
! at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
! at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
! at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
! at java.lang.reflect.Method.invoke(Method.java:498)
! at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
! at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
! at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
! at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
! at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
! at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
! at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
! at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
! at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
! at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
! at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
! at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
! at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
! at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
! at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:344)
! at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:269)
! at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:240)
! at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:184)
! at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:286)
! at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:240)
! at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:121)
INFO  [2017-06-26 18:43:51,863] com.spotify.reaper.resources.RepairRunResource: add repair run called with: clusterName = Optional.of(testcluster), keyspace = Optional.absent(), tables = Optional.of(testTable), owner = Optional.of(test), cause = Optional.absent(), segmentCount = Optional.of(6), repairParallelism = Optional.of(SEQUENTIAL), intensity = Optional.absent(), incrementalRepair = Optional.absent()
INFO  [2017-06-26 18:43:51,871] com.spotify.reaper.resources.RepairRunResource: add repair run called with: clusterName = Optional.of(testcluster), keyspace = Optional.of(testKeyspace), tables = Optional.of(testTable), owner = Optional.of(test), cause = Optional.of(), segmentCount = Optional.of(6), repairParallelism = Optional.of(SEQUENTIAL), intensity = Optional.absent(), incrementalRepair = Optional.absent()
DEBUG [2017-06-26 18:43:51,871] com.spotify.reaper.resources.RepairRunResource: no intensity given, so using default value: 0.5
DEBUG [2017-06-26 18:43:51,871] com.spotify.reaper.resources.RepairRunResource: no incremental repair given, so using default value: false
DEBUG [2017-06-26 18:43:51,871] com.spotify.reaper.resources.RepairRunResource: using given segment count 6 instead of configured value 6
INFO  [2017-06-26 18:43:51,872] com.spotify.reaper.resources.CommonTools: use existing repair unit for cluster 'testcluster', keyspace 'testKeyspace', and column families: [testTable]
DEBUG [2017-06-26 18:43:51,872] com.spotify.reaper.resources.RepairRunResource: using given repair parallelism SEQUENTIAL instead of configured value null
INFO  [2017-06-26 18:43:51,882] com.spotify.reaper.service.SegmentGenerator: Dividing token range [0,100) into 1 segments
DEBUG [2017-06-26 18:43:51,901] com.spotify.reaper.service.SegmentGenerator: Segment #1: [0,100)
INFO  [2017-06-26 18:43:51,901] com.spotify.reaper.service.SegmentGenerator: Dividing token range [100,200) into 1 segments
DEBUG [2017-06-26 18:43:51,901] com.spotify.reaper.service.SegmentGenerator: Segment #1: [100,200)
INFO  [2017-06-26 18:43:51,901] com.spotify.reaper.service.SegmentGenerator: Dividing token range [200,0) into 6 segments
DEBUG [2017-06-26 18:43:51,901] com.spotify.reaper.service.SegmentGenerator: Segment #1: [200,28356863910078205288614550619314017788)
DEBUG [2017-06-26 18:43:51,901] com.spotify.reaper.service.SegmentGenerator: Segment #2: [28356863910078205288614550619314017788,56713727820156410577229101238628035376)
DEBUG [2017-06-26 18:43:51,901] com.spotify.reaper.service.SegmentGenerator: Segment #3: [56713727820156410577229101238628035376,85070591730234615865843651857942052964)
DEBUG [2017-06-26 18:43:51,902] com.spotify.reaper.service.SegmentGenerator: Segment #4: [85070591730234615865843651857942052964,113427455640312821154458202477256070552)
DEBUG [2017-06-26 18:43:51,902] com.spotify.reaper.service.SegmentGenerator: Segment #5: [113427455640312821154458202477256070552,141784319550391026443072753096570088140)
DEBUG [2017-06-26 18:43:51,902] com.spotify.reaper.service.SegmentGenerator: Segment #6: [141784319550391026443072753096570088140,0)
DEBUG [2017-06-26 18:43:51,910] com.spotify.reaper.resources.CommonTools: created segment amount differs from expected default 6 != 8
INFO  [2017-06-26 18:43:51,912] com.spotify.reaper.resources.RepairRunResource: modify repair run state called with: id = 1, state = Optional.of(RUNNING)
INFO  [2017-06-26 18:43:51,913] com.spotify.reaper.resources.RepairRunResource: Starting run 1
INFO  [2017-06-26 18:43:51,913] com.spotify.reaper.service.RepairManager: Starting a run with id #1 with current state 'NOT_STARTED'
INFO  [2017-06-26 18:43:51,913] com.spotify.reaper.service.RepairManager: scheduling repair for repair run #1
DEBUG [2017-06-26 18:43:51,916] com.spotify.reaper.service.RepairRunner: Creating RepairRunner for run with ID 1
DEBUG [2017-06-26 18:43:51,960] com.spotify.reaper.service.RepairRunner: run() called for repair run #1 with run state RUNNING
DEBUG [2017-06-26 18:43:51,961] com.spotify.reaper.service.RepairRunner: connecting JMX proxy for repair runner on run id: 1
DEBUG [2017-06-26 18:43:51,961] com.spotify.reaper.service.RepairRunner: successfully reestablished JMX proxy for repair runner
INFO  [2017-06-26 18:43:51,961] com.spotify.reaper.service.RepairRunner: Next segment to run : 1
DEBUG [2017-06-26 18:43:51,962] com.spotify.reaper.service.RepairRunner: Did set segment id `1` to slot 0
DEBUG [2017-06-26 18:43:51,962] com.spotify.reaper.service.RepairRunner: preparing to repair segment 1 on run with id 1
INFO  [2017-06-26 18:43:51,982] com.spotify.reaper.service.RepairRunner: Next segment to run : 5
DEBUG [2017-06-26 18:43:51,982] com.spotify.reaper.service.RepairRunner: Did set segment id `5` to slot 1
DEBUG [2017-06-26 18:43:51,982] com.spotify.reaper.service.RepairRunner: preparing to repair segment 5 on run with id 1
DEBUG [2017-06-26 18:43:51,986] com.spotify.reaper.service.RepairRunner: run() exiting for repair run #1
DEBUG [2017-06-26 18:43:51,987] com.spotify.reaper.service.SegmentRunner: Run repair for segment #1
DEBUG [2017-06-26 18:43:51,987] com.spotify.reaper.service.SegmentRunner: checking host '' for pending compactions and other repairs (can repair?) Run id '1'
INFO  [2017-06-26 18:43:51,988] com.spotify.reaper.service.SegmentRunner: It is ok to repair segment '1' on repair run with id '1'
DEBUG [2017-06-26 18:43:51,988] com.spotify.reaper.service.SegmentRunner: Enter synchronized section with segment ID 1
DEBUG [2017-06-26 18:43:51,988] com.spotify.reaper.service.SegmentRunner: Triggered repair with command id 1
INFO  [2017-06-26 18:43:51,999] com.spotify.reaper.service.SegmentRunner: Repair for segment 1 started, status wait will timeout in 60000 millis
INFO  [2017-06-26 18:43:52,952] com.spotify.reaper.resources.RepairRunResource: modify repair run state called with: id = 1, state = Optional.of(RUNNING)
INFO  [2017-06-26 18:43:52,955] com.spotify.reaper.resources.RepairRunResource: add repair run called with: clusterName = Optional.of(testcluster), keyspace = Optional.absent(), tables = Optional.of(testTable), owner = Optional.of(test), cause = Optional.absent(), segmentCount = Optional.of(6), repairParallelism = Optional.of(SEQUENTIAL), intensity = Optional.absent(), incrementalRepair = Optional.absent()
INFO  [2017-06-26 18:43:52,957] com.spotify.reaper.resources.RepairRunResource: add repair run called with: clusterName = Optional.of(testcluster), keyspace = Optional.of(testKeyspace), tables = Optional.of(testTable), owner = Optional.of(test), cause = Optional.of(), segmentCount = Optional.of(6), repairParallelism = Optional.of(SEQUENTIAL), intensity = Optional.absent(), incrementalRepair = Optional.absent()
DEBUG [2017-06-26 18:43:52,957] com.spotify.reaper.resources.RepairRunResource: no intensity given, so using default value: 0.5
DEBUG [2017-06-26 18:43:52,957] com.spotify.reaper.resources.RepairRunResource: no incremental repair given, so using default value: false
DEBUG [2017-06-26 18:43:52,957] com.spotify.reaper.resources.RepairRunResource: using given segment count 6 instead of configured value 6
INFO  [2017-06-26 18:43:52,958] com.spotify.reaper.resources.CommonTools: use existing repair unit for cluster 'testcluster', keyspace 'testKeyspace', and column families: [testTable]
DEBUG [2017-06-26 18:43:52,958] com.spotify.reaper.resources.RepairRunResource: using given repair parallelism SEQUENTIAL instead of configured value null
INFO  [2017-06-26 18:43:52,958] com.spotify.reaper.service.SegmentGenerator: Dividing token range [0,100) into 1 segments
DEBUG [2017-06-26 18:43:52,958] com.spotify.reaper.service.SegmentGenerator: Segment #1: [0,100)
INFO  [2017-06-26 18:43:52,958] com.spotify.reaper.service.SegmentGenerator: Dividing token range [100,200) into 1 segments
DEBUG [2017-06-26 18:43:52,958] com.spotify.reaper.service.SegmentGenerator: Segment #1: [100,200)
INFO  [2017-06-26 18:43:52,958] com.spotify.reaper.service.SegmentGenerator: Dividing token range [200,0) into 6 segments
DEBUG [2017-06-26 18:43:52,958] com.spotify.reaper.service.SegmentGenerator: Segment #1: [200,28356863910078205288614550619314017788)
DEBUG [2017-06-26 18:43:52,958] com.spotify.reaper.service.SegmentGenerator: Segment #2: [28356863910078205288614550619314017788,56713727820156410577229101238628035376)
DEBUG [2017-06-26 18:43:52,959] com.spotify.reaper.service.SegmentGenerator: Segment #3: [56713727820156410577229101238628035376,85070591730234615865843651857942052964)
DEBUG [2017-06-26 18:43:52,959] com.spotify.reaper.service.SegmentGenerator: Segment #4: [85070591730234615865843651857942052964,113427455640312821154458202477256070552)
DEBUG [2017-06-26 18:43:52,959] com.spotify.reaper.service.SegmentGenerator: Segment #5: [113427455640312821154458202477256070552,141784319550391026443072753096570088140)
DEBUG [2017-06-26 18:43:52,959] com.spotify.reaper.service.SegmentGenerator: Segment #6: [141784319550391026443072753096570088140,0)
DEBUG [2017-06-26 18:43:52,960] com.spotify.reaper.resources.CommonTools: created segment amount differs from expected default 6 != 8
INFO  [2017-06-26 18:43:52,960] com.spotify.reaper.resources.RepairRunResource: add repair run called with: clusterName = Optional.of(testcluster), keyspace = Optional.of(testKeyspace), tables = Optional.of(testTable), owner = Optional.of(test), cause = Optional.of(), segmentCount = Optional.of(6), repairParallelism = Optional.of(SEQUENTIAL), intensity = Optional.absent(), incrementalRepair = Optional.absent()
DEBUG [2017-06-26 18:43:52,960] com.spotify.reaper.resources.RepairRunResource: no intensity given, so using default value: 0.5
DEBUG [2017-06-26 18:43:52,960] com.spotify.reaper.resources.RepairRunResource: no incremental repair given, so using default value: false
DEBUG [2017-06-26 18:43:52,961] com.spotify.reaper.resources.RepairRunResource: using given segment count 6 instead of configured value 6
INFO  [2017-06-26 18:43:52,961] com.spotify.reaper.resources.CommonTools: use existing repair unit for cluster 'testcluster', keyspace 'testKeyspace', and column families: [testTable]
DEBUG [2017-06-26 18:43:52,961] com.spotify.reaper.resources.RepairRunResource: using given repair parallelism SEQUENTIAL instead of configured value null
INFO  [2017-06-26 18:43:52,961] com.spotify.reaper.service.SegmentGenerator: Dividing token range [0,100) into 1 segments
DEBUG [2017-06-26 18:43:52,961] com.spotify.reaper.service.SegmentGenerator: Segment #1: [0,100)
INFO  [2017-06-26 18:43:52,961] com.spotify.reaper.service.SegmentGenerator: Dividing token range [100,200) into 1 segments
DEBUG [2017-06-26 18:43:52,961] com.spotify.reaper.service.SegmentGenerator: Segment #1: [100,200)
INFO  [2017-06-26 18:43:52,962] com.spotify.reaper.service.SegmentGenerator: Dividing token range [200,0) into 6 segments
DEBUG [2017-06-26 18:43:52,962] com.spotify.reaper.service.SegmentGenerator: Segment #1: [200,28356863910078205288614550619314017788)
DEBUG [2017-06-26 18:43:52,962] com.spotify.reaper.service.SegmentGenerator: Segment #2: [28356863910078205288614550619314017788,56713727820156410577229101238628035376)
DEBUG [2017-06-26 18:43:52,962] com.spotify.reaper.service.SegmentGenerator: Segment #3: [56713727820156410577229101238628035376,85070591730234615865843651857942052964)
DEBUG [2017-06-26 18:43:52,962] com.spotify.reaper.service.SegmentGenerator: Segment #4: [85070591730234615865843651857942052964,113427455640312821154458202477256070552)
DEBUG [2017-06-26 18:43:52,962] com.spotify.reaper.service.SegmentGenerator: Segment #5: [113427455640312821154458202477256070552,141784319550391026443072753096570088140)
DEBUG [2017-06-26 18:43:52,962] com.spotify.reaper.service.SegmentGenerator: Segment #6: [141784319550391026443072753096570088140,0)
DEBUG [2017-06-26 18:43:52,963] com.spotify.reaper.resources.CommonTools: created segment amount differs from expected default 6 != 8
INFO  [2017-06-26 18:43:52,977] com.spotify.reaper.resources.RepairRunResource: add repair run called with: clusterName = Optional.of(testcluster), keyspace = Optional.of(testKeyspace), tables = Optional.of(testTable), owner = Optional.of(test), cause = Optional.of(), segmentCount = Optional.of(6), repairParallelism = Optional.of(SEQUENTIAL), intensity = Optional.absent(), incrementalRepair = Optional.absent()
INFO  [2017-06-26 18:43:52,983] com.spotify.reaper.resources.RepairRunResource: modify repair run state called with: id = 42, state = Optional.of(PAUSED)
INFO  [2017-06-26 18:43:52,987] com.spotify.reaper.resources.RepairRunResource: add repair run called with: clusterName = Optional.of(testcluster), keyspace = Optional.of(testKeyspace), tables = Optional.of(testTable), owner = Optional.of(test), cause = Optional.of(), segmentCount = Optional.of(6), repairParallelism = Optional.of(SEQUENTIAL), intensity = Optional.absent(), incrementalRepair = Optional.absent()
DEBUG [2017-06-26 18:43:52,988] com.spotify.reaper.resources.RepairRunResource: no intensity given, so using default value: 0.5
DEBUG [2017-06-26 18:43:52,989] com.spotify.reaper.resources.RepairRunResource: no incremental repair given, so using default value: false
DEBUG [2017-06-26 18:43:52,993] com.spotify.reaper.resources.RepairRunResource: using given segment count 6 instead of configured value 6
INFO  [2017-06-26 18:43:52,994] com.spotify.reaper.resources.CommonTools: use existing repair unit for cluster 'testcluster', keyspace 'testKeyspace', and column families: [testTable]
DEBUG [2017-06-26 18:43:52,995] com.spotify.reaper.resources.RepairRunResource: using given repair parallelism SEQUENTIAL instead of configured value null
INFO  [2017-06-26 18:43:52,995] com.spotify.reaper.service.SegmentGenerator: Dividing token range [0,100) into 1 segments
DEBUG [2017-06-26 18:43:52,995] com.spotify.reaper.service.SegmentGenerator: Segment #1: [0,100)
INFO  [2017-06-26 18:43:52,996] com.spotify.reaper.service.SegmentGenerator: Dividing token range [100,200) into 1 segments
DEBUG [2017-06-26 18:43:52,996] com.spotify.reaper.service.SegmentGenerator: Segment #1: [100,200)
INFO  [2017-06-26 18:43:52,996] com.spotify.reaper.service.SegmentGenerator: Dividing token range [200,0) into 6 segments
DEBUG [2017-06-26 18:43:52,996] com.spotify.reaper.service.SegmentGenerator: Segment #1: [200,28356863910078205288614550619314017788)
DEBUG [2017-06-26 18:43:52,997] com.spotify.reaper.service.SegmentGenerator: Segment #2: [28356863910078205288614550619314017788,56713727820156410577229101238628035376)
DEBUG [2017-06-26 18:43:52,997] com.spotify.reaper.service.SegmentGenerator: Segment #3: [56713727820156410577229101238628035376,85070591730234615865843651857942052964)
DEBUG [2017-06-26 18:43:52,997] com.spotify.reaper.service.SegmentGenerator: Segment #4: [85070591730234615865843651857942052964,113427455640312821154458202477256070552)
DEBUG [2017-06-26 18:43:52,998] com.spotify.reaper.service.SegmentGenerator: Segment #5: [113427455640312821154458202477256070552,141784319550391026443072753096570088140)
DEBUG [2017-06-26 18:43:52,998] com.spotify.reaper.service.SegmentGenerator: Segment #6: [141784319550391026443072753096570088140,0)
DEBUG [2017-06-26 18:43:52,999] com.spotify.reaper.resources.CommonTools: created segment amount differs from expected default 6 != 8
INFO  [2017-06-26 18:43:53,000] com.spotify.reaper.resources.RepairRunResource: modify repair run state called with: id = 1, state = Optional.of(PAUSED)
ERROR [2017-06-26 18:43:53,000] com.spotify.reaper.resources.RepairRunResource: Transition NOT_STARTED->PAUSED not supported.
INFO  [2017-06-26 18:43:53,203] com.spotify.reaper.resources.RepairRunResource: modify repair run state called with: id = 42, state = Optional.of(RUNNING)
INFO  [2017-06-26 18:43:53,205] com.spotify.reaper.resources.RepairRunResource: add repair run called with: clusterName = Optional.of(testcluster), keyspace = Optional.of(testKeyspace), tables = Optional.of(testTable), owner = Optional.of(test), cause = Optional.of(), segmentCount = Optional.of(6), repairParallelism = Optional.of(SEQUENTIAL), intensity = Optional.absent(), incrementalRepair = Optional.absent()
DEBUG [2017-06-26 18:43:53,206] com.spotify.reaper.resources.RepairRunResource: no intensity given, so using default value: 0.5
DEBUG [2017-06-26 18:43:53,206] com.spotify.reaper.resources.RepairRunResource: no incremental repair given, so using default value: false
DEBUG [2017-06-26 18:43:53,206] com.spotify.reaper.resources.RepairRunResource: using given segment count 6 instead of configured value 6
INFO  [2017-06-26 18:43:53,207] com.spotify.reaper.resources.CommonTools: use existing repair unit for cluster 'testcluster', keyspace 'testKeyspace', and column families: [testTable]
DEBUG [2017-06-26 18:43:53,207] com.spotify.reaper.resources.RepairRunResource: using given repair parallelism SEQUENTIAL instead of configured value null
INFO  [2017-06-26 18:43:53,208] com.spotify.reaper.service.SegmentGenerator: Dividing token range [0,100) into 1 segments
DEBUG [2017-06-26 18:43:53,208] com.spotify.reaper.service.SegmentGenerator: Segment #1: [0,100)
INFO  [2017-06-26 18:43:53,209] com.spotify.reaper.service.SegmentGenerator: Dividing token range [100,200) into 1 segments
DEBUG [2017-06-26 18:43:53,209] com.spotify.reaper.service.SegmentGenerator: Segment #1: [100,200)
INFO  [2017-06-26 18:43:53,209] com.spotify.reaper.service.SegmentGenerator: Dividing token range [200,0) into 6 segments
DEBUG [2017-06-26 18:43:53,210] com.spotify.reaper.service.SegmentGenerator: Segment #1: [200,28356863910078205288614550619314017788)
DEBUG [2017-06-26 18:43:53,210] com.spotify.reaper.service.SegmentGenerator: Segment #2: [28356863910078205288614550619314017788,56713727820156410577229101238628035376)
DEBUG [2017-06-26 18:43:53,210] com.spotify.reaper.service.SegmentGenerator: Segment #3: [56713727820156410577229101238628035376,85070591730234615865843651857942052964)
DEBUG [2017-06-26 18:43:53,211] com.spotify.reaper.service.SegmentGenerator: Segment #4: [85070591730234615865843651857942052964,113427455640312821154458202477256070552)
DEBUG [2017-06-26 18:43:53,211] com.spotify.reaper.service.SegmentGenerator: Segment #5: [113427455640312821154458202477256070552,141784319550391026443072753096570088140)
DEBUG [2017-06-26 18:43:53,212] com.spotify.reaper.service.SegmentGenerator: Segment #6: [141784319550391026443072753096570088140,0)
DEBUG [2017-06-26 18:43:53,213] com.spotify.reaper.resources.CommonTools: created segment amount differs from expected default 6 != 8
INFO  [2017-06-26 18:43:53,213] com.spotify.reaper.resources.RepairRunResource: modify repair run state called with: id = 1, state = Optional.of(RUNNING)
INFO  [2017-06-26 18:43:53,213] com.spotify.reaper.resources.RepairRunResource: Starting run 1
INFO  [2017-06-26 18:43:53,213] com.spotify.reaper.service.RepairManager: Starting a run with id #1 with current state 'NOT_STARTED'
INFO  [2017-06-26 18:43:53,213] com.spotify.reaper.service.RepairManager: scheduling repair for repair run #1
DEBUG [2017-06-26 18:43:53,214] com.spotify.reaper.service.RepairRunner: Creating RepairRunner for run with ID 1
DEBUG [2017-06-26 18:43:53,220] com.spotify.reaper.service.RepairRunner: run() called for repair run #1 with run state RUNNING
DEBUG [2017-06-26 18:43:53,221] com.spotify.reaper.service.RepairRunner: connecting JMX proxy for repair runner on run id: 1
DEBUG [2017-06-26 18:43:53,221] com.spotify.reaper.service.RepairRunner: successfully reestablished JMX proxy for repair runner
INFO  [2017-06-26 18:43:53,221] com.spotify.reaper.service.RepairRunner: Next segment to run : 1
DEBUG [2017-06-26 18:43:53,221] com.spotify.reaper.service.RepairRunner: Did set segment id `1` to slot 0
DEBUG [2017-06-26 18:43:53,221] com.spotify.reaper.service.RepairRunner: preparing to repair segment 1 on run with id 1
INFO  [2017-06-26 18:43:53,222] com.spotify.reaper.service.RepairRunner: Next segment to run : 5
DEBUG [2017-06-26 18:43:53,222] com.spotify.reaper.service.RepairRunner: Did set segment id `5` to slot 1
DEBUG [2017-06-26 18:43:53,222] com.spotify.reaper.service.RepairRunner: preparing to repair segment 5 on run with id 1
DEBUG [2017-06-26 18:43:53,222] com.spotify.reaper.service.RepairRunner: run() exiting for repair run #1
DEBUG [2017-06-26 18:43:53,222] com.spotify.reaper.service.SegmentRunner: Run repair for segment #1
DEBUG [2017-06-26 18:43:53,225] com.spotify.reaper.service.SegmentRunner: checking host '' for pending compactions and other repairs (can repair?) Run id '1'
INFO  [2017-06-26 18:43:53,225] com.spotify.reaper.service.SegmentRunner: It is ok to repair segment '1' on repair run with id '1'
DEBUG [2017-06-26 18:43:53,225] com.spotify.reaper.service.SegmentRunner: Enter synchronized section with segment ID 1
DEBUG [2017-06-26 18:43:53,225] com.spotify.reaper.service.SegmentRunner: Triggered repair with command id 1
INFO  [2017-06-26 18:43:53,226] com.spotify.reaper.service.SegmentRunner: Repair for segment 1 started, status wait will timeout in 60000 millis
INFO  [2017-06-26 18:43:54,220] com.spotify.reaper.resources.RepairRunResource: modify repair run state called with: id = 1, state = Optional.of(RUNNING)
INFO  [2017-06-26 18:43:54,220] com.spotify.reaper.resources.RepairRunResource: add repair run called with: clusterName = Optional.of(testcluster), keyspace = Optional.of(testKeyspace), tables = Optional.of(testTable), owner = Optional.of(test), cause = Optional.of(), segmentCount = Optional.of(6), repairParallelism = Optional.of(SEQUENTIAL), intensity = Optional.absent(), incrementalRepair = Optional.absent()
DEBUG [2017-06-26 18:43:54,221] com.spotify.reaper.resources.RepairRunResource: no intensity given, so using default value: 0.5
DEBUG [2017-06-26 18:43:54,221] com.spotify.reaper.resources.RepairRunResource: no incremental repair given, so using default value: false
DEBUG [2017-06-26 18:43:54,222] com.spotify.reaper.resources.RepairRunResource: using given segment count 6 instead of configured value 6
INFO  [2017-06-26 18:43:54,223] com.spotify.reaper.resources.CommonTools: use existing repair unit for cluster 'testcluster', keyspace 'testKeyspace', and column families: [testTable]
DEBUG [2017-06-26 18:43:54,223] com.spotify.reaper.resources.RepairRunResource: using given repair parallelism SEQUENTIAL instead of configured value null
INFO  [2017-06-26 18:43:54,224] com.spotify.reaper.service.SegmentGenerator: Dividing token range [0,100) into 1 segments
DEBUG [2017-06-26 18:43:54,225] com.spotify.reaper.service.SegmentGenerator: Segment #1: [0,100)
INFO  [2017-06-26 18:43:54,225] com.spotify.reaper.service.SegmentGenerator: Dividing token range [100,200) into 1 segments
DEBUG [2017-06-26 18:43:54,225] com.spotify.reaper.service.SegmentGenerator: Segment #1: [100,200)
INFO  [2017-06-26 18:43:54,226] com.spotify.reaper.service.SegmentGenerator: Dividing token range [200,0) into 6 segments
DEBUG [2017-06-26 18:43:54,226] com.spotify.reaper.service.SegmentGenerator: Segment #1: [200,28356863910078205288614550619314017788)
DEBUG [2017-06-26 18:43:54,227] com.spotify.reaper.service.SegmentGenerator: Segment #2: [28356863910078205288614550619314017788,56713727820156410577229101238628035376)
DEBUG [2017-06-26 18:43:54,227] com.spotify.reaper.service.SegmentGenerator: Segment #3: [56713727820156410577229101238628035376,85070591730234615865843651857942052964)
DEBUG [2017-06-26 18:43:54,228] com.spotify.reaper.service.SegmentGenerator: Segment #4: [85070591730234615865843651857942052964,113427455640312821154458202477256070552)
DEBUG [2017-06-26 18:43:54,228] com.spotify.reaper.service.SegmentGenerator: Segment #5: [113427455640312821154458202477256070552,141784319550391026443072753096570088140)
DEBUG [2017-06-26 18:43:54,229] com.spotify.reaper.service.SegmentGenerator: Segment #6: [141784319550391026443072753096570088140,0)
DEBUG [2017-06-26 18:43:54,230] com.spotify.reaper.resources.CommonTools: created segment amount differs from expected default 6 != 8
INFO  [2017-06-26 18:43:54,231] com.spotify.reaper.resources.RepairRunResource: modify repair run state called with: id = 2, state = Optional.of(RUNNING)
ERROR [2017-06-26 18:43:54,232] com.spotify.reaper.resources.RepairRunResource: repair unit already has run 1 in RUNNING state
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.482 sec - in com.spotify.reaper.unit.resources.RepairRunResourceTest
Running com.spotify.reaper.unit.resources.ClusterResourceTest
DEBUG [2017-06-26 18:43:54,235] com.spotify.reaper.resources.ClusterResource: get cluster called with cluster_name: i_dont_exist
DEBUG [2017-06-26 18:43:54,241] com.spotify.reaper.resources.ClusterResource: add cluster called with seedHost: TestHost
DEBUG [2017-06-26 18:43:54,241] com.spotify.reaper.resources.ClusterResource: Seeds [TestHost]
INFO  [2017-06-26 18:43:54,248] com.spotify.reaper.resources.ClusterResource: creating new cluster based on given seed host: testcluster
INFO  [2017-06-26 18:43:54,252] com.spotify.reaper.resources.ClusterResource: modify cluster called with: cluster_name = testcluster, seedHost = TestHost1
INFO  [2017-06-26 18:43:54,253] com.spotify.reaper.resources.ClusterResource: modify cluster called with: cluster_name = testcluster, seedHost = TestHost1
DEBUG [2017-06-26 18:43:54,257] com.spotify.reaper.resources.ClusterResource: add cluster called with seedHost: TestHost
DEBUG [2017-06-26 18:43:54,258] com.spotify.reaper.resources.ClusterResource: Seeds [TestHost]
INFO  [2017-06-26 18:43:54,259] com.spotify.reaper.resources.ClusterResource: creating new cluster based on given seed host: testcluster
INFO  [2017-06-26 18:43:54,286] com.spotify.reaper.resources.CommonTools: create new repair unit for cluster 'testcluster', keyspace 'keyspace1', and column families: []
INFO  [2017-06-26 18:43:54,289] com.spotify.reaper.service.ClusterRepairScheduler: Scheduled repair created: com.spotify.reaper.core.RepairSchedule@78ab63b5
DEBUG [2017-06-26 18:43:54,296] com.spotify.reaper.resources.ClusterResource: add cluster called with seedHost: TestHost
DEBUG [2017-06-26 18:43:54,297] com.spotify.reaper.resources.ClusterResource: Seeds [TestHost]
INFO  [2017-06-26 18:43:54,297] com.spotify.reaper.resources.ClusterResource: cluster already stored with this name: Optional.of(com.spotify.reaper.core.Cluster@2b9370cc)
DEBUG [2017-06-26 18:43:54,308] com.spotify.reaper.resources.ClusterResource: get cluster called with cluster_name: i_do_exist
DEBUG [2017-06-26 18:43:54,310] com.spotify.reaper.resources.ClusterResource: add cluster called with seedHost: TestHost
DEBUG [2017-06-26 18:43:54,310] com.spotify.reaper.resources.ClusterResource: Seeds [TestHost]
INFO  [2017-06-26 18:43:54,311] com.spotify.reaper.resources.ClusterResource: creating new cluster based on given seed host: testcluster
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.071 sec - in com.spotify.reaper.unit.resources.ClusterResourceTest
Running com.spotify.reaper.unit.cassandra.JmxProxyTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.009 sec - in com.spotify.reaper.unit.cassandra.JmxProxyTest
Running com.spotify.reaper.unit.service.RepairRunnerTest
INFO  [2017-06-26 18:43:54,317] com.spotify.reaper.service.SegmentRunner: Postponing segment 1
INFO  [2017-06-26 18:43:54,317] com.spotify.reaper.service.SegmentRunner: Aborting repair on segment with id 1 on coordinator reaper
INFO  [2017-06-26 18:43:54,317] com.spotify.reaper.service.RepairManager: Starting a run with id #1 with current state 'RUNNING'
INFO  [2017-06-26 18:43:54,317] com.spotify.reaper.service.RepairManager: re-trigger a running run after restart, with id 1
INFO  [2017-06-26 18:43:54,317] com.spotify.reaper.service.RepairManager: scheduling repair for repair run #1
DEBUG [2017-06-26 18:43:54,318] com.spotify.reaper.service.RepairRunner: Creating RepairRunner for run with ID 1
DEBUG [2017-06-26 18:43:54,322] com.spotify.reaper.service.RepairRunner: run() called for repair run #1 with run state RUNNING
DEBUG [2017-06-26 18:43:54,322] com.spotify.reaper.service.RepairRunner: connecting JMX proxy for repair runner on run id: 1
DEBUG [2017-06-26 18:43:54,323] com.spotify.reaper.service.RepairRunner: successfully reestablished JMX proxy for repair runner
INFO  [2017-06-26 18:43:54,323] com.spotify.reaper.service.RepairRunner: Next segment to run : 1
DEBUG [2017-06-26 18:43:54,323] com.spotify.reaper.service.RepairRunner: Did set segment id `1` to slot 0
DEBUG [2017-06-26 18:43:54,323] com.spotify.reaper.service.RepairRunner: preparing to repair segment 1 on run with id 1
INFO  [2017-06-26 18:43:54,323] com.spotify.reaper.service.RepairRunner: Next segment to run : 2
DEBUG [2017-06-26 18:43:54,323] com.spotify.reaper.service.RepairRunner: Did set segment id `2` to slot 1
DEBUG [2017-06-26 18:43:54,323] com.spotify.reaper.service.RepairRunner: preparing to repair segment 2 on run with id 1
DEBUG [2017-06-26 18:43:54,323] com.spotify.reaper.service.RepairRunner: run() exiting for repair run #1
DEBUG [2017-06-26 18:43:54,324] com.spotify.reaper.service.SegmentRunner: Run repair for segment #1
DEBUG [2017-06-26 18:43:54,325] com.spotify.reaper.service.SegmentRunner: checking host '' for pending compactions and other repairs (can repair?) Run id '1'
INFO  [2017-06-26 18:43:54,332] com.spotify.reaper.service.SegmentRunner: It is ok to repair segment '1' on repair run with id '1'
DEBUG [2017-06-26 18:43:54,333] com.spotify.reaper.service.SegmentRunner: Enter synchronized section with segment ID 1
DEBUG [2017-06-26 18:43:54,340] com.spotify.reaper.service.SegmentRunner: Triggered repair with command id 1
INFO  [2017-06-26 18:43:54,353] com.spotify.reaper.service.SegmentRunner: Repair for segment 1 started, status wait will timeout in 500 millis
DEBUG [2017-06-26 18:43:54,369] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 1, outcome Optional.of(STARTED) / Optional.absent() and message: null
DEBUG [2017-06-26 18:43:54,371] com.spotify.reaper.service.SegmentRunner: updated segment 1 with state RUNNING
DEBUG [2017-06-26 18:43:54,371] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 1, outcome Optional.of(SESSION_SUCCESS) / Optional.absent() and message: null
DEBUG [2017-06-26 18:43:54,371] com.spotify.reaper.service.SegmentRunner: repair session succeeded for segment with id '1' and repair number '1'
DEBUG [2017-06-26 18:43:54,371] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 1, outcome Optional.of(FINISHED) / Optional.absent() and message: null
DEBUG [2017-06-26 18:43:54,372] com.spotify.reaper.service.SegmentRunner: repair session finished for segment with id '1' and repair number '1'
INFO  [2017-06-26 18:43:54,372] com.spotify.reaper.service.SegmentRunner: Repair command 1 on segment 1 returned with state DONE
DEBUG [2017-06-26 18:43:54,386] com.spotify.reaper.service.SegmentRunner: Repair segment with id '1' was repaired in 0 seconds
DEBUG [2017-06-26 18:43:54,386] com.spotify.reaper.service.SegmentRunner: Exiting synchronized section with segment ID 1
DEBUG [2017-06-26 18:43:54,387] com.spotify.reaper.service.SegmentRunner: Scheduling next runner run() with delay 0 ms
DEBUG [2017-06-26 18:43:54,391] com.spotify.reaper.service.RepairRunner: In repair run #1, triggerRepair on segment 1 ended with state DONE
DEBUG [2017-06-26 18:43:54,391] com.spotify.reaper.service.SegmentRunner: Run repair for segment #2
DEBUG [2017-06-26 18:43:54,392] com.spotify.reaper.service.SegmentRunner: checking host '' for pending compactions and other repairs (can repair?) Run id '1'
INFO  [2017-06-26 18:43:54,392] com.spotify.reaper.service.SegmentRunner: It is ok to repair segment '2' on repair run with id '1'
DEBUG [2017-06-26 18:43:54,392] com.spotify.reaper.service.SegmentRunner: Enter synchronized section with segment ID 2
DEBUG [2017-06-26 18:43:54,400] com.spotify.reaper.service.SegmentRunner: Triggered repair with command id 1
INFO  [2017-06-26 18:43:54,401] com.spotify.reaper.service.SegmentRunner: Repair for segment 2 started, status wait will timeout in 500 millis
DEBUG [2017-06-26 18:43:54,402] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 1, outcome Optional.of(STARTED) / Optional.absent() and message: null
DEBUG [2017-06-26 18:43:54,402] com.spotify.reaper.service.SegmentRunner: updated segment 2 with state RUNNING
DEBUG [2017-06-26 18:43:54,402] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 1, outcome Optional.of(SESSION_SUCCESS) / Optional.absent() and message: null
DEBUG [2017-06-26 18:43:54,402] com.spotify.reaper.service.SegmentRunner: repair session succeeded for segment with id '2' and repair number '1'
DEBUG [2017-06-26 18:43:54,403] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 1, outcome Optional.of(FINISHED) / Optional.absent() and message: null
DEBUG [2017-06-26 18:43:54,403] com.spotify.reaper.service.SegmentRunner: repair session finished for segment with id '2' and repair number '1'
INFO  [2017-06-26 18:43:54,403] com.spotify.reaper.service.SegmentRunner: Repair command 1 on segment 2 returned with state DONE
DEBUG [2017-06-26 18:43:54,403] com.spotify.reaper.service.SegmentRunner: Repair segment with id '2' was repaired in 0 seconds
DEBUG [2017-06-26 18:43:54,404] com.spotify.reaper.service.SegmentRunner: Exiting synchronized section with segment ID 2
DEBUG [2017-06-26 18:43:54,404] com.spotify.reaper.service.SegmentRunner: Scheduling next runner run() with delay 0 ms
DEBUG [2017-06-26 18:43:54,408] com.spotify.reaper.service.RepairRunner: In repair run #1, triggerRepair on segment 2 ended with state DONE
DEBUG [2017-06-26 18:43:54,409] com.spotify.reaper.service.RepairRunner: run() called for repair run #1 with run state RUNNING
DEBUG [2017-06-26 18:43:54,409] com.spotify.reaper.service.RepairRunner: No repair segment available for range (0,1]
DEBUG [2017-06-26 18:43:54,409] com.spotify.reaper.service.RepairRunner: No repair segment available for range (1,0]
INFO  [2017-06-26 18:43:54,410] com.spotify.reaper.service.RepairRunner: Repair amount done 2
INFO  [2017-06-26 18:43:54,410] com.spotify.reaper.service.RepairRunner: Repairs for repair run #1 done
DEBUG [2017-06-26 18:43:54,410] com.spotify.reaper.service.RepairRunner: run() exiting for repair run #1
INFO  [2017-06-26 18:43:55,323] com.spotify.reaper.service.RepairManager: Starting a run with id #1 with current state 'NOT_STARTED'
INFO  [2017-06-26 18:43:55,323] com.spotify.reaper.service.RepairManager: scheduling repair for repair run #1
DEBUG [2017-06-26 18:43:55,323] com.spotify.reaper.service.RepairRunner: Creating RepairRunner for run with ID 1
DEBUG [2017-06-26 18:43:55,327] com.spotify.reaper.service.RepairRunner: run() called for repair run #1 with run state RUNNING
DEBUG [2017-06-26 18:43:55,327] com.spotify.reaper.service.RepairRunner: connecting JMX proxy for repair runner on run id: 1
DEBUG [2017-06-26 18:43:55,328] com.spotify.reaper.service.RepairRunner: successfully reestablished JMX proxy for repair runner
INFO  [2017-06-26 18:43:55,328] com.spotify.reaper.service.RepairRunner: Next segment to run : 1
DEBUG [2017-06-26 18:43:55,328] com.spotify.reaper.service.RepairRunner: Did set segment id `1` to slot 0
DEBUG [2017-06-26 18:43:55,328] com.spotify.reaper.service.RepairRunner: preparing to repair segment 1 on run with id 1
INFO  [2017-06-26 18:43:55,329] com.spotify.reaper.service.RepairRunner: Next segment to run : 1
DEBUG [2017-06-26 18:43:55,329] com.spotify.reaper.service.RepairRunner: Did set segment id `1` to slot 1
DEBUG [2017-06-26 18:43:55,329] com.spotify.reaper.service.RepairRunner: preparing to repair segment 1 on run with id 1
DEBUG [2017-06-26 18:43:55,329] com.spotify.reaper.service.RepairRunner: run() exiting for repair run #1
DEBUG [2017-06-26 18:43:55,329] com.spotify.reaper.service.SegmentRunner: Run repair for segment #1
DEBUG [2017-06-26 18:43:55,330] com.spotify.reaper.service.SegmentRunner: checking host '' for pending compactions and other repairs (can repair?) Run id '1'
INFO  [2017-06-26 18:43:55,331] com.spotify.reaper.service.SegmentRunner: It is ok to repair segment '1' on repair run with id '1'
DEBUG [2017-06-26 18:43:55,331] com.spotify.reaper.service.SegmentRunner: Enter synchronized section with segment ID 1
repair number : 1
DEBUG [2017-06-26 18:43:55,332] com.spotify.reaper.service.SegmentRunner: Triggered repair with command id 1
DEBUG [2017-06-26 18:43:55,333] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 1, outcome Optional.of(STARTED) / Optional.absent() and message: null
INFO  [2017-06-26 18:43:55,333] com.spotify.reaper.service.SegmentRunner: Repair for segment 1 started, status wait will timeout in 500 millis
DEBUG [2017-06-26 18:43:55,334] com.spotify.reaper.service.SegmentRunner: updated segment 1 with state RUNNING
INFO  [2017-06-26 18:43:55,834] com.spotify.reaper.service.SegmentRunner: Repair command 1 on segment 1 returned with state RUNNING
INFO  [2017-06-26 18:43:55,834] com.spotify.reaper.service.SegmentRunner: Repair command 1 on segment 1 has been cancelled while running
INFO  [2017-06-26 18:43:55,834] com.spotify.reaper.service.SegmentRunner: Postponing segment 1
INFO  [2017-06-26 18:43:55,834] com.spotify.reaper.service.SegmentRunner: Aborting repair on segment with id 1 on coordinator null
DEBUG [2017-06-26 18:43:55,835] com.spotify.reaper.service.SegmentRunner: Exiting synchronized section with segment ID 1
DEBUG [2017-06-26 18:43:55,835] com.spotify.reaper.service.RepairRunner: In repair run #1, triggerRepair on segment 1 ended with state NOT_STARTED
DEBUG [2017-06-26 18:43:55,835] com.spotify.reaper.service.SegmentRunner: Run repair for segment #1
DEBUG [2017-06-26 18:43:55,836] com.spotify.reaper.service.SegmentRunner: checking host '' for pending compactions and other repairs (can repair?) Run id '1'
INFO  [2017-06-26 18:43:55,837] com.spotify.reaper.service.SegmentRunner: It is ok to repair segment '1' on repair run with id '1'
DEBUG [2017-06-26 18:43:55,837] com.spotify.reaper.service.SegmentRunner: Enter synchronized section with segment ID 1
repair number : 2
DEBUG [2017-06-26 18:43:55,841] com.spotify.reaper.service.SegmentRunner: Triggered repair with command id 2
DEBUG [2017-06-26 18:43:55,842] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 2, outcome Optional.of(STARTED) / Optional.absent() and message: null
INFO  [2017-06-26 18:43:55,852] com.spotify.reaper.service.SegmentRunner: Repair for segment 1 started, status wait will timeout in 500 millis
DEBUG [2017-06-26 18:43:55,853] com.spotify.reaper.service.SegmentRunner: updated segment 1 with state RUNNING
DEBUG [2017-06-26 18:43:55,853] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 2, outcome Optional.of(SESSION_SUCCESS) / Optional.absent() and message: null
DEBUG [2017-06-26 18:43:55,853] com.spotify.reaper.service.SegmentRunner: repair session succeeded for segment with id '1' and repair number '2'
DEBUG [2017-06-26 18:43:55,853] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 2, outcome Optional.of(FINISHED) / Optional.absent() and message: null
DEBUG [2017-06-26 18:43:55,853] com.spotify.reaper.service.SegmentRunner: repair session finished for segment with id '1' and repair number '2'
MUTEX ACQUIRED
MUTEX RELEASED
INFO  [2017-06-26 18:43:55,854] com.spotify.reaper.service.SegmentRunner: Repair command 2 on segment 1 returned with state DONE
DEBUG [2017-06-26 18:43:55,854] com.spotify.reaper.service.SegmentRunner: Repair segment with id '1' was repaired in 0 seconds
DEBUG [2017-06-26 18:43:55,854] com.spotify.reaper.service.SegmentRunner: Exiting synchronized section with segment ID 1
DEBUG [2017-06-26 18:43:55,854] com.spotify.reaper.service.SegmentRunner: Scheduling next runner run() with delay 0 ms
DEBUG [2017-06-26 18:43:55,855] com.spotify.reaper.service.RepairRunner: In repair run #1, triggerRepair on segment 1 ended with state DONE
DEBUG [2017-06-26 18:43:55,856] com.spotify.reaper.service.RepairRunner: run() called for repair run #1 with run state RUNNING
DEBUG [2017-06-26 18:43:55,856] com.spotify.reaper.service.RepairRunner: No repair segment available for range (0,0]
DEBUG [2017-06-26 18:43:55,856] com.spotify.reaper.service.RepairRunner: No repair segment available for range (0,0]
INFO  [2017-06-26 18:43:55,856] com.spotify.reaper.service.RepairRunner: Repair amount done 1
INFO  [2017-06-26 18:43:55,856] com.spotify.reaper.service.RepairRunner: Repairs for repair run #1 done
DEBUG [2017-06-26 18:43:55,857] com.spotify.reaper.service.RepairRunner: run() exiting for repair run #1
INFO  [2017-06-26 18:43:56,854] com.spotify.reaper.service.RepairManager: Starting a run with id #1 with current state 'NOT_STARTED'
INFO  [2017-06-26 18:43:56,854] com.spotify.reaper.service.RepairManager: scheduling repair for repair run #1
DEBUG [2017-06-26 18:43:56,854] com.spotify.reaper.service.RepairRunner: Creating RepairRunner for run with ID 1
DEBUG [2017-06-26 18:43:56,860] com.spotify.reaper.service.RepairRunner: run() called for repair run #1 with run state RUNNING
DEBUG [2017-06-26 18:43:56,860] com.spotify.reaper.service.RepairRunner: connecting JMX proxy for repair runner on run id: 1
DEBUG [2017-06-26 18:43:56,862] com.spotify.reaper.service.RepairRunner: successfully reestablished JMX proxy for repair runner
INFO  [2017-06-26 18:43:56,862] com.spotify.reaper.service.RepairRunner: Next segment to run : 1
DEBUG [2017-06-26 18:43:56,862] com.spotify.reaper.service.RepairRunner: Did set segment id `1` to slot 0
DEBUG [2017-06-26 18:43:56,862] com.spotify.reaper.service.RepairRunner: preparing to repair segment 1 on run with id 1
INFO  [2017-06-26 18:43:56,862] com.spotify.reaper.service.RepairRunner: Next segment to run : 1
DEBUG [2017-06-26 18:43:56,862] com.spotify.reaper.service.RepairRunner: Did set segment id `1` to slot 1
DEBUG [2017-06-26 18:43:56,862] com.spotify.reaper.service.RepairRunner: preparing to repair segment 1 on run with id 1
DEBUG [2017-06-26 18:43:56,862] com.spotify.reaper.service.RepairRunner: run() exiting for repair run #1
DEBUG [2017-06-26 18:43:56,862] com.spotify.reaper.service.SegmentRunner: Run repair for segment #1
DEBUG [2017-06-26 18:43:56,863] com.spotify.reaper.service.SegmentRunner: checking host '' for pending compactions and other repairs (can repair?) Run id '1'
INFO  [2017-06-26 18:43:56,864] com.spotify.reaper.service.SegmentRunner: It is ok to repair segment '1' on repair run with id '1'
DEBUG [2017-06-26 18:43:56,864] com.spotify.reaper.service.SegmentRunner: Enter synchronized section with segment ID 1
DEBUG [2017-06-26 18:43:56,868] com.spotify.reaper.service.SegmentRunner: Triggered repair with command id 1
INFO  [2017-06-26 18:43:56,876] com.spotify.reaper.service.SegmentRunner: Repair for segment 1 started, status wait will timeout in 500 millis
DEBUG [2017-06-26 18:43:56,877] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 1, outcome Optional.absent() / Optional.of(START) and message: null
DEBUG [2017-06-26 18:43:56,878] com.spotify.reaper.service.SegmentRunner: updated segment 1 with state RUNNING
INFO  [2017-06-26 18:43:57,377] com.spotify.reaper.service.SegmentRunner: Repair command 1 on segment 1 returned with state RUNNING
INFO  [2017-06-26 18:43:57,378] com.spotify.reaper.service.SegmentRunner: Repair command 1 on segment 1 has been cancelled while running
INFO  [2017-06-26 18:43:57,378] com.spotify.reaper.service.SegmentRunner: Postponing segment 1
INFO  [2017-06-26 18:43:57,379] com.spotify.reaper.service.SegmentRunner: Aborting repair on segment with id 1 on coordinator null
DEBUG [2017-06-26 18:43:57,379] com.spotify.reaper.service.SegmentRunner: Exiting synchronized section with segment ID 1
DEBUG [2017-06-26 18:43:57,380] com.spotify.reaper.service.RepairRunner: In repair run #1, triggerRepair on segment 1 ended with state NOT_STARTED
DEBUG [2017-06-26 18:43:57,381] com.spotify.reaper.service.SegmentRunner: Run repair for segment #1
DEBUG [2017-06-26 18:43:57,382] com.spotify.reaper.service.SegmentRunner: checking host '' for pending compactions and other repairs (can repair?) Run id '1'
INFO  [2017-06-26 18:43:57,383] com.spotify.reaper.service.SegmentRunner: It is ok to repair segment '1' on repair run with id '1'
DEBUG [2017-06-26 18:43:57,383] com.spotify.reaper.service.SegmentRunner: Enter synchronized section with segment ID 1
DEBUG [2017-06-26 18:43:57,387] com.spotify.reaper.service.SegmentRunner: Triggered repair with command id 2
DEBUG [2017-06-26 18:43:57,388] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 2, outcome Optional.absent() / Optional.of(START) and message: null
INFO  [2017-06-26 18:43:57,389] com.spotify.reaper.service.SegmentRunner: Repair for segment 1 started, status wait will timeout in 500 millis
MUTEX RELEASED
MUTEX ACQUIRED
DEBUG [2017-06-26 18:43:57,389] com.spotify.reaper.service.SegmentRunner: updated segment 1 with state RUNNING
DEBUG [2017-06-26 18:43:57,390] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 2, outcome Optional.absent() / Optional.of(SUCCESS) and message: null
DEBUG [2017-06-26 18:43:57,390] com.spotify.reaper.service.SegmentRunner: repair session succeeded for segment with id '1' and repair number '2'
DEBUG [2017-06-26 18:43:57,390] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 2, outcome Optional.absent() / Optional.of(COMPLETE) and message: null
DEBUG [2017-06-26 18:43:57,390] com.spotify.reaper.service.SegmentRunner: repair session finished for segment with id '1' and repair number '2'
INFO  [2017-06-26 18:43:57,397] com.spotify.reaper.service.SegmentRunner: Repair command 2 on segment 1 returned with state DONE
DEBUG [2017-06-26 18:43:57,397] com.spotify.reaper.service.SegmentRunner: Repair segment with id '1' was repaired in 0 seconds
DEBUG [2017-06-26 18:43:57,397] com.spotify.reaper.service.SegmentRunner: Exiting synchronized section with segment ID 1
DEBUG [2017-06-26 18:43:57,397] com.spotify.reaper.service.SegmentRunner: Scheduling next runner run() with delay 0 ms
DEBUG [2017-06-26 18:43:57,398] com.spotify.reaper.service.RepairRunner: In repair run #1, triggerRepair on segment 1 ended with state DONE
DEBUG [2017-06-26 18:43:57,399] com.spotify.reaper.service.RepairRunner: run() called for repair run #1 with run state RUNNING
DEBUG [2017-06-26 18:43:57,399] com.spotify.reaper.service.RepairRunner: No repair segment available for range (0,0]
DEBUG [2017-06-26 18:43:57,399] com.spotify.reaper.service.RepairRunner: No repair segment available for range (0,0]
INFO  [2017-06-26 18:43:57,399] com.spotify.reaper.service.RepairRunner: Repair amount done 1
INFO  [2017-06-26 18:43:57,399] com.spotify.reaper.service.RepairRunner: Repairs for repair run #1 done
DEBUG [2017-06-26 18:43:57,399] com.spotify.reaper.service.RepairRunner: run() exiting for repair run #1
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 3.17 sec - in com.spotify.reaper.unit.service.RepairRunnerTest
Running com.spotify.reaper.unit.service.AutoSchedulingManagerTest
INFO  [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Dividing token range [0,50) into 6 segments
DEBUG [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Segment #1: [0,8)
DEBUG [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Segment #2: [8,16)
DEBUG [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Segment #3: [16,25)
DEBUG [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Segment #4: [25,33)
DEBUG [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Segment #5: [33,41)
DEBUG [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Segment #6: [41,50)
INFO  [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Dividing token range [50,100) into 6 segments
DEBUG [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Segment #1: [50,58)
DEBUG [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Segment #2: [58,66)
DEBUG [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Segment #3: [66,75)
DEBUG [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Segment #4: [75,83)
DEBUG [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Segment #5: [83,91)
DEBUG [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Segment #6: [91,100)
INFO  [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Dividing token range [100,150) into 6 segments
DEBUG [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Segment #1: [100,108)
DEBUG [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Segment #2: [108,116)
DEBUG [2017-06-26 18:43:57,492] com.spotify.reaper.service.SegmentGenerator: Segment #3: [116,125)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #4: [125,133)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #5: [133,141)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #6: [141,150)
INFO  [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Dividing token range [150,200) into 6 segments
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #1: [150,158)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #2: [158,166)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #3: [166,175)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #4: [175,183)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #5: [183,191)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #6: [191,200)
INFO  [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Dividing token range [200,250) into 6 segments
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #1: [200,208)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #2: [208,216)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #3: [216,225)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #4: [225,233)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #5: [233,241)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #6: [241,250)
INFO  [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Dividing token range [250,0) into 6 segments
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #1: [250,258)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #2: [258,266)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #3: [266,275)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #4: [275,283)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #5: [283,291)
DEBUG [2017-06-26 18:43:57,493] com.spotify.reaper.service.SegmentGenerator: Segment #6: [291,0)
DEBUG [2017-06-26 18:43:57,510] com.spotify.reaper.service.AutoSchedulingManager: Checking cluster keyspaces to identify which ones require repair schedules...
ERROR [2017-06-26 18:43:57,511] com.spotify.reaper.service.AutoSchedulingManager: Error while scheduling repairs for cluster com.spotify.reaper.core.Cluster@65f96d58
! java.lang.RuntimeException: throw for test purposes
! at com.spotify.reaper.service.AutoSchedulingManager.run(AutoSchedulingManager.java:53)
! at com.spotify.reaper.unit.service.AutoSchedulingManagerTest.continueProcessingOtherClusterWhenSchedulingFailsForACluster(AutoSchedulingManagerTest.java:51)
! at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
! at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
! at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
! at java.lang.reflect.Method.invoke(Method.java:498)
! at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
! at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
! at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
! at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
! at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
! at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
! at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
! at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
! at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
! at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
! at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
! at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
! at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
! at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
! at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:344)
! at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:269)
! at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:240)
! at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:184)
! at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:286)
! at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:240)
! at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:121)
DEBUG [2017-06-26 18:43:57,543] com.spotify.reaper.service.AutoSchedulingManager: Checking cluster keyspaces to identify which ones require repair schedules...
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.053 sec - in com.spotify.reaper.unit.service.AutoSchedulingManagerTest
Running com.spotify.reaper.unit.service.RingRangeTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in com.spotify.reaper.unit.service.RingRangeTest
Running com.spotify.reaper.unit.service.SegmentRunnerTest
DEBUG [2017-06-26 18:43:57,584] com.spotify.reaper.service.SegmentRunner: Run repair for segment #1
DEBUG [2017-06-26 18:43:57,590] com.spotify.reaper.service.SegmentRunner: checking host '' for pending compactions and other repairs (can repair?) Run id '1'
INFO  [2017-06-26 18:43:57,594] com.spotify.reaper.service.SegmentRunner: It is ok to repair segment '1' on repair run with id '1'
DEBUG [2017-06-26 18:43:57,594] com.spotify.reaper.service.SegmentRunner: Enter synchronized section with segment ID 1
DEBUG [2017-06-26 18:43:57,597] com.spotify.reaper.service.SegmentRunner: Triggered repair with command id 1
INFO  [2017-06-26 18:43:57,598] com.spotify.reaper.service.SegmentRunner: Repair for segment 1 started, status wait will timeout in 100 millis
DEBUG [2017-06-26 18:43:57,604] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 1, outcome Optional.of(STARTED) / Optional.absent() and message: Repair command 1 has started
DEBUG [2017-06-26 18:43:57,616] com.spotify.reaper.service.SegmentRunner: updated segment 1 with state RUNNING
INFO  [2017-06-26 18:43:57,698] com.spotify.reaper.service.SegmentRunner: Repair command 1 on segment 1 returned with state RUNNING
INFO  [2017-06-26 18:43:57,698] com.spotify.reaper.service.SegmentRunner: Repair command 1 on segment 1 has been cancelled while running
INFO  [2017-06-26 18:43:57,698] com.spotify.reaper.service.SegmentRunner: Postponing segment 1
INFO  [2017-06-26 18:43:57,698] com.spotify.reaper.service.SegmentRunner: Aborting repair on segment with id 1 on coordinator null
DEBUG [2017-06-26 18:43:57,699] com.spotify.reaper.service.SegmentRunner: Exiting synchronized section with segment ID 1
DEBUG [2017-06-26 18:43:57,701] com.spotify.reaper.service.SegmentRunner: Run repair for segment #1
DEBUG [2017-06-26 18:43:57,704] com.spotify.reaper.service.SegmentRunner: checking host '' for pending compactions and other repairs (can repair?) Run id '1'
INFO  [2017-06-26 18:43:57,705] com.spotify.reaper.service.SegmentRunner: It is ok to repair segment '1' on repair run with id '1'
DEBUG [2017-06-26 18:43:57,705] com.spotify.reaper.service.SegmentRunner: Enter synchronized section with segment ID 1
DEBUG [2017-06-26 18:43:57,716] com.spotify.reaper.service.SegmentRunner: Triggered repair with command id 1
INFO  [2017-06-26 18:43:57,718] com.spotify.reaper.service.SegmentRunner: Repair for segment 1 started, status wait will timeout in 1000 millis
DEBUG [2017-06-26 18:43:57,736] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 1, outcome Optional.of(STARTED) / Optional.absent() and message: Repair command 1 has started
DEBUG [2017-06-26 18:43:57,740] com.spotify.reaper.service.SegmentRunner: updated segment 1 with state RUNNING
DEBUG [2017-06-26 18:43:57,740] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 2, outcome Optional.of(SESSION_FAILED) / Optional.absent() and message: Repair command 2 has failed
DEBUG [2017-06-26 18:43:57,740] com.spotify.reaper.service.SegmentRunner: Handler for command id 1 not handling message with number 2
DEBUG [2017-06-26 18:43:57,740] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 1, outcome Optional.of(SESSION_SUCCESS) / Optional.absent() and message: Repair session succeeded in command 1
DEBUG [2017-06-26 18:43:57,740] com.spotify.reaper.service.SegmentRunner: repair session succeeded for segment with id '1' and repair number '1'
DEBUG [2017-06-26 18:43:57,741] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 1, outcome Optional.of(FINISHED) / Optional.absent() and message: Repair command 1 has finished
DEBUG [2017-06-26 18:43:57,741] com.spotify.reaper.service.SegmentRunner: repair session finished for segment with id '1' and repair number '1'
INFO  [2017-06-26 18:43:57,741] com.spotify.reaper.service.SegmentRunner: Repair command 1 on segment 1 returned with state DONE
DEBUG [2017-06-26 18:43:57,741] com.spotify.reaper.service.SegmentRunner: Repair segment with id '1' was repaired in 0 seconds
DEBUG [2017-06-26 18:43:57,741] com.spotify.reaper.service.SegmentRunner: Exiting synchronized section with segment ID 1
DEBUG [2017-06-26 18:43:57,741] com.spotify.reaper.service.SegmentRunner: Scheduling next runner run() with delay 0 ms
DEBUG [2017-06-26 18:43:57,744] com.spotify.reaper.service.SegmentRunner: Run repair for segment #1
DEBUG [2017-06-26 18:43:57,745] com.spotify.reaper.service.SegmentRunner: checking host '' for pending compactions and other repairs (can repair?) Run id '1'
INFO  [2017-06-26 18:43:57,746] com.spotify.reaper.service.SegmentRunner: It is ok to repair segment '1' on repair run with id '1'
DEBUG [2017-06-26 18:43:57,746] com.spotify.reaper.service.SegmentRunner: Enter synchronized section with segment ID 1
DEBUG [2017-06-26 18:43:57,752] com.spotify.reaper.service.SegmentRunner: Triggered repair with command id 1
INFO  [2017-06-26 18:43:57,753] com.spotify.reaper.service.SegmentRunner: Repair for segment 1 started, status wait will timeout in 1000 millis
DEBUG [2017-06-26 18:43:57,759] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 1, outcome Optional.of(STARTED) / Optional.absent() and message: Repair command 1 has started
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.215 sec - in com.spotify.reaper.unit.service.SegmentRunnerTest
Running com.spotify.reaper.unit.service.ClusterRepairSchedulerTest
DEBUG [2017-06-26 18:43:57,763] com.spotify.reaper.service.SegmentRunner: updated segment 1 with state RUNNING
DEBUG [2017-06-26 18:43:57,763] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 1, outcome Optional.of(SESSION_FAILED) / Optional.absent() and message: Repair command 1 has failed
WARN  [2017-06-26 18:43:57,763] com.spotify.reaper.service.SegmentRunner: repair session failed for segment with id '1' and repair number '1'
INFO  [2017-06-26 18:43:57,763] com.spotify.reaper.service.SegmentRunner: Postponing segment 1
DEBUG [2017-06-26 18:43:57,765] com.spotify.reaper.service.SegmentRunner: handle called for repairCommandId 1, outcome Optional.of(FINISHED) / Optional.absent() and message: Repair command 1 has finished
DEBUG [2017-06-26 18:43:57,765] com.spotify.reaper.service.SegmentRunner: repair session finished for segment with id '1' and repair number '1'
INFO  [2017-06-26 18:43:57,765] com.spotify.reaper.service.SegmentRunner: Repair command 1 on segment 1 returned with state NOT_STARTED
DEBUG [2017-06-26 18:43:57,765] com.spotify.reaper.service.SegmentRunner: Exiting synchronized section with segment ID 1
INFO  [2017-06-26 18:43:57,769] com.spotify.reaper.resources.CommonTools: create new repair unit for cluster 'cluster1', keyspace 'keyspace1', and column families: []
INFO  [2017-06-26 18:43:57,769] com.spotify.reaper.service.ClusterRepairScheduler: Scheduled repair created: com.spotify.reaper.core.RepairSchedule@775a5a67
INFO  [2017-06-26 18:43:57,770] com.spotify.reaper.resources.CommonTools: create new repair unit for cluster 'cluster1', keyspace 'keyspace3', and column families: []
INFO  [2017-06-26 18:43:57,770] com.spotify.reaper.service.ClusterRepairScheduler: Scheduled repair created: com.spotify.reaper.core.RepairSchedule@58c16efd
INFO  [2017-06-26 18:43:57,814] com.spotify.reaper.resources.CommonTools: create new repair unit for cluster 'cluster1', keyspace 'keyspace1', and column families: []
INFO  [2017-06-26 18:43:57,815] com.spotify.reaper.service.ClusterRepairScheduler: Scheduled repair created: com.spotify.reaper.core.RepairSchedule@167bae0b
INFO  [2017-06-26 18:43:57,815] com.spotify.reaper.resources.CommonTools: create new repair unit for cluster 'cluster1', keyspace 'keyspace2', and column families: []
INFO  [2017-06-26 18:43:57,815] com.spotify.reaper.service.ClusterRepairScheduler: Scheduled repair created: com.spotify.reaper.core.RepairSchedule@14980819
WARN  [2017-06-26 18:43:57,815] com.spotify.reaper.service.ClusterRepairScheduler: No tables found for keyspace keyspace3 in cluster cluster1. No repair will be scheduled for this keyspace.
INFO  [2017-06-26 18:43:57,816] com.spotify.reaper.resources.CommonTools: create new repair unit for cluster 'cluster1', keyspace 'keyspace4', and column families: []
INFO  [2017-06-26 18:43:57,816] com.spotify.reaper.service.ClusterRepairScheduler: Scheduled repair created: com.spotify.reaper.core.RepairSchedule@6b286640
INFO  [2017-06-26 18:43:57,824] com.spotify.reaper.service.ClusterRepairScheduler: Scheduled repair deleted: com.spotify.reaper.core.RepairSchedule@628aea61
INFO  [2017-06-26 18:43:57,826] com.spotify.reaper.resources.CommonTools: create new repair unit for cluster 'cluster1', keyspace 'keyspace2', and column families: []
INFO  [2017-06-26 18:43:57,826] com.spotify.reaper.service.ClusterRepairScheduler: Scheduled repair created: com.spotify.reaper.core.RepairSchedule@3606eee9
WARN  [2017-06-26 18:43:57,828] com.spotify.reaper.service.ClusterRepairScheduler: No tables found for keyspace keyspace1 in cluster cluster1. No repair will be scheduled for this keyspace.
DEBUG [2017-06-26 18:43:57,829] com.spotify.reaper.service.ClusterRepairScheduler: Scheduled repair skipped for system keyspace system_traces in cluster cluster1.
DEBUG [2017-06-26 18:43:57,829] com.spotify.reaper.service.ClusterRepairScheduler: Scheduled repair skipped for system keyspace system in cluster cluster1.
INFO  [2017-06-26 18:43:57,837] com.spotify.reaper.resources.CommonTools: create new repair unit for cluster 'cluster1', keyspace 'keyspace2', and column families: []
INFO  [2017-06-26 18:43:57,837] com.spotify.reaper.service.ClusterRepairScheduler: Scheduled repair created: com.spotify.reaper.core.RepairSchedule@1e34840f
DEBUG [2017-06-26 18:43:57,837] com.spotify.reaper.service.ClusterRepairScheduler: Scheduled repair skipped for system keyspace system_auth in cluster cluster1.
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.073 sec - in com.spotify.reaper.unit.service.ClusterRepairSchedulerTest
Running com.spotify.reaper.unit.service.SegmentGeneratorTest
INFO  [2017-06-26 18:43:57,849] com.spotify.reaper.service.SegmentGenerator: Dividing token range [0,113427455640312821154458202477256070485) into 7 segments
DEBUG [2017-06-26 18:43:57,849] com.spotify.reaper.service.SegmentGenerator: Segment #1: [0,16203922234330403022065457496750867212)
DEBUG [2017-06-26 18:43:57,850] com.spotify.reaper.service.SegmentGenerator: Segment #2: [16203922234330403022065457496750867212,32407844468660806044130914993501734424)
DEBUG [2017-06-26 18:43:57,850] com.spotify.reaper.service.SegmentGenerator: Segment #3: [32407844468660806044130914993501734424,48611766702991209066196372490252601636)
DEBUG [2017-06-26 18:43:57,850] com.spotify.reaper.service.SegmentGenerator: Segment #4: [48611766702991209066196372490252601636,64815688937321612088261829987003468848)
DEBUG [2017-06-26 18:43:57,850] com.spotify.reaper.service.SegmentGenerator: Segment #5: [64815688937321612088261829987003468848,81019611171652015110327287483754336060)
DEBUG [2017-06-26 18:43:57,850] com.spotify.reaper.service.SegmentGenerator: Segment #6: [81019611171652015110327287483754336060,97223533405982418132392744980505203272)
DEBUG [2017-06-26 18:43:57,850] com.spotify.reaper.service.SegmentGenerator: Segment #7: [97223533405982418132392744980505203272,113427455640312821154458202477256070485)
INFO  [2017-06-26 18:43:57,850] com.spotify.reaper.service.SegmentGenerator: Dividing token range [113427455640312821154458202477256070485,1) into 4 segments
DEBUG [2017-06-26 18:43:57,850] com.spotify.reaper.service.SegmentGenerator: Segment #1: [113427455640312821154458202477256070485,127605887595351923798765477786913079296)
DEBUG [2017-06-26 18:43:57,850] com.spotify.reaper.service.SegmentGenerator: Segment #2: [127605887595351923798765477786913079296,141784319550391026443072753096570088107)
DEBUG [2017-06-26 18:43:57,851] com.spotify.reaper.service.SegmentGenerator: Segment #3: [141784319550391026443072753096570088107,155962751505430129087380028406227096918)
DEBUG [2017-06-26 18:43:57,851] com.spotify.reaper.service.SegmentGenerator: Segment #4: [155962751505430129087380028406227096918,1)
INFO  [2017-06-26 18:43:57,851] com.spotify.reaper.service.SegmentGenerator: Dividing token range [1,56713727820156410577229101238628035242) into 4 segments
DEBUG [2017-06-26 18:43:57,851] com.spotify.reaper.service.SegmentGenerator: Segment #1: [1,14178431955039102644307275309657008811)
DEBUG [2017-06-26 18:43:57,851] com.spotify.reaper.service.SegmentGenerator: Segment #2: [14178431955039102644307275309657008811,28356863910078205288614550619314017621)
DEBUG [2017-06-26 18:43:57,851] com.spotify.reaper.service.SegmentGenerator: Segment #3: [28356863910078205288614550619314017621,42535295865117307932921825928971026431)
DEBUG [2017-06-26 18:43:57,851] com.spotify.reaper.service.SegmentGenerator: Segment #4: [42535295865117307932921825928971026431,56713727820156410577229101238628035242)
INFO  [2017-06-26 18:43:57,851] com.spotify.reaper.service.SegmentGenerator: Dividing token range [56713727820156410577229101238628035242,56713727820156410577229101238628035243) into 1 segments
DEBUG [2017-06-26 18:43:57,851] com.spotify.reaper.service.SegmentGenerator: Segment #1: [56713727820156410577229101238628035242,56713727820156410577229101238628035243)
INFO  [2017-06-26 18:43:57,851] com.spotify.reaper.service.SegmentGenerator: Dividing token range [56713727820156410577229101238628035243,113427455640312821154458202477256070484) into 4 segments
DEBUG [2017-06-26 18:43:57,852] com.spotify.reaper.service.SegmentGenerator: Segment #1: [56713727820156410577229101238628035243,70892159775195513221536376548285044053)
DEBUG [2017-06-26 18:43:57,852] com.spotify.reaper.service.SegmentGenerator: Segment #2: [70892159775195513221536376548285044053,85070591730234615865843651857942052863)
DEBUG [2017-06-26 18:43:57,852] com.spotify.reaper.service.SegmentGenerator: Segment #3: [85070591730234615865843651857942052863,99249023685273718510150927167599061673)
DEBUG [2017-06-26 18:43:57,852] com.spotify.reaper.service.SegmentGenerator: Segment #4: [99249023685273718510150927167599061673,113427455640312821154458202477256070484)
INFO  [2017-06-26 18:43:57,852] com.spotify.reaper.service.SegmentGenerator: Dividing token range [113427455640312821154458202477256070484,0) into 4 segments
DEBUG [2017-06-26 18:43:57,852] com.spotify.reaper.service.SegmentGenerator: Segment #1: [113427455640312821154458202477256070484,127605887595351923798765477786913079295)
DEBUG [2017-06-26 18:43:57,852] com.spotify.reaper.service.SegmentGenerator: Segment #2: [127605887595351923798765477786913079295,141784319550391026443072753096570088106)
DEBUG [2017-06-26 18:43:57,852] com.spotify.reaper.service.SegmentGenerator: Segment #3: [141784319550391026443072753096570088106,155962751505430129087380028406227096917)
DEBUG [2017-06-26 18:43:57,852] com.spotify.reaper.service.SegmentGenerator: Segment #4: [155962751505430129087380028406227096917,0)
INFO  [2017-06-26 18:43:57,854] com.spotify.reaper.service.SegmentGenerator: Dividing token range [0,1) into 1 segments
DEBUG [2017-06-26 18:43:57,854] com.spotify.reaper.service.SegmentGenerator: Segment #1: [0,1)
INFO  [2017-06-26 18:43:57,854] com.spotify.reaper.service.SegmentGenerator: Dividing token range [1,56713727820156410577229101238628035242) into 4 segments
DEBUG [2017-06-26 18:43:57,854] com.spotify.reaper.service.SegmentGenerator: Segment #1: [1,14178431955039102644307275309657008811)
DEBUG [2017-06-26 18:43:57,854] com.spotify.reaper.service.SegmentGenerator: Segment #2: [14178431955039102644307275309657008811,28356863910078205288614550619314017621)
DEBUG [2017-06-26 18:43:57,854] com.spotify.reaper.service.SegmentGenerator: Segment #3: [28356863910078205288614550619314017621,42535295865117307932921825928971026431)
DEBUG [2017-06-26 18:43:57,854] com.spotify.reaper.service.SegmentGenerator: Segment #4: [42535295865117307932921825928971026431,56713727820156410577229101238628035242)
INFO  [2017-06-26 18:43:57,856] com.spotify.reaper.service.SegmentGenerator: Dividing token range [56713727820156410577229101238628035243,113427455640312821154458202477256070484) into 4 segments
DEBUG [2017-06-26 18:43:57,856] com.spotify.reaper.service.SegmentGenerator: Segment #1: [56713727820156410577229101238628035243,70892159775195513221536376548285044053)
DEBUG [2017-06-26 18:43:57,856] com.spotify.reaper.service.SegmentGenerator: Segment #2: [70892159775195513221536376548285044053,85070591730234615865843651857942052863)
DEBUG [2017-06-26 18:43:57,856] com.spotify.reaper.service.SegmentGenerator: Segment #3: [85070591730234615865843651857942052863,99249023685273718510150927167599061673)
DEBUG [2017-06-26 18:43:57,856] com.spotify.reaper.service.SegmentGenerator: Segment #4: [99249023685273718510150927167599061673,113427455640312821154458202477256070484)
INFO  [2017-06-26 18:43:57,856] com.spotify.reaper.service.SegmentGenerator: Dividing token range [113427455640312821154458202477256070484,113427455640312821154458202477256070485) into 1 segments
DEBUG [2017-06-26 18:43:57,857] com.spotify.reaper.service.SegmentGenerator: Segment #1: [113427455640312821154458202477256070484,113427455640312821154458202477256070485)
INFO  [2017-06-26 18:43:57,857] com.spotify.reaper.service.SegmentGenerator: Dividing token range [113427455640312821154458202477256070485,5) into 4 segments
DEBUG [2017-06-26 18:43:57,857] com.spotify.reaper.service.SegmentGenerator: Segment #1: [113427455640312821154458202477256070485,127605887595351923798765477786913079297)
DEBUG [2017-06-26 18:43:57,857] com.spotify.reaper.service.SegmentGenerator: Segment #2: [127605887595351923798765477786913079297,141784319550391026443072753096570088109)
DEBUG [2017-06-26 18:43:57,857] com.spotify.reaper.service.SegmentGenerator: Segment #3: [141784319550391026443072753096570088109,155962751505430129087380028406227096921)
DEBUG [2017-06-26 18:43:57,857] com.spotify.reaper.service.SegmentGenerator: Segment #4: [155962751505430129087380028406227096921,5)
INFO  [2017-06-26 18:43:57,857] com.spotify.reaper.service.SegmentGenerator: Dividing token range [5,6) into 1 segments
DEBUG [2017-06-26 18:43:57,857] com.spotify.reaper.service.SegmentGenerator: Segment #1: [5,6)
INFO  [2017-06-26 18:43:57,857] com.spotify.reaper.service.SegmentGenerator: Dividing token range [6,56713727820156410577229101238628035242) into 4 segments
DEBUG [2017-06-26 18:43:57,857] com.spotify.reaper.service.SegmentGenerator: Segment #1: [6,14178431955039102644307275309657008815)
DEBUG [2017-06-26 18:43:57,857] com.spotify.reaper.service.SegmentGenerator: Segment #2: [14178431955039102644307275309657008815,28356863910078205288614550619314017624)
DEBUG [2017-06-26 18:43:57,857] com.spotify.reaper.service.SegmentGenerator: Segment #3: [28356863910078205288614550619314017624,42535295865117307932921825928971026433)
DEBUG [2017-06-26 18:43:57,858] com.spotify.reaper.service.SegmentGenerator: Segment #4: [42535295865117307932921825928971026433,56713727820156410577229101238628035242)
INFO  [2017-06-26 18:43:57,858] com.spotify.reaper.service.SegmentGenerator: Dividing token range [56713727820156410577229101238628035242,56713727820156410577229101238628035243) into 1 segments
DEBUG [2017-06-26 18:43:57,858] com.spotify.reaper.service.SegmentGenerator: Segment #1: [56713727820156410577229101238628035242,56713727820156410577229101238628035243)
INFO  [2017-06-26 18:43:57,859] com.spotify.reaper.service.SegmentGenerator: Dividing token range [0,1) into 1 segments
DEBUG [2017-06-26 18:43:57,859] com.spotify.reaper.service.SegmentGenerator: Segment #1: [0,1)
INFO  [2017-06-26 18:43:57,859] com.spotify.reaper.service.SegmentGenerator: Dividing token range [1,56713727820156410577229101238628035242) into 4 segments
DEBUG [2017-06-26 18:43:57,859] com.spotify.reaper.service.SegmentGenerator: Segment #1: [1,14178431955039102644307275309657008811)
DEBUG [2017-06-26 18:43:57,859] com.spotify.reaper.service.SegmentGenerator: Segment #2: [14178431955039102644307275309657008811,28356863910078205288614550619314017621)
DEBUG [2017-06-26 18:43:57,860] com.spotify.reaper.service.SegmentGenerator: Segment #3: [28356863910078205288614550619314017621,42535295865117307932921825928971026431)
DEBUG [2017-06-26 18:43:57,860] com.spotify.reaper.service.SegmentGenerator: Segment #4: [42535295865117307932921825928971026431,56713727820156410577229101238628035242)
INFO  [2017-06-26 18:43:57,867] com.spotify.reaper.service.SegmentGenerator: Dividing token range [56713727820156410577229101238628035242,56713727820156410577229101238628035243) into 1 segments
DEBUG [2017-06-26 18:43:57,867] com.spotify.reaper.service.SegmentGenerator: Segment #1: [56713727820156410577229101238628035242,56713727820156410577229101238628035243)
INFO  [2017-06-26 18:43:57,867] com.spotify.reaper.service.SegmentGenerator: Dividing token range [56713727820156410577229101238628035243,113427455640312821154458202477256070484) into 4 segments
DEBUG [2017-06-26 18:43:57,867] com.spotify.reaper.service.SegmentGenerator: Segment #1: [56713727820156410577229101238628035243,70892159775195513221536376548285044053)
DEBUG [2017-06-26 18:43:57,867] com.spotify.reaper.service.SegmentGenerator: Segment #2: [70892159775195513221536376548285044053,85070591730234615865843651857942052863)
DEBUG [2017-06-26 18:43:57,867] com.spotify.reaper.service.SegmentGenerator: Segment #3: [85070591730234615865843651857942052863,99249023685273718510150927167599061673)
DEBUG [2017-06-26 18:43:57,867] com.spotify.reaper.service.SegmentGenerator: Segment #4: [99249023685273718510150927167599061673,113427455640312821154458202477256070484)
INFO  [2017-06-26 18:43:57,867] com.spotify.reaper.service.SegmentGenerator: Dividing token range [113427455640312821154458202477256070484,113427455640312821154458202477256070485) into 1 segments
DEBUG [2017-06-26 18:43:57,867] com.spotify.reaper.service.SegmentGenerator: Segment #1: [113427455640312821154458202477256070484,113427455640312821154458202477256070485)
INFO  [2017-06-26 18:43:57,868] com.spotify.reaper.service.SegmentGenerator: Dividing token range [113427455640312821154458202477256070485,0) into 4 segments
DEBUG [2017-06-26 18:43:57,868] com.spotify.reaper.service.SegmentGenerator: Segment #1: [113427455640312821154458202477256070485,127605887595351923798765477786913079295)
DEBUG [2017-06-26 18:43:57,868] com.spotify.reaper.service.SegmentGenerator: Segment #2: [127605887595351923798765477786913079295,141784319550391026443072753096570088106)
DEBUG [2017-06-26 18:43:57,868] com.spotify.reaper.service.SegmentGenerator: Segment #3: [141784319550391026443072753096570088106,155962751505430129087380028406227096917)
DEBUG [2017-06-26 18:43:57,868] com.spotify.reaper.service.SegmentGenerator: Segment #4: [155962751505430129087380028406227096917,0)
INFO  [2017-06-26 18:43:57,869] com.spotify.reaper.service.SegmentGenerator: Dividing token range [5,6) into 1 segments
DEBUG [2017-06-26 18:43:57,869] com.spotify.reaper.service.SegmentGenerator: Segment #1: [5,6)
INFO  [2017-06-26 18:43:57,869] com.spotify.reaper.service.SegmentGenerator: Dividing token range [6,56713727820156410577229101238628035242) into 4 segments
DEBUG [2017-06-26 18:43:57,869] com.spotify.reaper.service.SegmentGenerator: Segment #1: [6,14178431955039102644307275309657008815)
DEBUG [2017-06-26 18:43:57,869] com.spotify.reaper.service.SegmentGenerator: Segment #2: [14178431955039102644307275309657008815,28356863910078205288614550619314017624)
DEBUG [2017-06-26 18:43:57,869] com.spotify.reaper.service.SegmentGenerator: Segment #3: [28356863910078205288614550619314017624,42535295865117307932921825928971026433)
DEBUG [2017-06-26 18:43:57,869] com.spotify.reaper.service.SegmentGenerator: Segment #4: [42535295865117307932921825928971026433,56713727820156410577229101238628035242)
INFO  [2017-06-26 18:43:57,869] com.spotify.reaper.service.SegmentGenerator: Dividing token range [56713727820156410577229101238628035242,56713727820156410577229101238628035243) into 1 segments
DEBUG [2017-06-26 18:43:57,869] com.spotify.reaper.service.SegmentGenerator: Segment #1: [56713727820156410577229101238628035242,56713727820156410577229101238628035243)
INFO  [2017-06-26 18:43:57,870] com.spotify.reaper.service.SegmentGenerator: Dividing token range [56713727820156410577229101238628035243,113427455640312821154458202477256070484) into 4 segments
Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.036 sec - in com.spotify.reaper.unit.service.SegmentGeneratorTest
Running com.spotify.reaper.unit.core.ClusterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in com.spotify.reaper.unit.core.ClusterTest
DEBUG [2017-06-26 18:43:57,870] com.spotify.reaper.service.SegmentGenerator: Segment #1: [56713727820156410577229101238628035243,70892159775195513221536376548285044053)
DEBUG [2017-06-26 18:43:57,876] com.spotify.reaper.service.SegmentGenerator: Segment #2: [70892159775195513221536376548285044053,85070591730234615865843651857942052863)
DEBUG [2017-06-26 18:43:57,876] com.spotify.reaper.service.SegmentGenerator: Segment #3: [85070591730234615865843651857942052863,99249023685273718510150927167599061673)
DEBUG [2017-06-26 18:43:57,877] com.spotify.reaper.service.SegmentGenerator: Segment #4: [99249023685273718510150927167599061673,113427455640312821154458202477256070484)
INFO  [2017-06-26 18:43:57,877] com.spotify.reaper.service.SegmentGenerator: Dividing token range [113427455640312821154458202477256070484,113427455640312821154458202477256070485) into 1 segments
DEBUG [2017-06-26 18:43:57,877] com.spotify.reaper.service.SegmentGenerator: Segment #1: [113427455640312821154458202477256070484,113427455640312821154458202477256070485)
INFO  [2017-06-26 18:43:57,877] com.spotify.reaper.service.SegmentGenerator: Dividing token range [113427455640312821154458202477256070485,5) into 4 segments
DEBUG [2017-06-26 18:43:57,877] com.spotify.reaper.service.SegmentGenerator: Segment #1: [113427455640312821154458202477256070485,127605887595351923798765477786913079297)
DEBUG [2017-06-26 18:43:57,877] com.spotify.reaper.service.SegmentGenerator: Segment #2: [127605887595351923798765477786913079297,141784319550391026443072753096570088109)
DEBUG [2017-06-26 18:43:57,877] com.spotify.reaper.service.SegmentGenerator: Segment #3: [141784319550391026443072753096570088109,155962751505430129087380028406227096921)
DEBUG [2017-06-26 18:43:57,877] com.spotify.reaper.service.SegmentGenerator: Segment #4: [155962751505430129087380028406227096921,5)
INFO  [2017-06-26 18:43:57,961] org.eclipse.jetty.server.AbstractConnector: Stopped application@4ce25e47{HTTP/1.1,[http/1.1]}{127.0.0.1:8083}
INFO  [2017-06-26 18:43:57,985] org.eclipse.jetty.server.AbstractConnector: Stopped admin@6380e9e9{HTTP/1.1,[http/1.1]}{127.0.0.1:8084}
INFO  [2017-06-26 18:43:57,987] org.eclipse.jetty.server.handler.ContextHandler: Stopped i.d.j.MutableServletContextHandler@708769b7{/,null,UNAVAILABLE}
INFO  [2017-06-26 18:43:58,008] org.eclipse.jetty.server.handler.ContextHandler: Stopped i.d.j.MutableServletContextHandler@216c22ce{/,null,UNAVAILABLE}

Results :

Failed tests: 
  expected:<404> but was:<200>
  expected:<404> but was:<200>
Tests in error: 
  com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
  com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
  com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":2,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"other_cluster","keyspace_name":"other_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:51Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 230] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
  com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":2,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"other_cluster","keyspace_name":"other_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:51Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 230] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
  com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
  com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: [{"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}]; line: 1, column: 229] (through reference chain: java.util.ArrayList[0]->com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
  com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 228] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
  com.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type org.apache.cassandra.repair.RepairParallelism from String "sequential": value not one of declared Enum instance names: [DATACENTER_AWARE, SEQUENTIAL, PARALLEL]
 at [Source: {"id":1,"owner":"test_user","state":"ACTIVE","intensity":0.8999999761581421,"cluster_name":"test_cluster","keyspace_name":"test_keyspace","column_families":[],"incremental_repair":false,"segment_count":200,"repair_parallelism":"sequential","scheduled_days_between":1,"creation_time":"2017-06-26T18:43:50Z","next_activation":"2017-06-27T00:00:00Z","pause_time":null}; line: 1, column: 228] (through reference chain: com.spotify.reaper.resources.view.RepairScheduleStatus["repair_parallelism"])
  RepairScheduleStatusTest.testJacksonJSONParsing:41 » Runtime com.fasterxml.jac...

Tests run: 151, Failures: 2, Errors: 9, Skipped: 27

[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 24.439 s
[INFO] Finished at: 2017-06-26T20:43:58+02:00
[INFO] Final Memory: 27M/600M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.19:test (default-test) on project cassandra-reaper: There are test failures.
[ERROR] 
[ERROR] Please refer to /root/workspace/spotify/cassandra-reaper/247176597/target/surefire-reports for the individual test results.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
