[INFO] Scanning for projects...
[WARNING] 
[WARNING] Some problems were encountered while building the effective model for org.axonframework:axon-integrationtests:jar:3.2-SNAPSHOT
[WARNING] 'dependencies.dependency.systemPath' for com.oracle:ojdbc7:jar should not point at files within the project directory, ${project.basedir}/src/test/binary/ojdbc7.jar will be unresolvable by dependent projects @ org.axonframework:axon-integrationtests:[unknown-version], /root/workspace/AxonFramework/AxonFramework/350737857/integrationtests/pom.xml, line 142, column 25
[WARNING] 
[WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.
[WARNING] 
[WARNING] For this reason, future Maven versions might no longer support building such malformed projects.
[WARNING] 
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Build Order:
[INFO] 
[INFO] Axon Framework
[INFO] Axon Framework core
[INFO] Axon Framework Distributed CommandBus JGroups
[INFO] Axon Framework Spring Support
[INFO] Axon AMQP
[INFO] Axon Framework Distributed CommandBus Spring Cloud
[INFO] Axon Framework Spring Boot Support
[INFO] Axon Framework Test Fixtures
[INFO] Axon MongoDB Components
[INFO] Axon Integration tests
[INFO] Axon Metrics
[INFO] Spring Boot Starter module for Axon Framework
[INFO] Spring Boot Starter module for Axon with JGroups Distributed Command Bus
[INFO] Axon Legacy Components
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building Axon Framework 3.2-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building Axon Framework core 3.2-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-enforcer-plugin:1.4.1:enforce (enforce-banned-dependencies) @ axon-core ---
[INFO] Skipping Rule Enforcement.
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:resources (default-resources) @ axon-core ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 7 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:compile (default-compile) @ axon-core ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 524 source files to /root/workspace/AxonFramework/AxonFramework/350737857/core/target/classes
[INFO] /root/workspace/AxonFramework/AxonFramework/350737857/core/src/main/java/org/axonframework/messaging/unitofwork/MessageProcessingContext.java: Some input files use unchecked or unsafe operations.
[INFO] /root/workspace/AxonFramework/AxonFramework/350737857/core/src/main/java/org/axonframework/messaging/unitofwork/MessageProcessingContext.java: Recompile with -Xlint:unchecked for details.
[INFO] 
[INFO] --- maven-bundle-plugin:3.3.0:manifest (default) @ axon-core ---
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:testResources (default-testResources) @ axon-core ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 11 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:testCompile (default-testCompile) @ axon-core ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-surefire-plugin:2.19.1:test (default-test) @ axon-core ---
[INFO] Downloading: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19.1/surefire-junit4-2.19.1.pom
[INFO] Downloaded: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19.1/surefire-junit4-2.19.1.pom (4 KB at 10.5 KB/sec)
[INFO] Downloading: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-providers/2.19.1/surefire-providers-2.19.1.pom
[INFO] Downloaded: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-providers/2.19.1/surefire-providers-2.19.1.pom (3 KB at 113.8 KB/sec)
[INFO] Downloading: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19.1/surefire-junit4-2.19.1.jar
[INFO] Downloaded: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19.1/surefire-junit4-2.19.1.jar (74 KB at 1339.1 KB/sec)

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.axonframework.commandhandling.gateway.DefaultCommandGatewayTest
2018-03-08 10:29:31,520 [main] WARN  DefaultCommandGateway           - Command 'java.lang.String' resulted in java.lang.RuntimeException(java.lang.RuntimeException)
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.309 sec - in org.axonframework.commandhandling.gateway.DefaultCommandGatewayTest
Running org.axonframework.commandhandling.gateway.CommandGatewayFactoryTest
Tests run: 30, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.184 sec - in org.axonframework.commandhandling.gateway.CommandGatewayFactoryTest
Running org.axonframework.commandhandling.conflictresolution.DefaultConflictResolverTest
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.095 sec - in org.axonframework.commandhandling.conflictresolution.DefaultConflictResolverTest
Running org.axonframework.commandhandling.conflictresolution.ConflictResolutionTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 sec - in org.axonframework.commandhandling.conflictresolution.ConflictResolutionTest
Running org.axonframework.commandhandling.conflictresolution.ConflictResolutionIntegrationTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.115 sec - in org.axonframework.commandhandling.conflictresolution.ConflictResolutionIntegrationTest
Running org.axonframework.commandhandling.conflictresolution.ConflictsTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.commandhandling.conflictresolution.ConflictsTest
Running org.axonframework.commandhandling.disruptor.DisruptorCommandBusTest_MultiThreaded
2018-03-08 10:29:32,021 [DisruptorCommandBus-4] INFO  DisruptorCommandBus             - Reset notification for 10d0404d-c9c6-4395-aa4b-ef74aab705d8 received. The aggregate is removed from the blacklist
2018-03-08 10:29:32,021 [DisruptorCommandBus-2] INFO  DisruptorCommandBus             - Reset notification for a6d4068d-c361-46ec-9ff2-bbcb8dcd556d received. The aggregate is removed from the blacklist
2018-03-08 10:29:32,021 [DisruptorCommandBus-3] INFO  DisruptorCommandBus             - Reset notification for 5f9a117d-ff53-4750-b5d3-0f4f13d373f2 received. The aggregate is removed from the blacklist
2018-03-08 10:29:32,021 [DisruptorCommandBus-2] INFO  DisruptorCommandBus             - Reset notification for d8411dc6-6547-43f3-8750-e54fcf692d57 received. The aggregate is removed from the blacklist
2018-03-08 10:29:32,021 [DisruptorCommandBus-4] INFO  DisruptorCommandBus             - Reset notification for 45ce1617-3ceb-4346-a068-bd3290f6d229 received. The aggregate is removed from the blacklist
2018-03-08 10:29:32,022 [DisruptorCommandBus-3] INFO  DisruptorCommandBus             - Reset notification for e862424c-c8c7-4227-a369-2d7ccc145ec0 received. The aggregate is removed from the blacklist
2018-03-08 10:29:32,022 [DisruptorCommandBus-4] INFO  DisruptorCommandBus             - Reset notification for 4056b925-2665-41b6-a671-3a99ce994605 received. The aggregate is removed from the blacklist
2018-03-08 10:29:32,022 [DisruptorCommandBus-4] INFO  DisruptorCommandBus             - Reset notification for f5c4937d-02df-4017-8711-d5280c922100 received. The aggregate is removed from the blacklist
2018-03-08 10:29:32,022 [DisruptorCommandBus-2] INFO  DisruptorCommandBus             - Reset notification for caaa68cc-b740-43bc-b8b0-297e92f04449 received. The aggregate is removed from the blacklist
2018-03-08 10:29:32,024 [DisruptorCommandBus-4] INFO  DisruptorCommandBus             - Reset notification for 2be8c072-948c-41b9-8519-e2eaa0abb751 received. The aggregate is removed from the blacklist
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.251 sec - in org.axonframework.commandhandling.disruptor.DisruptorCommandBusTest_MultiThreaded
Running org.axonframework.commandhandling.disruptor.DisruptorRepositoryTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.02 sec - in org.axonframework.commandhandling.disruptor.DisruptorRepositoryTest
Running org.axonframework.commandhandling.disruptor.CommandHandlerInvokerTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.061 sec - in org.axonframework.commandhandling.disruptor.CommandHandlerInvokerTest
Running org.axonframework.commandhandling.disruptor.DisruptorConfigurationTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.commandhandling.disruptor.DisruptorConfigurationTest
Running org.axonframework.commandhandling.disruptor.DisruptorCommandBusTest
2018-03-08 10:29:35,346 [pool-1-thread-3] INFO  DisruptorCommandBus             - Reset notification for 2f302ac5-eeba-4f27-b0d6-f3fd5c6bf099 received. The aggregate is removed from the blacklist
2018-03-08 10:29:35,357 [pool-1-thread-3] INFO  DisruptorCommandBus             - Reset notification for 2f302ac5-eeba-4f27-b0d6-f3fd5c6bf099 received. The aggregate is removed from the blacklist
2018-03-08 10:29:35,366 [pool-1-thread-3] INFO  DisruptorCommandBus             - Reset notification for 2f302ac5-eeba-4f27-b0d6-f3fd5c6bf099 received. The aggregate is removed from the blacklist
2018-03-08 10:29:35,378 [pool-1-thread-3] INFO  DisruptorCommandBus             - Reset notification for 2f302ac5-eeba-4f27-b0d6-f3fd5c6bf099 received. The aggregate is removed from the blacklist
2018-03-08 10:29:35,385 [pool-1-thread-3] INFO  DisruptorCommandBus             - Reset notification for 2f302ac5-eeba-4f27-b0d6-f3fd5c6bf099 received. The aggregate is removed from the blacklist
2018-03-08 10:29:35,393 [pool-1-thread-3] INFO  DisruptorCommandBus             - Reset notification for 2f302ac5-eeba-4f27-b0d6-f3fd5c6bf099 received. The aggregate is removed from the blacklist
2018-03-08 10:29:35,401 [pool-1-thread-3] INFO  DisruptorCommandBus             - Reset notification for 2f302ac5-eeba-4f27-b0d6-f3fd5c6bf099 received. The aggregate is removed from the blacklist
2018-03-08 10:29:35,413 [pool-1-thread-3] INFO  DisruptorCommandBus             - Reset notification for 2f302ac5-eeba-4f27-b0d6-f3fd5c6bf099 received. The aggregate is removed from the blacklist
2018-03-08 10:29:35,426 [pool-1-thread-3] INFO  DisruptorCommandBus             - Reset notification for 2f302ac5-eeba-4f27-b0d6-f3fd5c6bf099 received. The aggregate is removed from the blacklist
2018-03-08 10:29:35,436 [pool-1-thread-3] INFO  DisruptorCommandBus             - Reset notification for 2f302ac5-eeba-4f27-b0d6-f3fd5c6bf099 received. The aggregate is removed from the blacklist
2018-03-08 10:29:36,709 [DisruptorCommandBus-1] INFO  DisruptorCommandBus             - Reset notification for 8a119872-81be-4c5b-b307-39f35b2e380d received. The aggregate is removed from the blacklist
2018-03-08 10:29:36,710 [DisruptorCommandBus-1] INFO  DisruptorCommandBus             - Reset notification for e382d5fb-e6d6-4bc0-871c-9f9a05ecaee8 received. The aggregate is removed from the blacklist
2018-03-08 10:29:36,710 [DisruptorCommandBus-3] INFO  DisruptorCommandBus             - An error occurred while handling a command [org.axonframework.commandhandling.disruptor.DisruptorCommandBusTest$ErrorCommand].
org.axonframework.common.MockException: This is a failing event. EventStore refuses to store that
2018-03-08 10:29:36,710 [DisruptorCommandBus-5] INFO  DisruptorCommandBus             - An error occurred while handling a command [org.axonframework.commandhandling.disruptor.DisruptorCommandBusTest$ErrorCommand].
org.axonframework.common.MockException: This is a failing event. EventStore refuses to store that
2018-03-08 10:29:38,992 [pool-3-thread-5] INFO  DisruptorCommandBus             - Reset notification for 9b9b4183-dad5-4456-8947-7eb8e6d58190 received. The aggregate is removed from the blacklist
2018-03-08 10:29:39,019 [pool-3-thread-5] INFO  DisruptorCommandBus             - Reset notification for 9b9b4183-dad5-4456-8947-7eb8e6d58190 received. The aggregate is removed from the blacklist
2018-03-08 10:29:39,026 [pool-3-thread-5] INFO  DisruptorCommandBus             - Reset notification for 9b9b4183-dad5-4456-8947-7eb8e6d58190 received. The aggregate is removed from the blacklist
2018-03-08 10:29:39,033 [pool-3-thread-5] INFO  DisruptorCommandBus             - Reset notification for 9b9b4183-dad5-4456-8947-7eb8e6d58190 received. The aggregate is removed from the blacklist
2018-03-08 10:29:39,038 [pool-3-thread-5] INFO  DisruptorCommandBus             - Reset notification for 9b9b4183-dad5-4456-8947-7eb8e6d58190 received. The aggregate is removed from the blacklist
2018-03-08 10:29:39,044 [pool-3-thread-5] INFO  DisruptorCommandBus             - Reset notification for 9b9b4183-dad5-4456-8947-7eb8e6d58190 received. The aggregate is removed from the blacklist
2018-03-08 10:29:39,055 [pool-3-thread-5] INFO  DisruptorCommandBus             - Reset notification for 9b9b4183-dad5-4456-8947-7eb8e6d58190 received. The aggregate is removed from the blacklist
2018-03-08 10:29:39,060 [pool-3-thread-5] INFO  DisruptorCommandBus             - Reset notification for 9b9b4183-dad5-4456-8947-7eb8e6d58190 received. The aggregate is removed from the blacklist
2018-03-08 10:29:39,078 [pool-3-thread-5] INFO  DisruptorCommandBus             - Reset notification for 9b9b4183-dad5-4456-8947-7eb8e6d58190 received. The aggregate is removed from the blacklist
2018-03-08 10:29:39,084 [pool-3-thread-5] INFO  DisruptorCommandBus             - Reset notification for 9b9b4183-dad5-4456-8947-7eb8e6d58190 received. The aggregate is removed from the blacklist
2018-03-08 10:29:45,160 [pool-6-thread-4] INFO  DisruptorCommandBus             - Reset notification for a3f55147-8dd1-4c4a-99a5-414494dc2c94 received. The aggregate is removed from the blacklist
2018-03-08 10:29:45,165 [pool-6-thread-4] INFO  DisruptorCommandBus             - Reset notification for a3f55147-8dd1-4c4a-99a5-414494dc2c94 received. The aggregate is removed from the blacklist
2018-03-08 10:29:45,169 [pool-6-thread-4] INFO  DisruptorCommandBus             - Reset notification for a3f55147-8dd1-4c4a-99a5-414494dc2c94 received. The aggregate is removed from the blacklist
2018-03-08 10:29:45,173 [pool-6-thread-4] INFO  DisruptorCommandBus             - Reset notification for a3f55147-8dd1-4c4a-99a5-414494dc2c94 received. The aggregate is removed from the blacklist
2018-03-08 10:29:45,176 [pool-6-thread-4] INFO  DisruptorCommandBus             - Reset notification for a3f55147-8dd1-4c4a-99a5-414494dc2c94 received. The aggregate is removed from the blacklist
2018-03-08 10:29:45,180 [pool-6-thread-4] INFO  DisruptorCommandBus             - Reset notification for a3f55147-8dd1-4c4a-99a5-414494dc2c94 received. The aggregate is removed from the blacklist
2018-03-08 10:29:45,183 [pool-6-thread-4] INFO  DisruptorCommandBus             - Reset notification for a3f55147-8dd1-4c4a-99a5-414494dc2c94 received. The aggregate is removed from the blacklist
2018-03-08 10:29:45,186 [pool-6-thread-4] INFO  DisruptorCommandBus             - Reset notification for a3f55147-8dd1-4c4a-99a5-414494dc2c94 received. The aggregate is removed from the blacklist
2018-03-08 10:29:45,202 [pool-6-thread-4] INFO  DisruptorCommandBus             - Reset notification for a3f55147-8dd1-4c4a-99a5-414494dc2c94 received. The aggregate is removed from the blacklist
2018-03-08 10:29:45,206 [pool-6-thread-4] INFO  DisruptorCommandBus             - Reset notification for a3f55147-8dd1-4c4a-99a5-414494dc2c94 received. The aggregate is removed from the blacklist
Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 13.167 sec - in org.axonframework.commandhandling.disruptor.DisruptorCommandBusTest
Running org.axonframework.commandhandling.distributed.CommandCallbackRepositoryTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec - in org.axonframework.commandhandling.distributed.CommandCallbackRepositoryTest
Running org.axonframework.commandhandling.distributed.commandfilter.CommandFilterTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.01 sec - in org.axonframework.commandhandling.distributed.commandfilter.CommandFilterTest
Running org.axonframework.commandhandling.distributed.DistributedCommandBusTest
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.051 sec - in org.axonframework.commandhandling.distributed.DistributedCommandBusTest
Running org.axonframework.commandhandling.distributed.ConsistentHashTest
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.018 sec - in org.axonframework.commandhandling.distributed.ConsistentHashTest
Running org.axonframework.commandhandling.distributed.AnnotationRoutingStrategyTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.commandhandling.distributed.AnnotationRoutingStrategyTest
Running org.axonframework.commandhandling.model.EntityEventForwardingModelInspectorTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.026 sec - in org.axonframework.commandhandling.model.EntityEventForwardingModelInspectorTest
Running org.axonframework.commandhandling.model.LockingRepositoryTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.031 sec - in org.axonframework.commandhandling.model.LockingRepositoryTest
Running org.axonframework.commandhandling.model.inspection.AnnotatedAggregateMetaModelFactoryTest
Tests run: 15, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.033 sec - in org.axonframework.commandhandling.model.inspection.AnnotatedAggregateMetaModelFactoryTest
Running org.axonframework.commandhandling.model.inspection.ModelInspectorTest
Tests run: 14, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.026 sec - in org.axonframework.commandhandling.model.inspection.ModelInspectorTest
Running org.axonframework.commandhandling.model.GenericJpaRepositoryTest
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.039 sec - in org.axonframework.commandhandling.model.GenericJpaRepositoryTest
Running org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest
2018-03-08 10:29:46,807 [main] INFO  DefaultTestContextBootstrapper  - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2018-03-08 10:29:46,819 [main] INFO  DefaultTestContextBootstrapper  - Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [javax/servlet/ServletContext]
2018-03-08 10:29:46,821 [main] INFO  DefaultTestContextBootstrapper  - Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@69ee81fc, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@6e2aa843, org.springframework.test.context.support.DirtiesContextTestExecutionListener@6f36c2f0, org.springframework.test.context.transaction.TransactionalTestExecutionListener@f58853c, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@1224144a]
2018-03-08 10:29:46,891 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/jpa-repository-context.xml]
2018-03-08 10:29:47,197 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-03-08 10:29:47,255 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@2f01783a: startup date [Thu Mar 08 10:29:47 CET 2018]; root of context hierarchy
2018-03-08 10:29:47,364 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:29:47,521 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-03-08 10:29:47,548 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:47,567 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:29:47,627 [main] INFO  Version                         - HHH000412: Hibernate Core {5.1.0.Final}
2018-03-08 10:29:47,628 [main] INFO  Environment                     - HHH000206: hibernate.properties not found
2018-03-08 10:29:47,629 [main] INFO  Environment                     - HHH000021: Bytecode provider name : javassist
2018-03-08 10:29:47,665 [main] INFO  Version                         - HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2018-03-08 10:29:48,150 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:29:48,483 [main] INFO  Version                         - HV000001: Hibernate Validator 5.2.4.Final
2018-03-08 10:29:48,911 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: AssociationValueEntry
2018-03-08 10:29:48,912 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: AssociationValueEntry
2018-03-08 10:29:48,916 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: CustomDomainEventEntry
2018-03-08 10:29:48,917 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: CustomDomainEventEntry
2018-03-08 10:29:48,921 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: CustomSagaEntry
2018-03-08 10:29:48,921 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: CustomSagaEntry
2018-03-08 10:29:48,924 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: CustomSnapshotEventEntry
2018-03-08 10:29:48,925 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: CustomSnapshotEventEntry
2018-03-08 10:29:48,928 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: DomainEventEntry
2018-03-08 10:29:48,929 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: DomainEventEntry
2018-03-08 10:29:48,932 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: JpaAggregate
2018-03-08 10:29:48,932 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: JpaAggregate
2018-03-08 10:29:48,934 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: SagaEntry
2018-03-08 10:29:48,934 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: SagaEntry
2018-03-08 10:29:48,936 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: SnapshotEventEntry
2018-03-08 10:29:48,936 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: SnapshotEventEntry
2018-03-08 10:29:48,939 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: StubAggregate
2018-03-08 10:29:48,940 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: StubAggregate
2018-03-08 10:29:49,073 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:49,245 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@62a68bcb testClass = JpaRepositoryIntegrationTest, testInstance = org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest@18b74ea, testMethod = testUpdateAnAggregate@JpaRepositoryIntegrationTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@365cdacf testClass = JpaRepositoryIntegrationTest, locations = '{classpath:/META-INF/spring/jpa-repository-context.xml, classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@1cfc2538]; rollback [true]
2018-03-08 10:29:49,311 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@62a68bcb testClass = JpaRepositoryIntegrationTest, testInstance = org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest@18b74ea, testMethod = testUpdateAnAggregate@JpaRepositoryIntegrationTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@365cdacf testClass = JpaRepositoryIntegrationTest, locations = '{classpath:/META-INF/spring/jpa-repository-context.xml, classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:49,314 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@62a68bcb testClass = JpaRepositoryIntegrationTest, testInstance = org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest@2007435e, testMethod = testStoreAndLoadNewAggregate@JpaRepositoryIntegrationTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@365cdacf testClass = JpaRepositoryIntegrationTest, locations = '{classpath:/META-INF/spring/jpa-repository-context.xml, classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@1cfc2538]; rollback [true]
2018-03-08 10:29:49,331 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-03-08 10:29:49,420 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@62a68bcb testClass = JpaRepositoryIntegrationTest, testInstance = org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest@2007435e, testMethod = testStoreAndLoadNewAggregate@JpaRepositoryIntegrationTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@365cdacf testClass = JpaRepositoryIntegrationTest, locations = '{classpath:/META-INF/spring/jpa-repository-context.xml, classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:49,423 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@62a68bcb testClass = JpaRepositoryIntegrationTest, testInstance = org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest@75cf0de5, testMethod = testDeleteAnAggregate@JpaRepositoryIntegrationTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@365cdacf testClass = JpaRepositoryIntegrationTest, locations = '{classpath:/META-INF/spring/jpa-repository-context.xml, classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@1cfc2538]; rollback [true]
2018-03-08 10:29:49,432 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@62a68bcb testClass = JpaRepositoryIntegrationTest, testInstance = org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest@75cf0de5, testMethod = testDeleteAnAggregate@JpaRepositoryIntegrationTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@365cdacf testClass = JpaRepositoryIntegrationTest, locations = '{classpath:/META-INF/spring/jpa-repository-context.xml, classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.708 sec - in org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest
Running org.axonframework.commandhandling.model.AnnotatedAggregateTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec - in org.axonframework.commandhandling.model.AnnotatedAggregateTest
Running org.axonframework.commandhandling.model.EventSourcingRepositoryTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 sec - in org.axonframework.commandhandling.model.EventSourcingRepositoryTest
Running org.axonframework.commandhandling.model.AbstractRepositoryTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec - in org.axonframework.commandhandling.model.AbstractRepositoryTest
Running org.axonframework.commandhandling.CurrentUnitOfWorkParameterResolverFactoryTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.011 sec - in org.axonframework.commandhandling.CurrentUnitOfWorkParameterResolverFactoryTest
Running org.axonframework.commandhandling.AsynchronousCommandBusTest
2018-03-08 10:29:49,475 [main] INFO  LoggingCallback                 - Command executed successfully: java.lang.Object
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.009 sec - in org.axonframework.commandhandling.AsynchronousCommandBusTest
Running org.axonframework.commandhandling.AnnotationCommandHandlerAdapterTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.024 sec - in org.axonframework.commandhandling.AnnotationCommandHandlerAdapterTest
Running org.axonframework.commandhandling.callbacks.VoidCallbackTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.commandhandling.callbacks.VoidCallbackTest
Running org.axonframework.commandhandling.callbacks.FutureCallbackTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.commandhandling.callbacks.FutureCallbackTest
Running org.axonframework.commandhandling.AggregateAnnotationCommandHandlerTest
2018-03-08 10:29:49,584 [main] INFO  LoggingCallback                 - Command executed successfully: org.axonframework.commandhandling.AggregateAnnotationCommandHandlerTest$CreateCommand
2018-03-08 10:29:49,635 [main] INFO  LoggingCallback                 - Command executed successfully: org.axonframework.commandhandling.AggregateAnnotationCommandHandlerTest$CreateFactoryMethodCommand
Tests run: 22, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.248 sec - in org.axonframework.commandhandling.AggregateAnnotationCommandHandlerTest
Running org.axonframework.commandhandling.GenericCommandMessageTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.commandhandling.GenericCommandMessageTest
Running org.axonframework.commandhandling.CommandHandlingTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.commandhandling.CommandHandlingTest
Running org.axonframework.commandhandling.AnnotationCommandTargetResolverTest
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.commandhandling.AnnotationCommandTargetResolverTest
Running org.axonframework.commandhandling.SimpleCommandBusTest
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 sec - in org.axonframework.commandhandling.SimpleCommandBusTest
Running org.axonframework.serialization.FixedValueRevisionResolverTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.FixedValueRevisionResolverTest
Running org.axonframework.serialization.converters.InputStreamToByteArrayConverterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.converters.InputStreamToByteArrayConverterTest
Running org.axonframework.serialization.converters.ByteArrayToStringConverterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.converters.ByteArrayToStringConverterTest
Running org.axonframework.serialization.converters.StringToByteArrayConverterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.converters.StringToByteArrayConverterTest
Running org.axonframework.serialization.json.ByteArrayToJsonNodeConverterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.165 sec - in org.axonframework.serialization.json.ByteArrayToJsonNodeConverterTest
Running org.axonframework.serialization.json.JacksonSerializerTest
Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.219 sec - in org.axonframework.serialization.json.JacksonSerializerTest
Running org.axonframework.serialization.json.MetaDataDeserializerTest
Tests run: 20, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.07 sec - in org.axonframework.serialization.json.MetaDataDeserializerTest
Running org.axonframework.serialization.json.JsonNodeToByteArrayConverterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.json.JsonNodeToByteArrayConverterTest
Running org.axonframework.serialization.upcasting.event.AbstractContextAwareEventMultiUpcasterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.022 sec - in org.axonframework.serialization.upcasting.event.AbstractContextAwareEventMultiUpcasterTest
Running org.axonframework.serialization.upcasting.event.AbstractContextAwareSingleEventUpcasterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec - in org.axonframework.serialization.upcasting.event.AbstractContextAwareSingleEventUpcasterTest
Running org.axonframework.serialization.upcasting.event.AbstractEventMultiUpcasterTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.027 sec - in org.axonframework.serialization.upcasting.event.AbstractEventMultiUpcasterTest
Running org.axonframework.serialization.upcasting.event.AbstractSingleEventUpcasterTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.173 sec - in org.axonframework.serialization.upcasting.event.AbstractSingleEventUpcasterTest
Running org.axonframework.serialization.upcasting.event.EventUpcasterChainTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec - in org.axonframework.serialization.upcasting.event.EventUpcasterChainTest
Running org.axonframework.serialization.upcasting.GenericUpcasterChainTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec - in org.axonframework.serialization.upcasting.GenericUpcasterChainTest
Running org.axonframework.serialization.JavaSerializerTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 sec - in org.axonframework.serialization.JavaSerializerTest
Running org.axonframework.serialization.xml.InputStreamToDom4jConverterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.serialization.xml.InputStreamToDom4jConverterTest
Running org.axonframework.serialization.xml.InputStreamToXomConverterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.019 sec - in org.axonframework.serialization.xml.InputStreamToXomConverterTest
Running org.axonframework.serialization.xml.Dom4JToByteArrayConverterTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec - in org.axonframework.serialization.xml.Dom4JToByteArrayConverterTest
Running org.axonframework.serialization.xml.XStreamSerializerTest
Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.047 sec - in org.axonframework.serialization.xml.XStreamSerializerTest
Running org.axonframework.serialization.xml.XomToStringConverterTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.xml.XomToStringConverterTest
Running org.axonframework.serialization.SerializedMetaDataValueTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.SerializedMetaDataValueTest
Running org.axonframework.serialization.LazyDeserializingObjectTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec - in org.axonframework.serialization.LazyDeserializingObjectTest
Running org.axonframework.serialization.SerialVersionUIDRevisionResolverTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.serialization.SerialVersionUIDRevisionResolverTest
Running org.axonframework.serialization.SerializationAwareTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 sec - in org.axonframework.serialization.SerializationAwareTest
Running org.axonframework.serialization.MavenArtifactRevisionResolverTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.MavenArtifactRevisionResolverTest
Running org.axonframework.serialization.ChainedConverterTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.009 sec - in org.axonframework.serialization.ChainedConverterTest
Running org.axonframework.serialization.SerializedMessageTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec - in org.axonframework.serialization.SerializedMessageTest
Running org.axonframework.serialization.AnnotationRevisionResolverTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.AnnotationRevisionResolverTest
Running org.axonframework.eventsourcing.eventstore.jpa.DomainEventEntryTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.006 sec - in org.axonframework.eventsourcing.eventstore.jpa.DomainEventEntryTest
Running org.axonframework.eventsourcing.eventstore.jpa.SQLErrorCodesResolverTest
Tests run: 12, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.029 sec - in org.axonframework.eventsourcing.eventstore.jpa.SQLErrorCodesResolverTest
Running org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest
2018-03-08 10:29:50,640 [main] INFO  DefaultTestContextBootstrapper  - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2018-03-08 10:29:50,640 [main] INFO  DefaultTestContextBootstrapper  - Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [javax/servlet/ServletContext]
2018-03-08 10:29:50,641 [main] INFO  DefaultTestContextBootstrapper  - Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@221ca495, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@119d4443, org.springframework.test.context.support.DirtiesContextTestExecutionListener@773eca84, org.springframework.test.context.transaction.TransactionalTestExecutionListener@7d47dfed, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@3a38e4dc]
2018-03-08 10:29:50,641 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-03-08 10:29:50,668 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@41fc0084: startup date [Thu Mar 08 10:29:50 CET 2018]; root of context hierarchy
2018-03-08 10:29:50,677 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:29:50,701 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-03-08 10:29:50,705 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:50,705 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:29:50,750 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:29:50,913 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:29:50,913 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:51,036 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@38d525aa, testMethod = testStoreTwoExactSameSnapshots@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@66298fe9]; rollback [true]
2018-03-08 10:29:51,041 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-03-08 10:29:51,082 [main] WARN  SqlExceptionHelper              - SQL Warning Code: -1100, SQLState: 02000
2018-03-08 10:29:51,082 [main] WARN  SqlExceptionHelper              - no data
2018-03-08 10:29:51,082 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@38d525aa, testMethod = testStoreTwoExactSameSnapshots@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:51,084 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@2cea921a, testMethod = testEventsWithUnknownPayloadTypeAreSkipped@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@66298fe9]; rollback [true]
2018-03-08 10:29:51,144 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@2cea921a, testMethod = testEventsWithUnknownPayloadTypeAreSkipped@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:51,146 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@5ee77baf, testMethod = testStoreEventsWithCustomEntity@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@66298fe9]; rollback [true]
2018-03-08 10:29:51,191 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@5ee77baf, testMethod = testStoreEventsWithCustomEntity@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:51,192 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@41fc0084: startup date [Thu Mar 08 10:29:50 CET 2018]; root of context hierarchy
2018-03-08 10:29:51,192 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:51,194 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-03-08 10:29:51,214 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@6c6379c: startup date [Thu Mar 08 10:29:51 CET 2018]; root of context hierarchy
2018-03-08 10:29:51,224 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:29:51,245 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-03-08 10:29:51,249 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:51,249 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:29:51,286 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:29:51,440 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:29:51,440 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:51,461 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@67dc6b48, testMethod = testStoreAndLoadEventsFromDatastore@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3e39f08c]; rollback [true]
2018-03-08 10:29:51,463 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-03-08 10:29:51,480 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@67dc6b48, testMethod = testStoreAndLoadEventsFromDatastore@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:51,482 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@7221539, testMethod = testLoadLastSequenceNumber@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3e39f08c]; rollback [true]
2018-03-08 10:29:51,494 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@7221539, testMethod = testLoadLastSequenceNumber@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:51,496 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@7d90644f, testMethod = testOldGapsAreRemovedFromProvidedTrackingToken@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3e39f08c]; rollback [true]
2018-03-08 10:29:51,536 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@7d90644f, testMethod = testOldGapsAreRemovedFromProvidedTrackingToken@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:51,536 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@6c6379c: startup date [Thu Mar 08 10:29:51 CET 2018]; root of context hierarchy
2018-03-08 10:29:51,537 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:51,537 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-03-08 10:29:51,555 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@1a43a88e: startup date [Thu Mar 08 10:29:51 CET 2018]; root of context hierarchy
2018-03-08 10:29:51,563 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:29:51,584 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-03-08 10:29:51,588 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:51,588 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:29:51,623 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:29:51,745 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:29:51,745 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:51,771 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@185339ed, testMethod = testGapsForVeryOldEventsAreNotIncluded@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@563ada5]; rollback [true]
2018-03-08 10:29:51,773 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-03-08 10:29:51,802 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@185339ed, testMethod = testGapsForVeryOldEventsAreNotIncluded@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:51,804 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@7be3abaa, testMethod = testUnknownSerializedTypeCausesException@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@563ada5]; rollback [true]
2018-03-08 10:29:51,818 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@7be3abaa, testMethod = testUnknownSerializedTypeCausesException@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:51,820 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@1e95f584, testMethod = testLoad_LargeAmountOfEvents@BatchingEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@563ada5]; rollback [true]
2018-03-08 10:29:52,002 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@1e95f584, testMethod = testLoad_LargeAmountOfEvents@BatchingEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:52,004 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@fceab5d, testMethod = testStoreDuplicateEventWithoutExceptionResolver@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@563ada5]; rollback [true]
2018-03-08 10:29:52,011 [main] WARN  SqlExceptionHelper              - SQL Error: -104, SQLState: 23505
2018-03-08 10:29:52,012 [main] ERROR SqlExceptionHelper              - integrity constraint violation: unique constraint or index violation; UKDG43IA27YPO1JOVW2X64VBWV8 table: DOMAINEVENTENTRY
2018-03-08 10:29:52,014 [main] INFO  AbstractBatchImpl               - HHH000010: On release of batch it still contained JDBC statements
2018-03-08 10:29:52,016 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@fceab5d, testMethod = testStoreDuplicateEventWithoutExceptionResolver@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:52,016 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@1a43a88e: startup date [Thu Mar 08 10:29:51 CET 2018]; root of context hierarchy
2018-03-08 10:29:52,016 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:52,017 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-03-08 10:29:52,035 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@3573e19d: startup date [Thu Mar 08 10:29:52 CET 2018]; root of context hierarchy
2018-03-08 10:29:52,043 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:29:52,063 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-03-08 10:29:52,066 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:52,066 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:29:52,099 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:29:52,190 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:29:52,190 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:52,192 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:29:52,208 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@729d6ee2, testMethod = testStoreDuplicateEventWithExceptionTranslator@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@2759749]; rollback [true]
2018-03-08 10:29:52,211 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-03-08 10:29:52,217 [main] WARN  SqlExceptionHelper              - SQL Error: -104, SQLState: 23505
2018-03-08 10:29:52,217 [main] ERROR SqlExceptionHelper              - integrity constraint violation: unique constraint or index violation; UKDG43IA27YPO1JOVW2X64VBWV8 table: DOMAINEVENTENTRY
2018-03-08 10:29:52,217 [main] INFO  AbstractBatchImpl               - HHH000010: On release of batch it still contained JDBC statements
2018-03-08 10:29:52,218 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@729d6ee2, testMethod = testStoreDuplicateEventWithExceptionTranslator@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:52,219 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@3573e19d: startup date [Thu Mar 08 10:29:52 CET 2018]; root of context hierarchy
2018-03-08 10:29:52,219 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:52,220 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-03-08 10:29:52,235 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@50ac1249: startup date [Thu Mar 08 10:29:52 CET 2018]; root of context hierarchy
2018-03-08 10:29:52,242 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:29:52,261 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-03-08 10:29:52,265 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:52,265 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:29:52,297 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:29:52,387 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:29:52,387 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:52,412 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@504c415c, testMethod = testStoreAndLoadEventsWithUpcaster@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@8585cdd]; rollback [true]
2018-03-08 10:29:52,415 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-03-08 10:29:52,440 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@504c415c, testMethod = testStoreAndLoadEventsWithUpcaster@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:52,441 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@50ac1249: startup date [Thu Mar 08 10:29:52 CET 2018]; root of context hierarchy
2018-03-08 10:29:52,441 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:52,442 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-03-08 10:29:52,463 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@4c418496: startup date [Thu Mar 08 10:29:52 CET 2018]; root of context hierarchy
2018-03-08 10:29:52,474 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:29:52,505 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-03-08 10:29:52,510 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:52,510 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:29:52,564 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:29:52,657 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:29:52,657 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:52,680 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@c79780, testMethod = testUniqueKeyConstraintOnEventIdentifier@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@27682fa9]; rollback [true]
2018-03-08 10:29:52,683 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-03-08 10:29:52,687 [main] WARN  SqlExceptionHelper              - SQL Error: -104, SQLState: 23505
2018-03-08 10:29:52,687 [main] ERROR SqlExceptionHelper              - integrity constraint violation: unique constraint or index violation; UK_K5LT6D2792AMNLOO7Q91NJP0V table: DOMAINEVENTENTRY
2018-03-08 10:29:52,687 [main] INFO  AbstractBatchImpl               - HHH000010: On release of batch it still contained JDBC statements
2018-03-08 10:29:52,687 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@c79780, testMethod = testUniqueKeyConstraintOnEventIdentifier@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:52,688 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@4c418496: startup date [Thu Mar 08 10:29:52 CET 2018]; root of context hierarchy
2018-03-08 10:29:52,688 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:52,689 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-03-08 10:29:52,709 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@178c6261: startup date [Thu Mar 08 10:29:52 CET 2018]; root of context hierarchy
2018-03-08 10:29:52,719 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:29:52,741 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-03-08 10:29:52,746 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:52,747 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:29:52,785 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:29:52,873 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:29:52,873 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:29:52,889 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@77d58f3a, testMethod = testLoadNonExistent@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@76b019c4]; rollback [true]
2018-03-08 10:29:52,892 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-03-08 10:29:52,902 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@77d58f3a, testMethod = testLoadNonExistent@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:52,904 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@77988c45, testMethod = testLoadPartialStreamOfTrackedEvents@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@76b019c4]; rollback [true]
2018-03-08 10:29:52,945 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@77988c45, testMethod = testLoadPartialStreamOfTrackedEvents@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:52,948 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@57fc6759, testMethod = testStoreAndLoadEvents@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@76b019c4]; rollback [true]
2018-03-08 10:29:52,964 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@57fc6759, testMethod = testStoreAndLoadEvents@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:52,966 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@1fa44f66, testMethod = testReturnedEventMessageBehavior@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@76b019c4]; rollback [true]
2018-03-08 10:29:52,973 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@1fa44f66, testMethod = testReturnedEventMessageBehavior@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:52,975 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@6c1a6db1, testMethod = testReadPartialStream@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@76b019c4]; rollback [true]
2018-03-08 10:29:52,985 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@6c1a6db1, testMethod = testReadPartialStream@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:52,987 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@102c24d1, testMethod = testLoadTrackedEvents@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@76b019c4]; rollback [true]
2018-03-08 10:29:53,032 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@102c24d1, testMethod = testLoadTrackedEvents@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:53,034 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@7fce1069, testMethod = testStoreAndLoadEventsArray@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@76b019c4]; rollback [true]
2018-03-08 10:29:53,040 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@7fce1069, testMethod = testStoreAndLoadEventsArray@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:53,041 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@4891d727, testMethod = testStoreAndLoadApplicationEvent@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@76b019c4]; rollback [true]
2018-03-08 10:29:53,057 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@4891d727, testMethod = testStoreAndLoadApplicationEvent@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:29:53,059 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@1a4ae53d, testMethod = testStoreAndLoadSnapshot@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@76b019c4]; rollback [true]
2018-03-08 10:29:53,069 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@6eabe718 testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@1a4ae53d, testMethod = testStoreAndLoadSnapshot@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5563bb40 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
Tests run: 22, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.433 sec - in org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest
Running org.axonframework.eventsourcing.eventstore.jpa.SQLStateResolverTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventsourcing.eventstore.jpa.SQLStateResolverTest
Running org.axonframework.eventsourcing.eventstore.jdbc.JdbcEventStorageEngineTest
2018-03-08 10:29:53,194 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 20, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.277 sec - in org.axonframework.eventsourcing.eventstore.jdbc.JdbcEventStorageEngineTest
Running org.axonframework.eventsourcing.eventstore.ConcatenatingDomainEventStreamTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.eventsourcing.eventstore.ConcatenatingDomainEventStreamTest
Running org.axonframework.eventsourcing.eventstore.GlobalSequenceTrackingTokenTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventsourcing.eventstore.GlobalSequenceTrackingTokenTest
Running org.axonframework.eventsourcing.eventstore.EventUtilsTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.eventsourcing.eventstore.EventUtilsTest
Running org.axonframework.eventsourcing.eventstore.TrackingTokenSerializationTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.027 sec - in org.axonframework.eventsourcing.eventstore.TrackingTokenSerializationTest
Running org.axonframework.eventsourcing.eventstore.inmemory.InMemoryEventStorageEngineTest
Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.012 sec - in org.axonframework.eventsourcing.eventstore.inmemory.InMemoryEventStorageEngineTest
Running org.axonframework.eventsourcing.eventstore.GapAwareTrackingTokenTest
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec - in org.axonframework.eventsourcing.eventstore.GapAwareTrackingTokenTest
Running org.axonframework.eventsourcing.eventstore.SequenceEventStorageEngineTest
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.009 sec - in org.axonframework.eventsourcing.eventstore.SequenceEventStorageEngineTest
Running org.axonframework.eventsourcing.eventstore.TrackingTokenParameterResolverFactoryTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventsourcing.eventstore.TrackingTokenParameterResolverFactoryTest
Running org.axonframework.eventsourcing.eventstore.EmbeddedEventStoreTest
2018-03-08 10:29:53,626 [main] WARN  EmbeddedEventStore              - Error reading snapshot. Reconstructing aggregate from entire event stream. Caused by: org.axonframework.common.MockException Mock
2018-03-08 10:29:54,022 [EmbeddedEventStore-1] WARN  EmbeddedEventStore              - An event processor fell behind the tail end of the event store cache. This usually indicates a badly performing event processor.
Tests run: 15, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 0.689 sec <<< FAILURE! - in org.axonframework.eventsourcing.eventstore.EmbeddedEventStoreTest
testStreamEventsShouldNotReturnDuplicateTokens(org.axonframework.eventsourcing.eventstore.EmbeddedEventStoreTest)  Time elapsed: 0.031 sec  <<< FAILURE!
junit.framework.AssertionFailedError
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStoreTest.testStreamEventsShouldNotReturnDuplicateTokens(EmbeddedEventStoreTest.java:226)

Running org.axonframework.eventsourcing.EventSourcingRepositoryTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.015 sec - in org.axonframework.eventsourcing.EventSourcingRepositoryTest
Running org.axonframework.eventsourcing.DomainEventStreamTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.eventsourcing.DomainEventStreamTest
Running org.axonframework.eventsourcing.CachingEventSourcingRepositoryTest
2018-03-08 10:29:54,195 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.393 sec - in org.axonframework.eventsourcing.CachingEventSourcingRepositoryTest
Running org.axonframework.eventsourcing.CachingRepositoryWithNestedUnitOfWorkTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.047 sec - in org.axonframework.eventsourcing.CachingRepositoryWithNestedUnitOfWorkTest
Running org.axonframework.eventsourcing.AbstractSnapshotterTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.013 sec - in org.axonframework.eventsourcing.AbstractSnapshotterTest
Running org.axonframework.eventsourcing.EventSourcingRepositoryIntegrationTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.015 sec - in org.axonframework.eventsourcing.EventSourcingRepositoryIntegrationTest
Running org.axonframework.eventsourcing.GenericAggregateFactoryTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.eventsourcing.GenericAggregateFactoryTest
Running org.axonframework.eventsourcing.AggregateSnapshotterTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 sec - in org.axonframework.eventsourcing.AggregateSnapshotterTest
Running org.axonframework.eventsourcing.NoSnapshotTriggerDefinitionTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventsourcing.NoSnapshotTriggerDefinitionTest
Running org.axonframework.eventsourcing.EventCountSnapshotTriggerDefinitionTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec - in org.axonframework.eventsourcing.EventCountSnapshotTriggerDefinitionTest
Running org.axonframework.eventsourcing.FilteringEventStorageEngineTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.eventsourcing.FilteringEventStorageEngineTest
Running org.axonframework.eventsourcing.GenericDomainEventMessageTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventsourcing.GenericDomainEventMessageTest
Running org.axonframework.common.property.BeanPropertyAccessStrategyTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.common.property.BeanPropertyAccessStrategyTest
Running org.axonframework.common.property.UniformPropertyAccessStrategyTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.common.property.UniformPropertyAccessStrategyTest
Running org.axonframework.common.property.DirectPropertyAccessStrategyTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.common.property.DirectPropertyAccessStrategyTest
Running org.axonframework.common.property.PropertyAccessStrategyTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.common.property.PropertyAccessStrategyTest
Running org.axonframework.common.annotation.PriorityAnnotationComparatorTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 sec - in org.axonframework.common.annotation.PriorityAnnotationComparatorTest
Running org.axonframework.common.annotation.AnnotationUtilsTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 sec - in org.axonframework.common.annotation.AnnotationUtilsTest
Running org.axonframework.common.AssertTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.common.AssertTest
Running org.axonframework.common.IdentifierValidatorTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.common.IdentifierValidatorTest
Running org.axonframework.common.jdbc.ConnectionWrapperFactoryTest
Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.018 sec - in org.axonframework.common.jdbc.ConnectionWrapperFactoryTest
Running org.axonframework.common.caching.NoCacheTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.common.caching.NoCacheTest
Running org.axonframework.common.caching.WeakReferenceCacheTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.438 sec - in org.axonframework.common.caching.WeakReferenceCacheTest
Running org.axonframework.common.DateTimeUtilsTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.common.DateTimeUtilsTest
Running org.axonframework.common.lock.LockFactoryTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.017 sec - in org.axonframework.common.lock.LockFactoryTest
Running org.axonframework.common.lock.PessimisticLockFactoryTest
2018-03-08 10:29:55,196 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:29:56,198 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:29:57,199 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:29:58,200 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:29:59,201 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:00,202 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:01,203 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:02,204 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:03,205 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 5, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 8.914 sec <<< FAILURE! - in org.axonframework.common.lock.PessimisticLockFactoryTest
testDeadlockDetected_TwoThreadsInVector(org.axonframework.common.lock.PessimisticLockFactoryTest)  Time elapsed: 5.002 sec  <<< ERROR!
org.junit.runners.model.TestTimedOutException: test timed out after 5000 milliseconds
	at org.axonframework.common.lock.PessimisticLockFactoryTest.testDeadlockDetected_TwoThreadsInVector(PessimisticLockFactoryTest.java:77)

Running org.axonframework.common.ReflectionUtilsTest
Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.common.ReflectionUtilsTest
Running org.axonframework.common.CollectionUtilsTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.common.CollectionUtilsTest
Running org.axonframework.common.AxonThreadFactoryTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.common.AxonThreadFactoryTest
Running org.axonframework.config.MessageMonitorFactoryBuilderTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.config.MessageMonitorFactoryBuilderTest
Running org.axonframework.config.ConfigurationResourceInjectorTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.config.ConfigurationResourceInjectorTest
Running org.axonframework.config.DefaultConfigurerTest
2018-03-08 10:30:04,097 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:04,135 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-03-08 10:30:04,136 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-03-08 10:30:04,136 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-03-08 10:30:04,136 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-03-08 10:30:04,138 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-03-08 10:30:04,152 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:04,191 [main] WARN  ExceptionHandlerLoggedImpl      - GenerationTarget encountered exception accepting command : Unable to execute command [drop sequence hibernate_sequence]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Unable to execute command [drop sequence hibernate_sequence]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:63)
	at org.hibernate.tool.schema.internal.SchemaDropperImpl.applySqlString(SchemaDropperImpl.java:370)
	at org.hibernate.tool.schema.internal.SchemaDropperImpl.applySqlStrings(SchemaDropperImpl.java:355)
	at org.hibernate.tool.schema.internal.SchemaDropperImpl.dropFromMetadata(SchemaDropperImpl.java:245)
	at org.hibernate.tool.schema.internal.SchemaDropperImpl.performDrop(SchemaDropperImpl.java:153)
	at org.hibernate.tool.schema.internal.SchemaDropperImpl.doDrop(SchemaDropperImpl.java:125)
	at org.hibernate.tool.schema.internal.SchemaDropperImpl.doDrop(SchemaDropperImpl.java:111)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:137)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:64)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:458)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:465)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:881)
	at org.hibernate.jpa.HibernatePersistenceProvider.createEntityManagerFactory(HibernatePersistenceProvider.java:58)
	at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:55)
	at org.axonframework.config.DefaultConfigurerTest.setUp(DefaultConfigurerTest.java:66)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:367)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:274)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:161)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:290)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:242)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:121)
Caused by: java.sql.SQLSyntaxErrorException: user lacks privilege or object not found: HIBERNATE_SEQUENCE in statement [drop sequence hibernate_sequence]
	at org.hsqldb.jdbc.JDBCUtil.sqlException(Unknown Source)
	at org.hsqldb.jdbc.JDBCUtil.sqlException(Unknown Source)
	at org.hsqldb.jdbc.JDBCStatement.fetchResult(Unknown Source)
	at org.hsqldb.jdbc.JDBCStatement.execute(Unknown Source)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:51)
	... 39 more
Caused by: org.hsqldb.HsqlException: user lacks privilege or object not found: HIBERNATE_SEQUENCE
	at org.hsqldb.error.Error.error(Unknown Source)
	at org.hsqldb.error.Error.error(Unknown Source)
	at org.hsqldb.StatementSchema.getResult(Unknown Source)
	at org.hsqldb.StatementSchema.execute(Unknown Source)
	at org.hsqldb.Session.executeCompiledStatement(Unknown Source)
	at org.hsqldb.Session.executeDirectStatement(Unknown Source)
	at org.hsqldb.Session.execute(Unknown Source)
	... 42 more
2018-03-08 10:30:04,199 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@2e3b4394'
2018-03-08 10:30:04,206 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:04,206 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:30:04,228 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'org.axonframework.config'. Awaiting termination...
2018-03-08 10:30:04,230 [EventProcessor[org.axonframework.config]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=org.axonframework.config, segment=Segment[0/1]}
2018-03-08 10:30:04,231 [EventProcessor[org.axonframework.config]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=org.axonframework.config, segment=Segment[1/1]}
2018-03-08 10:30:04,238 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:04,271 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-03-08 10:30:04,271 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-03-08 10:30:04,271 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-03-08 10:30:04,271 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-03-08 10:30:04,271 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-03-08 10:30:04,272 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:04,317 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@2e3b4394'
2018-03-08 10:30:04,324 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:30:04,336 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:04,369 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-03-08 10:30:04,370 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-03-08 10:30:04,370 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-03-08 10:30:04,370 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-03-08 10:30:04,370 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-03-08 10:30:04,370 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:04,415 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@2e3b4394'
2018-03-08 10:30:04,422 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:30:04,433 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-03-08 10:30:04,450 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:04,483 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-03-08 10:30:04,483 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-03-08 10:30:04,483 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-03-08 10:30:04,483 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-03-08 10:30:04,483 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-03-08 10:30:04,484 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:04,536 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@2e3b4394'
2018-03-08 10:30:04,546 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:30:04,549 [EventProcessor[org.axonframework.config]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=org.axonframework.config, segment=Segment[0/1]}
2018-03-08 10:30:04,549 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'org.axonframework.config'. Awaiting termination...
2018-03-08 10:30:04,550 [EventProcessor[org.axonframework.config]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=org.axonframework.config, segment=Segment[1/1]}
2018-03-08 10:30:04,555 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:04,589 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-03-08 10:30:04,589 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-03-08 10:30:04,589 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-03-08 10:30:04,589 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-03-08 10:30:04,589 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-03-08 10:30:04,589 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:04,632 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@2e3b4394'
2018-03-08 10:30:04,638 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:30:04,644 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:04,686 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-03-08 10:30:04,686 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-03-08 10:30:04,686 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-03-08 10:30:04,686 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-03-08 10:30:04,686 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-03-08 10:30:04,687 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:04,735 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@2e3b4394'
2018-03-08 10:30:04,749 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:30:04,763 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:04,802 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-03-08 10:30:04,802 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-03-08 10:30:04,802 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-03-08 10:30:04,803 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-03-08 10:30:04,803 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-03-08 10:30:04,803 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:04,857 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@2e3b4394'
2018-03-08 10:30:04,866 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:30:04,891 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:04,951 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-03-08 10:30:04,951 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-03-08 10:30:04,951 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-03-08 10:30:04,952 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-03-08 10:30:04,952 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-03-08 10:30:04,952 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:05,030 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@2e3b4394'
2018-03-08 10:30:05,038 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:30:05,045 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:05,075 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-03-08 10:30:05,075 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-03-08 10:30:05,075 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-03-08 10:30:05,075 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-03-08 10:30:05,075 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-03-08 10:30:05,076 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:05,114 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@2e3b4394'
2018-03-08 10:30:05,124 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:30:05,140 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:05,179 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-03-08 10:30:05,179 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-03-08 10:30:05,179 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-03-08 10:30:05,179 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-03-08 10:30:05,179 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-03-08 10:30:05,180 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:05,206 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:05,214 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@2e3b4394'
2018-03-08 10:30:05,220 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.156 sec - in org.axonframework.config.DefaultConfigurerTest
Running org.axonframework.config.SagaConfigurationTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.025 sec - in org.axonframework.config.SagaConfigurationTest
Running org.axonframework.config.EventHandlingConfigurationTest
2018-03-08 10:30:05,265 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=tracking, segment=Segment[0/0]}
2018-03-08 10:30:05,265 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:05,267 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'tracking'. Awaiting termination...
2018-03-08 10:30:05,276 [EventProcessor[concurrent]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=concurrent, segment=Segment[0/0]}
2018-03-08 10:30:05,276 [EventProcessor[concurrent]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:05,280 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=tracking, segment=Segment[0/0]}
2018-03-08 10:30:05,280 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:05,281 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'tracking'. Awaiting termination...
2018-03-08 10:30:06,209 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:06,293 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=tracking, segment=Segment[0/0]}
2018-03-08 10:30:06,293 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:06,294 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'tracking'. Awaiting termination...
2018-03-08 10:30:06,299 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=tracking, segment=Segment[0/0]}
2018-03-08 10:30:06,299 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:06,299 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'tracking'. Awaiting termination...
2018-03-08 10:30:06,303 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=tracking, segment=Segment[0/0]}
2018-03-08 10:30:06,303 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:06,304 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'tracking'. Awaiting termination...
2018-03-08 10:30:07,210 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.048 sec - in org.axonframework.config.EventHandlingConfigurationTest
Running org.axonframework.config.ConfigurationParameterResolverFactoryTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.006 sec - in org.axonframework.config.ConfigurationParameterResolverFactoryTest
Running org.axonframework.eventhandling.scheduling.quartz.QuartzEventSchedulerTest
2018-03-08 10:30:07,344 [main] INFO  StdSchedulerFactory             - Using default implementation for ThreadExecutor
2018-03-08 10:30:07,347 [main] INFO  SimpleThreadPool                - Job execution threads will use class loader of thread: main
2018-03-08 10:30:07,361 [main] INFO  SchedulerSignalerImpl           - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2018-03-08 10:30:07,361 [main] INFO  QuartzScheduler                 - Quartz Scheduler v.2.2.1 created.
2018-03-08 10:30:07,362 [main] INFO  RAMJobStore                     - RAMJobStore initialized.
2018-03-08 10:30:07,363 [main] INFO  QuartzScheduler                 - Scheduler meta-data: Quartz Scheduler (v2.2.1) 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

2018-03-08 10:30:07,363 [main] INFO  StdSchedulerFactory             - Quartz scheduler 'DefaultQuartzScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
2018-03-08 10:30:07,363 [main] INFO  StdSchedulerFactory             - Quartz scheduler version: 2.2.1
2018-03-08 10:30:07,363 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-03-08 10:30:07,407 [DefaultQuartzScheduler_Worker-1] INFO  FireEventJob                    - Job successfully executed. Scheduled Event [StubEvent] has been published.
2018-03-08 10:30:07,407 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutting down.
2018-03-08 10:30:07,407 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED paused.
2018-03-08 10:30:07,850 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutdown complete.
2018-03-08 10:30:07,852 [main] INFO  StdSchedulerFactory             - Using default implementation for ThreadExecutor
2018-03-08 10:30:07,852 [main] INFO  SimpleThreadPool                - Job execution threads will use class loader of thread: main
2018-03-08 10:30:07,854 [main] INFO  SchedulerSignalerImpl           - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2018-03-08 10:30:07,854 [main] INFO  QuartzScheduler                 - Quartz Scheduler v.2.2.1 created.
2018-03-08 10:30:07,854 [main] INFO  RAMJobStore                     - RAMJobStore initialized.
2018-03-08 10:30:07,854 [main] INFO  QuartzScheduler                 - Scheduler meta-data: Quartz Scheduler (v2.2.1) 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

2018-03-08 10:30:07,854 [main] INFO  StdSchedulerFactory             - Quartz scheduler 'DefaultQuartzScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
2018-03-08 10:30:07,854 [main] INFO  StdSchedulerFactory             - Quartz scheduler version: 2.2.1
2018-03-08 10:30:07,854 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-03-08 10:30:07,890 [DefaultQuartzScheduler_Worker-1] INFO  FireEventJob                    - Job successfully executed. Scheduled Event [StubEvent] has been published.
2018-03-08 10:30:07,891 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutting down.
2018-03-08 10:30:07,892 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED paused.
2018-03-08 10:30:08,211 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:08,391 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutdown complete.
2018-03-08 10:30:08,393 [main] INFO  StdSchedulerFactory             - Using default implementation for ThreadExecutor
2018-03-08 10:30:08,393 [main] INFO  SimpleThreadPool                - Job execution threads will use class loader of thread: main
2018-03-08 10:30:08,394 [main] INFO  SchedulerSignalerImpl           - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2018-03-08 10:30:08,395 [main] INFO  QuartzScheduler                 - Quartz Scheduler v.2.2.1 created.
2018-03-08 10:30:08,395 [main] INFO  RAMJobStore                     - RAMJobStore initialized.
2018-03-08 10:30:08,395 [main] INFO  QuartzScheduler                 - Scheduler meta-data: Quartz Scheduler (v2.2.1) 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

2018-03-08 10:30:08,395 [main] INFO  StdSchedulerFactory             - Quartz scheduler 'DefaultQuartzScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
2018-03-08 10:30:08,395 [main] INFO  StdSchedulerFactory             - Quartz scheduler version: 2.2.1
2018-03-08 10:30:08,395 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-03-08 10:30:08,399 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutting down.
2018-03-08 10:30:08,399 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED paused.
2018-03-08 10:30:08,895 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutdown complete.
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.582 sec - in org.axonframework.eventhandling.scheduling.quartz.QuartzEventSchedulerTest
Running org.axonframework.eventhandling.scheduling.java.SimpleEventSchedulerTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.159 sec - in org.axonframework.eventhandling.scheduling.java.SimpleEventSchedulerTest
Running org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest
2018-03-08 10:30:09,062 [main] INFO  DefaultTestContextBootstrapper  - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2018-03-08 10:30:09,063 [main] INFO  DefaultTestContextBootstrapper  - Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [javax/servlet/ServletContext]
2018-03-08 10:30:09,063 [main] INFO  DefaultTestContextBootstrapper  - Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@771deee6, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@345effd7, org.springframework.test.context.support.DirtiesContextTestExecutionListener@b9750f0, org.springframework.test.context.transaction.TransactionalTestExecutionListener@2d854c13, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@3577fd9b]
2018-03-08 10:30:09,064 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/saga-repository-test.xml]
2018-03-08 10:30:09,088 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-03-08 10:30:09,104 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@76140ca5: startup date [Thu Mar 08 10:30:09 CET 2018]; root of context hierarchy
2018-03-08 10:30:09,115 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:30:09,140 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-03-08 10:30:09,145 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:09,145 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:09,179 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:09,212 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:09,264 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:30:09,264 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:09,295 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@55105271 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@126a8548, testMethod = testEndSaga@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@6f8c6694 testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@38ebf8dc]; rollback [true]
2018-03-08 10:30:09,300 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-03-08 10:30:09,355 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@55105271 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@126a8548, testMethod = testEndSaga@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@6f8c6694 testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:30:09,355 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@76140ca5: startup date [Thu Mar 08 10:30:09 CET 2018]; root of context hierarchy
2018-03-08 10:30:09,356 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:09,356 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/saga-repository-test.xml]
2018-03-08 10:30:09,372 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-03-08 10:30:09,383 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@6f371390: startup date [Thu Mar 08 10:30:09 CET 2018]; root of context hierarchy
2018-03-08 10:30:09,391 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:30:09,414 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-03-08 10:30:09,418 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:09,419 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:09,459 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:09,547 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:30:09,547 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:09,562 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@55105271 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@5ffae42f, testMethod = testAddingAnInactiveSagaDoesntStoreIt@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@6f8c6694 testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@6b8cfbeb]; rollback [true]
2018-03-08 10:30:09,563 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-03-08 10:30:09,579 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@55105271 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@5ffae42f, testMethod = testAddingAnInactiveSagaDoesntStoreIt@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@6f8c6694 testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:30:09,579 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@6f371390: startup date [Thu Mar 08 10:30:09 CET 2018]; root of context hierarchy
2018-03-08 10:30:09,579 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:09,580 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/saga-repository-test.xml]
2018-03-08 10:30:09,590 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-03-08 10:30:09,599 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@13cfa1ec: startup date [Thu Mar 08 10:30:09 CET 2018]; root of context hierarchy
2018-03-08 10:30:09,605 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:30:09,625 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-03-08 10:30:09,628 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:09,628 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:09,662 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:09,731 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:30:09,731 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:09,746 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@55105271 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@6135bb54, testMethod = testLoadSaga_AssociationValueRemoved@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@6f8c6694 testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@13473685]; rollback [true]
2018-03-08 10:30:09,747 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-03-08 10:30:09,807 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@55105271 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@6135bb54, testMethod = testLoadSaga_AssociationValueRemoved@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@6f8c6694 testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:30:09,807 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@13cfa1ec: startup date [Thu Mar 08 10:30:09 CET 2018]; root of context hierarchy
2018-03-08 10:30:09,808 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:09,808 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/saga-repository-test.xml]
2018-03-08 10:30:09,817 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-03-08 10:30:09,826 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@5f5c2451: startup date [Thu Mar 08 10:30:09 CET 2018]; root of context hierarchy
2018-03-08 10:30:09,832 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:30:09,851 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-03-08 10:30:09,854 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:09,854 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:09,885 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:09,957 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:30:09,957 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:09,973 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@55105271 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@48332a63, testMethod = testStoreSagaWithCustomEntity@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@6f8c6694 testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@717c00f9]; rollback [true]
2018-03-08 10:30:09,975 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-03-08 10:30:10,005 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@55105271 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@48332a63, testMethod = testStoreSagaWithCustomEntity@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@6f8c6694 testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:30:10,005 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@5f5c2451: startup date [Thu Mar 08 10:30:09 CET 2018]; root of context hierarchy
2018-03-08 10:30:10,005 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:10,006 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/saga-repository-test.xml]
2018-03-08 10:30:10,015 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-03-08 10:30:10,026 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@3e6a55fb: startup date [Thu Mar 08 10:30:10 CET 2018]; root of context hierarchy
2018-03-08 10:30:10,034 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:30:10,052 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-03-08 10:30:10,055 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:10,055 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:10,086 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:10,156 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:30:10,156 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:10,172 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@55105271 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@7940d27b, testMethod = testAddAndLoadSaga_ByAssociationValue@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@6f8c6694 testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@4ce2f4d6]; rollback [true]
2018-03-08 10:30:10,173 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-03-08 10:30:10,190 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@55105271 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@7940d27b, testMethod = testAddAndLoadSaga_ByAssociationValue@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@6f8c6694 testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:30:10,190 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@3e6a55fb: startup date [Thu Mar 08 10:30:10 CET 2018]; root of context hierarchy
2018-03-08 10:30:10,190 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:10,191 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/saga-repository-test.xml]
2018-03-08 10:30:10,201 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-03-08 10:30:10,209 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@3c8802cf: startup date [Thu Mar 08 10:30:10 CET 2018]; root of context hierarchy
2018-03-08 10:30:10,213 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:10,217 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:30:10,235 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-03-08 10:30:10,238 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:10,238 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-03-08 10:30:10,284 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:10,373 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-03-08 10:30:10,373 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:10,388 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@55105271 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@7fa1c05f, testMethod = testAddAndLoadSaga_ByIdentifier@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@6f8c6694 testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@49925329]; rollback [true]
2018-03-08 10:30:10,390 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-03-08 10:30:10,407 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@55105271 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@7fa1c05f, testMethod = testAddAndLoadSaga_ByIdentifier@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@6f8c6694 testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:30:10,407 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@3c8802cf: startup date [Thu Mar 08 10:30:10 CET 2018]; root of context hierarchy
2018-03-08 10:30:10,408 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.35 sec - in org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest
Running org.axonframework.eventhandling.saga.repository.AnnotatedSagaRepositoryTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.012 sec - in org.axonframework.eventhandling.saga.repository.AnnotatedSagaRepositoryTest
Running org.axonframework.eventhandling.saga.repository.AssociationValueMapTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.059 sec - in org.axonframework.eventhandling.saga.repository.AssociationValueMapTest
Running org.axonframework.eventhandling.saga.repository.jdbc.JdbcSagaStoreTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.089 sec - in org.axonframework.eventhandling.saga.repository.jdbc.JdbcSagaStoreTest
Running org.axonframework.eventhandling.saga.repository.LockingSagaRepositoryTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.011 sec - in org.axonframework.eventhandling.saga.repository.LockingSagaRepositoryTest
Running org.axonframework.eventhandling.saga.repository.CachingSagaStoreTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.074 sec - in org.axonframework.eventhandling.saga.repository.CachingSagaStoreTest
Running org.axonframework.eventhandling.saga.AnnotatedSagaManagerTest
Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.059 sec - in org.axonframework.eventhandling.saga.AnnotatedSagaManagerTest
Running org.axonframework.eventhandling.saga.AnnotatedSagaTest
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.012 sec - in org.axonframework.eventhandling.saga.AnnotatedSagaTest
Running org.axonframework.eventhandling.saga.SagaManagerTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.01 sec - in org.axonframework.eventhandling.saga.SagaManagerTest
Running org.axonframework.eventhandling.saga.AssociationValuesImplTest
Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventhandling.saga.AssociationValuesImplTest
Running org.axonframework.eventhandling.saga.SimpleResourceInjectorTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.eventhandling.saga.SimpleResourceInjectorTest
Running org.axonframework.eventhandling.saga.metamodel.AnnotationSagaMetaModelFactoryTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.eventhandling.saga.metamodel.AnnotationSagaMetaModelFactoryTest
Running org.axonframework.eventhandling.AnnotationEventListenerAdapterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.eventhandling.AnnotationEventListenerAdapterTest
Running org.axonframework.eventhandling.SubscribingEventProcessorTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 sec - in org.axonframework.eventhandling.SubscribingEventProcessorTest
Running org.axonframework.eventhandling.TimestampParameterResolverFactoryTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventhandling.TimestampParameterResolverFactoryTest
Running org.axonframework.eventhandling.replay.ReplayParameterResolverFactoryTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.eventhandling.replay.ReplayParameterResolverFactoryTest
Running org.axonframework.eventhandling.replay.ReplayAwareMessageHandlerWrapperTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.eventhandling.replay.ReplayAwareMessageHandlerWrapperTest
Running org.axonframework.eventhandling.GenericEventMessageTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.eventhandling.GenericEventMessageTest
Running org.axonframework.eventhandling.async.FullConcurrencyPolicyTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventhandling.async.FullConcurrencyPolicyTest
Running org.axonframework.eventhandling.async.AsynchronousEventProcessingStrategyTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 sec - in org.axonframework.eventhandling.async.AsynchronousEventProcessingStrategyTest
Running org.axonframework.eventhandling.async.AsynchronousEventProcessorConcurrencyTest
2018-03-08 10:30:11,215 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:12,220 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:13,220 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.889 sec - in org.axonframework.eventhandling.async.AsynchronousEventProcessorConcurrencyTest
Running org.axonframework.eventhandling.async.SequentialPerAggregatePolicyTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventhandling.async.SequentialPerAggregatePolicyTest
Running org.axonframework.eventhandling.async.SequentialPolicyTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventhandling.async.SequentialPolicyTest
Running org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest
2018-03-08 10:30:13,670 [main] INFO  AbstractContextLoader           - Could not detect default resource locations for test class [org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest]: no resource found for suffixes {-context.xml}.
2018-03-08 10:30:13,672 [main] INFO  ctDelegatingSmartContextLoader  - AnnotationConfigContextLoader detected default configuration classes for context configuration [ContextConfigurationAttributes@31e5378b declaringClass = 'org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', locations = '{}', inheritLocations = true, initializers = '{}', inheritInitializers = true, name = [null], contextLoaderClass = 'org.springframework.test.context.ContextLoader'].
2018-03-08 10:30:13,673 [main] INFO  DefaultTestContextBootstrapper  - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2018-03-08 10:30:13,673 [main] INFO  DefaultTestContextBootstrapper  - Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [javax/servlet/ServletContext]
2018-03-08 10:30:13,673 [main] INFO  DefaultTestContextBootstrapper  - Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@3bd69a51, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@36f329e7, org.springframework.test.context.support.DirtiesContextTestExecutionListener@7a11426a, org.springframework.test.context.transaction.TransactionalTestExecutionListener@69c70b62, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@664c0019]
2018-03-08 10:30:13,679 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@392da875: startup date [Thu Mar 08 10:30:13 CET 2018]; root of context hierarchy
2018-03-08 10:30:13,715 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:30:13,743 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-03-08 10:30:13,756 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'default'
2018-03-08 10:30:13,756 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2018-03-08 10:30:13,788 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-03-08 10:30:13,788 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:testdb]
2018-03-08 10:30:13,788 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-03-08 10:30:13,788 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-03-08 10:30:13,788 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
Hibernate: drop table TokenEntry if exists
Hibernate: create table TokenEntry (processorName varchar(255) not null, segment integer not null, owner varchar(255), timestamp varchar(255) not null, token blob(10000), tokenType varchar(255), primary key (processorName, segment))
2018-03-08 10:30:13,824 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@2e3b4394'
2018-03-08 10:30:13,826 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'default'
2018-03-08 10:30:13,865 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@99a8a49, testMethod = testStealToken@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@5d1acb3a]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
2018-03-08 10:30:13,873 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: update TokenEntry set owner=null where owner=? and processorName=? and segment=?
2018-03-08 10:30:13,876 [main] WARN  JpaTokenStore                   - Releasing claim of token stealing/0 failed. It was not owned by local
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
2018-03-08 10:30:13,877 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@99a8a49, testMethod = testStealToken@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
2018-03-08 10:30:13,888 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@5ace2ce3, testMethod = testInitializeTokensWhileAlreadyPresent@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@5d1acb3a]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select tokenentry0_.segment as col_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? order by tokenentry0_.segment ASC
2018-03-08 10:30:13,893 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@5ace2ce3, testMethod = testInitializeTokensWhileAlreadyPresent@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:30:13,894 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@3faadc24, testMethod = testStealingFromOtherThreadFailsWithRowLock@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@5d1acb3a]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
2018-03-08 10:30:14,160 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@3faadc24, testMethod = testStealingFromOtherThreadFailsWithRowLock@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
2018-03-08 10:30:14,166 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@3dcb28de, testMethod = testInitializeTokens@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@5d1acb3a]; rollback [true]
Hibernate: select tokenentry0_.segment as col_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? order by tokenentry0_.segment ASC
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select tokenentry0_.segment as col_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? order by tokenentry0_.segment ASC
2018-03-08 10:30:14,172 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@3dcb28de, testMethod = testInitializeTokens@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:30:14,177 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@64027866, testMethod = testQuerySegments@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@5d1acb3a]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: select tokenentry0_.segment as col_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? order by tokenentry0_.segment ASC
Hibernate: select tokenentry0_.segment as col_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? order by tokenentry0_.segment ASC
Hibernate: select tokenentry0_.segment as col_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? order by tokenentry0_.segment ASC
2018-03-08 10:30:14,191 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@64027866, testMethod = testQuerySegments@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:30:14,193 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@e8f7aa3, testMethod = testClaimTokenConcurrently@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@5d1acb3a]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
2018-03-08 10:30:14,195 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@e8f7aa3, testMethod = testClaimTokenConcurrently@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:30:14,196 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@5802572b, testMethod = testExtendingLostClaimFails@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@5d1acb3a]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: update TokenEntry set timestamp=? where processorName=? and segment=? and owner=?
2018-03-08 10:30:14,200 [main] WARN  SqlExceptionHelper              - SQL Warning Code: -1100, SQLState: 02000
2018-03-08 10:30:14,200 [main] WARN  SqlExceptionHelper              - no data
2018-03-08 10:30:14,200 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@5802572b, testMethod = testExtendingLostClaimFails@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:30:14,201 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@2086dfb8, testMethod = testUpdateNullToken@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@5d1acb3a]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: select tokenentry0_.processorName as processo1_0_, tokenentry0_.segment as segment2_0_, tokenentry0_.owner as owner3_0_, tokenentry0_.timestamp as timestam4_0_, tokenentry0_.token as token5_0_, tokenentry0_.tokenType as tokenTyp6_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=?
2018-03-08 10:30:14,207 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@2086dfb8, testMethod = testUpdateNullToken@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:30:14,208 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@402e48d, testMethod = testClaimAndUpdateToken@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@5d1acb3a]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: select tokenentry0_.processorName as processo1_0_, tokenentry0_.segment as segment2_0_, tokenentry0_.owner as owner3_0_, tokenentry0_.timestamp as timestam4_0_, tokenentry0_.token as token5_0_, tokenentry0_.tokenType as tokenTyp6_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=?
Hibernate: update TokenEntry set owner=null where owner=? and processorName=? and segment=?
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=?
2018-03-08 10:30:14,212 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@79b01476 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@402e48d, testMethod = testClaimAndUpdateToken@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@2739f91b testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.543 sec - in org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest
Running org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest
2018-03-08 10:30:14,218 [main] INFO  AbstractContextLoader           - Could not detect default resource locations for test class [org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest]: no resource found for suffixes {-context.xml}.
2018-03-08 10:30:14,218 [main] INFO  ctDelegatingSmartContextLoader  - AnnotationConfigContextLoader detected default configuration classes for context configuration [ContextConfigurationAttributes@7c95440d declaringClass = 'org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', locations = '{}', inheritLocations = true, initializers = '{}', inheritInitializers = true, name = [null], contextLoaderClass = 'org.springframework.test.context.ContextLoader'].
2018-03-08 10:30:14,219 [main] INFO  DefaultTestContextBootstrapper  - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2018-03-08 10:30:14,220 [main] INFO  DefaultTestContextBootstrapper  - Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [javax/servlet/ServletContext]
2018-03-08 10:30:14,220 [main] INFO  DefaultTestContextBootstrapper  - Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@3d48674, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@24555012, org.springframework.test.context.support.DirtiesContextTestExecutionListener@5b7737eb, org.springframework.test.context.transaction.TransactionalTestExecutionListener@3415ecfe, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@13553b2e]
2018-03-08 10:30:14,221 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@7fa498b3: startup date [Thu Mar 08 10:30:14 CET 2018]; root of context hierarchy
2018-03-08 10:30:14,221 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:14,232 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-03-08 10:30:14,295 [main] WARN  JdbcTokenStore                  - Releasing claim of token stealing/0 failed. It was owned by another node.
2018-03-08 10:30:14,303 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@7ee96c1c testClass = JdbcTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest@195f46f1, testMethod = testInitializeTokensWhileAlreadyPresent@JdbcTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5bdde886 testClass = JdbcTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.jdbc.datasource.DataSourceTransactionManager@2131229e]; rollback [true]
2018-03-08 10:30:14,306 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@7ee96c1c testClass = JdbcTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest@195f46f1, testMethod = testInitializeTokensWhileAlreadyPresent@JdbcTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5bdde886 testClass = JdbcTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:30:14,310 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@7ee96c1c testClass = JdbcTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest@2e138608, testMethod = testInitializeTokens@JdbcTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5bdde886 testClass = JdbcTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.jdbc.datasource.DataSourceTransactionManager@2131229e]; rollback [true]
2018-03-08 10:30:14,312 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@7ee96c1c testClass = JdbcTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest@2e138608, testMethod = testInitializeTokens@JdbcTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5bdde886 testClass = JdbcTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-03-08 10:30:14,313 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@7ee96c1c testClass = JdbcTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest@2438cc7e, testMethod = testQuerySegments@JdbcTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5bdde886 testClass = JdbcTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.jdbc.datasource.DataSourceTransactionManager@2131229e]; rollback [true]
2018-03-08 10:30:14,318 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@7ee96c1c testClass = JdbcTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest@2438cc7e, testMethod = testQuerySegments@JdbcTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5bdde886 testClass = JdbcTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.114 sec - in org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest
Running org.axonframework.eventhandling.SegmentTest
2018-03-08 10:30:15,226 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:16,231 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.325 sec - in org.axonframework.eventhandling.SegmentTest
Running org.axonframework.eventhandling.SimpleEventHandlerInvokerTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec - in org.axonframework.eventhandling.SimpleEventHandlerInvokerTest
Running org.axonframework.eventhandling.AnnotatedParameterResolverFactoryTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.eventhandling.AnnotatedParameterResolverFactoryTest
Running org.axonframework.eventhandling.TrackingEventProcessorTest
2018-03-08 10:30:16,677 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:16,682 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:16,682 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:17,232 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:17,691 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:17,695 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:17,696 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:17,898 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:18,233 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:18,905 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - An error occurred while attempting to claim a token for segment: 0. Will retry later...
java.lang.RuntimeException: Faking a recoverable issue
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.lambda$run$1(TrackingEventProcessor.java:583)
	at org.axonframework.common.transaction.TransactionManager.executeInTransaction(TransactionManager.java:44)
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:583)
	at org.axonframework.eventhandling.TrackingEventProcessor$CountingRunnable.run(TrackingEventProcessor.java:505)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:18,905 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:18,906 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:19,102 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:19,234 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:20,109 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:20,109 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:20,111 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:20,117 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:20,117 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: ReplayToken{currentToken=null, tokenAtReset=IndexTrackingToken{globalIndex=3}} for segment: Segment[0/0]
2018-03-08 10:30:20,120 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:20,234 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:21,126 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Fetch Segments for Processor 'test' failed: Faking issue during fetchSegments. Preparing for retry in 1s
2018-03-08 10:30:21,235 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:22,131 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Fetch Segments for Processor 'test' failed: Faking issue during initializeTokenSegments. Preparing for retry in 1s
2018-03-08 10:30:22,236 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:23,131 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:23,132 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:23,236 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:23,622 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:24,139 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:24,139 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:24,237 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:24,341 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:25,238 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:25,348 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:25,348 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:25,549 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Error occurred. Starting retry mode.
org.axonframework.common.MockException: Mock
2018-03-08 10:30:25,549 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:25,549 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Releasing claim on token and preparing for retry in 1s
2018-03-08 10:30:26,239 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:26,557 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:26,557 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:26,558 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Error occurred. Starting retry mode.
org.axonframework.common.MockException: Mock
2018-03-08 10:30:26,558 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Releasing claim on token and preparing for retry in 1s
2018-03-08 10:30:26,757 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:27,240 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:27,565 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:27,565 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=0} for segment: Segment[0/0]
2018-03-08 10:30:27,764 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:28,241 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:28,573 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:28,573 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:28,775 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:29,242 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:29,779 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:29,781 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:29,781 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:29,982 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:30,243 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:30,987 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:30,993 [EventProcessor[test]-0] ERROR TrackingEventProcessor          - An unrecoverable error has occurred wile attempting to claim a token for segment: 0. Shutting down processor [test].
org.axonframework.serialization.SerializationException: Faking a serialization issue
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.lambda$run$1(TrackingEventProcessor.java:583)
	at org.axonframework.common.transaction.TransactionManager.executeInTransaction(TransactionManager.java:44)
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:583)
	at org.axonframework.eventhandling.TrackingEventProcessor$CountingRunnable.run(TrackingEventProcessor.java:505)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:30,998 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:30,998 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:31,006 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:31,006 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:31,007 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:31,012 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:31,012 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: ReplayToken{currentToken=null, tokenAtReset=GapAwareTrackingToken{index=5, gaps=[3, 4]}} for segment: Segment[0/0]
2018-03-08 10:30:31,014 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:31,017 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:31,017 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:31,021 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Error occurred. Starting retry mode.
org.axonframework.common.MockException: Mock
2018-03-08 10:30:31,021 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Releasing claim on token and preparing for retry in 1s
2018-03-08 10:30:31,243 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:32,022 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:32,024 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:32,251 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:33,030 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:33,030 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:33,231 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:33,252 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:34,238 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:34,238 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:34,253 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:34,439 [Time-limited test] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:34,445 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:34,445 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=1} for segment: Segment[0/0]
2018-03-08 10:30:35,253 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:35,452 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:36,254 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 19, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 19.784 sec - in org.axonframework.eventhandling.TrackingEventProcessorTest
Running org.axonframework.eventhandling.AbstractEventProcessorTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec - in org.axonframework.eventhandling.AbstractEventProcessorTest
Running org.axonframework.eventhandling.DirectEventProcessingStrategyTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventhandling.DirectEventProcessingStrategyTest
Running org.axonframework.eventhandling.ConcludesBatchParameterResolverFactoryTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.eventhandling.ConcludesBatchParameterResolverFactoryTest
Running org.axonframework.eventhandling.SimpleEventBusTest
2018-03-08 10:30:36,462 [main] INFO  AbstractEventBus                - EventProcessor [Mock for Consumer, hashCode: 1860684097] not added. It was already subscribed
2018-03-08 10:30:36,463 [main] INFO  AbstractEventBus                - EventListener Mock for Consumer, hashCode: 1857935745 not removed. It was already unsubscribed
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventhandling.SimpleEventBusTest
Running org.axonframework.eventhandling.ReplayTokenTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventhandling.ReplayTokenTest
Running org.axonframework.eventhandling.TrackingEventProcessorTest_MultiThreaded
2018-03-08 10:30:36,666 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:36,671 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-03-08 10:30:36,675 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-03-08 10:30:36,675 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=1} for segment: Segment[0/1]
2018-03-08 10:30:36,675 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=2} for segment: Segment[1/1]
2018-03-08 10:30:36,676 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:37,255 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:37,696 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:37,700 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=0} for segment: Segment[0/0]
2018-03-08 10:30:37,705 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:38,256 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:38,709 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-03-08 10:30:38,712 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-03-08 10:30:38,713 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/1]
2018-03-08 10:30:38,713 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[1/1]
2018-03-08 10:30:38,721 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:39,257 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:39,724 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-03-08 10:30:39,728 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-03-08 10:30:39,729 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/1]
2018-03-08 10:30:39,729 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[1/1]
2018-03-08 10:30:39,735 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:40,258 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:40,737 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-03-08 10:30:40,737 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=1} for segment: Segment[0/1]
2018-03-08 10:30:40,936 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:41,259 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:41,743 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/3]}
2018-03-08 10:30:41,746 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-03-08 10:30:41,747 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/3]
2018-03-08 10:30:41,747 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[1/1]
2018-03-08 10:30:41,754 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:41,849 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/3]}
2018-03-08 10:30:41,853 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/3]}
2018-03-08 10:30:41,854 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/3]
2018-03-08 10:30:41,854 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[1/3]
2018-03-08 10:30:42,049 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:42,259 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:42,858 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-03-08 10:30:42,858 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:42,862 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Error occurred. Starting retry mode.
org.axonframework.common.MockException: Mock
2018-03-08 10:30:42,862 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Releasing claim on token and preparing for retry in 1s
2018-03-08 10:30:43,260 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:43,866 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-03-08 10:30:43,868 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:44,261 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:44,877 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-03-08 10:30:44,881 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-03-08 10:30:44,881 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/1]
2018-03-08 10:30:44,882 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[1/1]
2018-03-08 10:30:44,889 [Time-limited test] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:45,262 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:45,891 [EventProcessor[test]-3] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-03-08 10:30:45,891 [EventProcessor[test]-3] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-03-08 10:30:45,892 [EventProcessor[test]-4] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=1} for segment: Segment[0/1]
2018-03-08 10:30:45,892 [EventProcessor[test]-5] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=1} for segment: Segment[1/1]
2018-03-08 10:30:45,901 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:46,263 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:46,899 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-03-08 10:30:46,903 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-03-08 10:30:46,904 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/1]
2018-03-08 10:30:46,904 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[1/1]
2018-03-08 10:30:47,098 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:47,263 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:47,910 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/7]}
2018-03-08 10:30:47,914 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/7]}
2018-03-08 10:30:47,914 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/7]
2018-03-08 10:30:47,914 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[2/3]}
2018-03-08 10:30:47,914 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[1/7]
2018-03-08 10:30:47,914 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[3/3]}
2018-03-08 10:30:47,915 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[4/7]}
2018-03-08 10:30:47,915 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[5/7]}
2018-03-08 10:30:47,915 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:47,915 [EventProcessor[test]-3] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[2/3]
2018-03-08 10:30:48,264 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:48,921 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-03-08 10:30:48,925 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-03-08 10:30:48,925 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/1]
2018-03-08 10:30:48,925 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[1/1]
2018-03-08 10:30:48,930 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:49,265 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-03-08 10:30:49,936 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-03-08 10:30:49,940 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-03-08 10:30:49,940 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=1} for segment: Segment[0/1]
2018-03-08 10:30:49,940 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=2} for segment: Segment[1/1]
2018-03-08 10:30:50,153 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-03-08 10:30:50,266 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 14, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 14.677 sec - in org.axonframework.eventhandling.TrackingEventProcessorTest_MultiThreaded
Running org.axonframework.eventhandling.AbstractEventBusTest
Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.056 sec - in org.axonframework.eventhandling.AbstractEventBusTest
Running org.axonframework.messaging.GenericMessageTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.messaging.GenericMessageTest
Running org.axonframework.messaging.interceptors.CorrelationDataInterceptorTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.009 sec - in org.axonframework.messaging.interceptors.CorrelationDataInterceptorTest
Running org.axonframework.messaging.interceptors.TransactionManagingInterceptorTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.messaging.interceptors.TransactionManagingInterceptorTest
Running org.axonframework.messaging.interceptors.LoggingInterceptorTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.027 sec - in org.axonframework.messaging.interceptors.LoggingInterceptorTest
Running org.axonframework.messaging.interceptors.BeanValidationInterceptorTest
2018-03-08 10:30:51,266 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor70.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:223)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:219)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:123)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:161)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.084 sec - in org.axonframework.messaging.interceptors.BeanValidationInterceptorTest
Running org.axonframework.messaging.annotation.MessageIdentifierParameterResolverFactoryTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.messaging.annotation.MessageIdentifierParameterResolverFactoryTest
Running org.axonframework.messaging.annotation.MultiParameterResolverFactoryTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec - in org.axonframework.messaging.annotation.MultiParameterResolverFactoryTest
Running org.axonframework.messaging.annotation.SimpleResourceParameterResolverFactoryTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.messaging.annotation.SimpleResourceParameterResolverFactoryTest
Running org.axonframework.messaging.annotation.HandlerComparatorTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.messaging.annotation.HandlerComparatorTest
Running org.axonframework.messaging.unitofwork.CurrentUnitOfWorkTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.messaging.unitofwork.CurrentUnitOfWorkTest
Running org.axonframework.messaging.unitofwork.AbstractUnitOfWorkTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.016 sec - in org.axonframework.messaging.unitofwork.AbstractUnitOfWorkTest
Running org.axonframework.messaging.unitofwork.RollbackConfigurationTypeTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.messaging.unitofwork.RollbackConfigurationTypeTest
Running org.axonframework.messaging.unitofwork.ExecutionResultTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.messaging.unitofwork.ExecutionResultTest
Running org.axonframework.messaging.unitofwork.UnitOfWorkNestingTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.messaging.unitofwork.UnitOfWorkNestingTest
Running org.axonframework.messaging.unitofwork.BatchingUnitOfWorkTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec - in org.axonframework.messaging.unitofwork.BatchingUnitOfWorkTest
Running org.axonframework.messaging.MetaDataTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.006 sec - in org.axonframework.messaging.MetaDataTest
Running org.axonframework.messaging.DefaultInterceptorChainTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.messaging.DefaultInterceptorChainTest
Running org.axonframework.messaging.correlation.MetaDataValueTest
Tests run: 18, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec - in org.axonframework.messaging.correlation.MetaDataValueTest
Running org.axonframework.messaging.correlation.SimpleCorrelationDataProviderTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.messaging.correlation.SimpleCorrelationDataProviderTest
Running org.axonframework.queryhandling.DefaultQueryGatewayTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec - in org.axonframework.queryhandling.DefaultQueryGatewayTest
Running org.axonframework.queryhandling.responsetypes.MultipleInstancesResponseTypeTest
2018-03-08 10:30:51,392 [main] INFO  MultipleInstancesResponseType   - The given response is an Iterable without any contents, hence we cannot verify if the contained type is assignable to the expected type.
Tests run: 45, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.01 sec - in org.axonframework.queryhandling.responsetypes.MultipleInstancesResponseTypeTest
Running org.axonframework.queryhandling.responsetypes.InstanceResponseTypeTest
Tests run: 35, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.queryhandling.responsetypes.InstanceResponseTypeTest
Running org.axonframework.queryhandling.SimpleQueryBusTest
Tests run: 23, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.025 sec - in org.axonframework.queryhandling.SimpleQueryBusTest
Running org.axonframework.queryhandling.annotation.AnnotationQueryHandlerAdapterTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.013 sec - in org.axonframework.queryhandling.annotation.AnnotationQueryHandlerAdapterTest
Running org.axonframework.monitoring.MultiMessageMonitorTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec - in org.axonframework.monitoring.MultiMessageMonitorTest
2018-03-08 10:30:51,450 [Thread-28] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@178c6261: startup date [Thu Mar 08 10:29:52 CET 2018]; root of context hierarchy
2018-03-08 10:30:51,450 [Thread-17] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@2f01783a: startup date [Thu Mar 08 10:29:47 CET 2018]; root of context hierarchy
2018-03-08 10:30:51,450 [Thread-70] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@7fa498b3: startup date [Thu Mar 08 10:30:14 CET 2018]; root of context hierarchy
2018-03-08 10:30:51,450 [Thread-69] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@392da875: startup date [Thu Mar 08 10:30:13 CET 2018]; root of context hierarchy
2018-03-08 10:30:51,472 [Thread-69] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'default'
2018-03-08 10:30:51,472 [Thread-28] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:51,475 [Thread-17] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-03-08 10:30:51,476 [Thread-69] INFO  pperImpl$DelayedDropActionImpl  - HHH000477: Starting delayed drop of schema as part of SessionFactory shut-down'
Hibernate: drop table TokenEntry if exists
2018-03-08 10:30:51,531 [Thread-69] INFO  connections                     - HHH10001008: Cleaning up connection pool [jdbc:hsqldb:mem:testdb]

Results :

Failed tests: 
  EmbeddedEventStoreTest.testStreamEventsShouldNotReturnDuplicateTokens:226
Tests in error: 
  PessimisticLockFactoryTest.testDeadlockDetected_TwoThreadsInVector:77  TestTimedOut

Tests run: 935, Failures: 1, Errors: 1, Skipped: 0

[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary:
[INFO] 
[INFO] Axon Framework ..................................... SUCCESS [  0.002 s]
[INFO] Axon Framework core ................................ FAILURE [01:30 min]
[INFO] Axon Framework Distributed CommandBus JGroups ...... SKIPPED
[INFO] Axon Framework Spring Support ...................... SKIPPED
[INFO] Axon AMQP .......................................... SKIPPED
[INFO] Axon Framework Distributed CommandBus Spring Cloud . SKIPPED
[INFO] Axon Framework Spring Boot Support ................. SKIPPED
[INFO] Axon Framework Test Fixtures ....................... SKIPPED
[INFO] Axon MongoDB Components ............................ SKIPPED
[INFO] Axon Integration tests ............................. SKIPPED
[INFO] Axon Metrics ....................................... SKIPPED
[INFO] Spring Boot Starter module for Axon Framework ...... SKIPPED
[INFO] Spring Boot Starter module for Axon with JGroups Distributed Command Bus SKIPPED
[INFO] Axon Legacy Components ............................. SKIPPED
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 01:31 min
[INFO] Finished at: 2018-03-08T10:30:51+01:00
[INFO] Final Memory: 52M/1358M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.19.1:test (default-test) on project axon-core: There are test failures.
[ERROR] 
[ERROR] Please refer to /root/workspace/AxonFramework/AxonFramework/350737857/core/target/surefire-reports for the individual test results.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
[ERROR] 
[ERROR] After correcting the problems, you can resume the build with the command
[ERROR]   mvn <goals> -rf :axon-core
