[INFO] Scanning for projects...
[WARNING] 
[WARNING] Some problems were encountered while building the effective model for org.axonframework:axon-integrationtests:jar:3.3-SNAPSHOT
[WARNING] 'dependencies.dependency.systemPath' for com.oracle:ojdbc7:jar should not point at files within the project directory, ${project.basedir}/src/test/binary/ojdbc7.jar will be unresolvable by dependent projects @ org.axonframework:axon-integrationtests:[unknown-version], /root/workspace/AxonFramework/AxonFramework/399202464/integrationtests/pom.xml, line 142, column 25
[WARNING] 
[WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.
[WARNING] 
[WARNING] For this reason, future Maven versions might no longer support building such malformed projects.
[WARNING] 
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Build Order:
[INFO] 
[INFO] Axon Framework
[INFO] Axon Framework core
[INFO] Axon Framework Distributed CommandBus JGroups
[INFO] Axon Framework Spring Support
[INFO] Axon AMQP
[INFO] Axon Kafka
[INFO] Axon Framework Distributed CommandBus Spring Cloud
[INFO] Axon Metrics
[INFO] Axon Framework Spring Boot Support
[INFO] Axon Framework Test Fixtures
[INFO] Axon MongoDB Components
[INFO] Axon Integration tests
[INFO] Spring Boot Starter module for Axon Framework
[INFO] Spring Boot Starter module for Axon with JGroups Distributed Command Bus
[INFO] Axon Legacy Components
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building Axon Framework 3.3-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building Axon Framework core 3.3-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-enforcer-plugin:1.4.1:enforce (enforce-banned-dependencies) @ axon-core ---
[INFO] Skipping Rule Enforcement.
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:resources (default-resources) @ axon-core ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 7 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:compile (default-compile) @ axon-core ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 572 source files to /root/workspace/AxonFramework/AxonFramework/399202464/core/target/classes
[INFO] /root/workspace/AxonFramework/AxonFramework/399202464/core/src/main/java/org/axonframework/messaging/unitofwork/MessageProcessingContext.java: Some input files use unchecked or unsafe operations.
[INFO] /root/workspace/AxonFramework/AxonFramework/399202464/core/src/main/java/org/axonframework/messaging/unitofwork/MessageProcessingContext.java: Recompile with -Xlint:unchecked for details.
[INFO] 
[INFO] --- maven-bundle-plugin:3.3.0:manifest (default) @ axon-core ---
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:testResources (default-testResources) @ axon-core ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 11 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:testCompile (default-testCompile) @ axon-core ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-surefire-plugin:2.19.1:test (default-test) @ axon-core ---
[INFO] Downloading: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19.1/surefire-junit4-2.19.1.pom
[INFO] Downloaded: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19.1/surefire-junit4-2.19.1.pom (4 KB at 8.0 KB/sec)
[INFO] Downloading: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-providers/2.19.1/surefire-providers-2.19.1.pom
[INFO] Downloaded: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-providers/2.19.1/surefire-providers-2.19.1.pom (3 KB at 58.2 KB/sec)
[INFO] Downloading: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19.1/surefire-junit4-2.19.1.jar
[INFO] Downloaded: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19.1/surefire-junit4-2.19.1.jar (74 KB at 389.7 KB/sec)

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.axonframework.messaging.unitofwork.RollbackConfigurationTypeTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.036 sec - in org.axonframework.messaging.unitofwork.RollbackConfigurationTypeTest
Running org.axonframework.messaging.unitofwork.AbstractUnitOfWorkTest
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.842 sec - in org.axonframework.messaging.unitofwork.AbstractUnitOfWorkTest
Running org.axonframework.messaging.unitofwork.ExecutionResultTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.messaging.unitofwork.ExecutionResultTest
Running org.axonframework.messaging.unitofwork.CurrentUnitOfWorkTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.058 sec - in org.axonframework.messaging.unitofwork.CurrentUnitOfWorkTest
Running org.axonframework.messaging.unitofwork.BatchingUnitOfWorkTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.024 sec - in org.axonframework.messaging.unitofwork.BatchingUnitOfWorkTest
Running org.axonframework.messaging.unitofwork.UnitOfWorkNestingTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.01 sec - in org.axonframework.messaging.unitofwork.UnitOfWorkNestingTest
Running org.axonframework.messaging.interceptors.BeanValidationInterceptorTest
2018-07-02 18:24:16,938 [main] INFO  Version                         - HV000001: Hibernate Validator 5.2.4.Final
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.314 sec - in org.axonframework.messaging.interceptors.BeanValidationInterceptorTest
Running org.axonframework.messaging.interceptors.CorrelationDataInterceptorTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.011 sec - in org.axonframework.messaging.interceptors.CorrelationDataInterceptorTest
Running org.axonframework.messaging.interceptors.TransactionManagingInterceptorTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.103 sec - in org.axonframework.messaging.interceptors.TransactionManagingInterceptorTest
Running org.axonframework.messaging.interceptors.LoggingInterceptorTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.121 sec - in org.axonframework.messaging.interceptors.LoggingInterceptorTest
Running org.axonframework.messaging.GenericMessageTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.messaging.GenericMessageTest
Running org.axonframework.messaging.correlation.SimpleCorrelationDataProviderTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.messaging.correlation.SimpleCorrelationDataProviderTest
Running org.axonframework.messaging.correlation.MetaDataValueTest
Tests run: 18, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.016 sec - in org.axonframework.messaging.correlation.MetaDataValueTest
Running org.axonframework.messaging.DefaultInterceptorChainTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.009 sec - in org.axonframework.messaging.DefaultInterceptorChainTest
Running org.axonframework.messaging.annotation.MultiParameterResolverFactoryTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.023 sec - in org.axonframework.messaging.annotation.MultiParameterResolverFactoryTest
Running org.axonframework.messaging.annotation.MessageIdentifierParameterResolverFactoryTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 sec - in org.axonframework.messaging.annotation.MessageIdentifierParameterResolverFactoryTest
Running org.axonframework.messaging.annotation.HandlerComparatorTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 sec - in org.axonframework.messaging.annotation.HandlerComparatorTest
Running org.axonframework.messaging.annotation.SimpleResourceParameterResolverFactoryTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.messaging.annotation.SimpleResourceParameterResolverFactoryTest
Running org.axonframework.messaging.HeadersTests
Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.275 sec - in org.axonframework.messaging.HeadersTests
Running org.axonframework.messaging.MetaDataTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.messaging.MetaDataTest
Running org.axonframework.eventsourcing.eventstore.jpa.SQLErrorCodesResolverTest
Tests run: 12, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.353 sec - in org.axonframework.eventsourcing.eventstore.jpa.SQLErrorCodesResolverTest
Running org.axonframework.eventsourcing.eventstore.jpa.SQLStateResolverTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.eventsourcing.eventstore.jpa.SQLStateResolverTest
Running org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest
2018-07-02 18:24:18,239 [main] INFO  DefaultTestContextBootstrapper  - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2018-07-02 18:24:18,244 [main] INFO  DefaultTestContextBootstrapper  - Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [javax/servlet/ServletContext]
2018-07-02 18:24:18,250 [main] INFO  DefaultTestContextBootstrapper  - Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@31ee2fdb, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@262816a8, org.springframework.test.context.support.DirtiesContextTestExecutionListener@1effd53c, org.springframework.test.context.transaction.TransactionalTestExecutionListener@46c269e0, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@6920614]
2018-07-02 18:24:18,300 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-07-02 18:24:18,595 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@625d9132: startup date [Mon Jul 02 18:24:18 CEST 2018]; root of context hierarchy
2018-07-02 18:24:18,712 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:24:18,838 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-07-02 18:24:18,896 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:18,918 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:24:19,014 [main] INFO  Version                         - HHH000412: Hibernate Core {5.1.0.Final}
2018-07-02 18:24:19,015 [main] INFO  Environment                     - HHH000206: hibernate.properties not found
2018-07-02 18:24:19,016 [main] INFO  Environment                     - HHH000021: Bytecode provider name : javassist
2018-07-02 18:24:19,058 [main] INFO  Version                         - HCANN000001: Hibernate Commons Annotations {5.0.1.Final}
2018-07-02 18:24:19,604 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:24:20,336 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: AssociationValueEntry
2018-07-02 18:24:20,343 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: AssociationValueEntry
2018-07-02 18:24:20,349 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: CustomDomainEventEntry
2018-07-02 18:24:20,350 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: CustomDomainEventEntry
2018-07-02 18:24:20,355 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: CustomSagaEntry
2018-07-02 18:24:20,355 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: CustomSagaEntry
2018-07-02 18:24:20,359 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: CustomSnapshotEventEntry
2018-07-02 18:24:20,360 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: CustomSnapshotEventEntry
2018-07-02 18:24:20,365 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: DomainEventEntry
2018-07-02 18:24:20,366 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: DomainEventEntry
2018-07-02 18:24:20,371 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: JpaAggregate
2018-07-02 18:24:20,371 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: JpaAggregate
2018-07-02 18:24:20,375 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: SagaEntry
2018-07-02 18:24:20,375 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: SagaEntry
2018-07-02 18:24:20,378 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: SnapshotEventEntry
2018-07-02 18:24:20,379 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: SnapshotEventEntry
2018-07-02 18:24:20,382 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: StubAggregate
2018-07-02 18:24:20,383 [main] INFO  ractorJdbcDatabaseMetaDataImpl  - HHH000262: Table not found: StubAggregate
2018-07-02 18:24:20,536 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:20,769 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@3e2c4d4b, testMethod = testStoreTwoExactSameSnapshots@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@1aed6f0b]; rollback [true]
2018-07-02 18:24:20,791 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-07-02 18:24:20,949 [main] WARN  SqlExceptionHelper              - SQL Warning Code: -1100, SQLState: 02000
2018-07-02 18:24:20,949 [main] WARN  SqlExceptionHelper              - no data
2018-07-02 18:24:20,949 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@3e2c4d4b, testMethod = testStoreTwoExactSameSnapshots@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:20,952 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@8debe42, testMethod = testEventsWithUnknownPayloadTypeAreSkipped@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@1aed6f0b]; rollback [true]
2018-07-02 18:24:21,056 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@8debe42, testMethod = testEventsWithUnknownPayloadTypeAreSkipped@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:21,059 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@149b53fa, testMethod = testStoreEventsWithCustomEntity@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@1aed6f0b]; rollback [true]
2018-07-02 18:24:21,119 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@149b53fa, testMethod = testStoreEventsWithCustomEntity@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:21,119 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@625d9132: startup date [Mon Jul 02 18:24:18 CEST 2018]; root of context hierarchy
2018-07-02 18:24:21,120 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:21,121 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-07-02 18:24:21,158 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@7be7c052: startup date [Mon Jul 02 18:24:21 CEST 2018]; root of context hierarchy
2018-07-02 18:24:21,169 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:24:21,196 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-07-02 18:24:21,200 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:21,200 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:24:21,266 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:24:21,424 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:21,446 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@5b5b8730, testMethod = testStoreAndLoadEventsFromDatastore@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@878feb2]; rollback [true]
2018-07-02 18:24:21,450 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-07-02 18:24:21,471 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@5b5b8730, testMethod = testStoreAndLoadEventsFromDatastore@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:21,474 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@5cdda548, testMethod = testLoadLastSequenceNumber@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@878feb2]; rollback [true]
2018-07-02 18:24:21,491 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@5cdda548, testMethod = testLoadLastSequenceNumber@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:21,493 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@47d9c01, testMethod = testOldGapsAreRemovedFromProvidedTrackingToken@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@878feb2]; rollback [true]
2018-07-02 18:24:21,536 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@47d9c01, testMethod = testOldGapsAreRemovedFromProvidedTrackingToken@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:21,537 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@7be7c052: startup date [Mon Jul 02 18:24:21 CEST 2018]; root of context hierarchy
2018-07-02 18:24:21,537 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:21,538 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-07-02 18:24:21,559 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@f01fc6d: startup date [Mon Jul 02 18:24:21 CEST 2018]; root of context hierarchy
2018-07-02 18:24:21,568 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:24:21,592 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-07-02 18:24:21,596 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:21,596 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:24:21,670 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:24:21,801 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:21,821 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@54ae1240, testMethod = testGapsForVeryOldEventsAreNotIncluded@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3c62f69a]; rollback [true]
2018-07-02 18:24:21,824 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-07-02 18:24:21,862 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@54ae1240, testMethod = testGapsForVeryOldEventsAreNotIncluded@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:21,864 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@5c703860, testMethod = testUnknownSerializedTypeCausesException@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3c62f69a]; rollback [true]
2018-07-02 18:24:21,879 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@5c703860, testMethod = testUnknownSerializedTypeCausesException@JpaEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:21,881 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@1a77eb6, testMethod = testLoad_LargeAmountOfEvents@BatchingEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3c62f69a]; rollback [true]
2018-07-02 18:24:22,118 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@1a77eb6, testMethod = testLoad_LargeAmountOfEvents@BatchingEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:22,120 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:22,122 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@1df32c09, testMethod = testStoreDuplicateEventWithoutExceptionResolver@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3c62f69a]; rollback [true]
2018-07-02 18:24:22,136 [main] WARN  SqlExceptionHelper              - SQL Error: -104, SQLState: 23505
2018-07-02 18:24:22,136 [main] ERROR SqlExceptionHelper              - integrity constraint violation: unique constraint or index violation; UKDG43IA27YPO1JOVW2X64VBWV8 table: DOMAINEVENTENTRY
2018-07-02 18:24:22,139 [main] INFO  AbstractBatchImpl               - HHH000010: On release of batch it still contained JDBC statements
2018-07-02 18:24:22,141 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@1df32c09, testMethod = testStoreDuplicateEventWithoutExceptionResolver@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:22,141 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@f01fc6d: startup date [Mon Jul 02 18:24:21 CEST 2018]; root of context hierarchy
2018-07-02 18:24:22,142 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:22,143 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-07-02 18:24:22,164 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@6068cda1: startup date [Mon Jul 02 18:24:22 CEST 2018]; root of context hierarchy
2018-07-02 18:24:22,174 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:24:22,198 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-07-02 18:24:22,203 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:22,203 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:24:22,253 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:24:22,378 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:22,398 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@e3692ca, testMethod = testStoreDuplicateEventWithExceptionTranslator@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@5265a8dd]; rollback [true]
2018-07-02 18:24:22,403 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-07-02 18:24:22,410 [main] WARN  SqlExceptionHelper              - SQL Error: -104, SQLState: 23505
2018-07-02 18:24:22,410 [main] ERROR SqlExceptionHelper              - integrity constraint violation: unique constraint or index violation; UKDG43IA27YPO1JOVW2X64VBWV8 table: DOMAINEVENTENTRY
2018-07-02 18:24:22,410 [main] INFO  AbstractBatchImpl               - HHH000010: On release of batch it still contained JDBC statements
2018-07-02 18:24:22,411 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@e3692ca, testMethod = testStoreDuplicateEventWithExceptionTranslator@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:22,411 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@6068cda1: startup date [Mon Jul 02 18:24:22 CEST 2018]; root of context hierarchy
2018-07-02 18:24:22,412 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:22,413 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-07-02 18:24:22,432 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@3ce7a354: startup date [Mon Jul 02 18:24:22 CEST 2018]; root of context hierarchy
2018-07-02 18:24:22,441 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:24:22,463 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-07-02 18:24:22,467 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:22,467 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:24:22,509 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:24:22,610 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:22,630 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@34065642, testMethod = testStoreAndLoadEventsWithUpcaster@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@4c0bfe9e]; rollback [true]
2018-07-02 18:24:22,634 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-07-02 18:24:22,667 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@34065642, testMethod = testStoreAndLoadEventsWithUpcaster@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:22,667 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@3ce7a354: startup date [Mon Jul 02 18:24:22 CEST 2018]; root of context hierarchy
2018-07-02 18:24:22,667 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:22,668 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-07-02 18:24:22,685 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@28b68067: startup date [Mon Jul 02 18:24:22 CEST 2018]; root of context hierarchy
2018-07-02 18:24:22,693 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:24:22,717 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-07-02 18:24:22,721 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:22,721 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:24:22,765 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:24:22,885 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:22,911 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@7aef8000, testMethod = testUniqueKeyConstraintOnEventIdentifier@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@523f3c29]; rollback [true]
2018-07-02 18:24:22,915 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-07-02 18:24:22,920 [main] WARN  SqlExceptionHelper              - SQL Error: -104, SQLState: 23505
2018-07-02 18:24:22,920 [main] ERROR SqlExceptionHelper              - integrity constraint violation: unique constraint or index violation; UK_K5LT6D2792AMNLOO7Q91NJP0V table: DOMAINEVENTENTRY
2018-07-02 18:24:22,921 [main] INFO  AbstractBatchImpl               - HHH000010: On release of batch it still contained JDBC statements
2018-07-02 18:24:22,921 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@7aef8000, testMethod = testUniqueKeyConstraintOnEventIdentifier@AbstractEventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:22,922 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@28b68067: startup date [Mon Jul 02 18:24:22 CEST 2018]; root of context hierarchy
2018-07-02 18:24:22,922 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:22,923 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-07-02 18:24:22,941 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@346e5cc: startup date [Mon Jul 02 18:24:22 CEST 2018]; root of context hierarchy
2018-07-02 18:24:22,951 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:24:22,978 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-07-02 18:24:22,983 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:22,984 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:24:23,054 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:24:23,124 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:23,174 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:23,197 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@4a0ee0ba, testMethod = testCreateTokenAtExactTime@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@60688a97]; rollback [true]
2018-07-02 18:24:23,202 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-07-02 18:24:23,229 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@4a0ee0ba, testMethod = testCreateTokenAtExactTime@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:23,232 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@71b32407, testMethod = testCreateHeadToken@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@60688a97]; rollback [true]
2018-07-02 18:24:23,248 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@71b32407, testMethod = testCreateHeadToken@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:23,251 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@47fce2c4, testMethod = testCreateTailToken@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@60688a97]; rollback [true]
2018-07-02 18:24:23,265 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@47fce2c4, testMethod = testCreateTailToken@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:23,267 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@16602333, testMethod = testLoadNonExistent@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@60688a97]; rollback [true]
2018-07-02 18:24:23,276 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@16602333, testMethod = testLoadNonExistent@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:23,277 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@c7a1db6, testMethod = testCreateTokenAt@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@60688a97]; rollback [true]
2018-07-02 18:24:23,289 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@c7a1db6, testMethod = testCreateTokenAt@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:23,291 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@79454d8e, testMethod = testLoadPartialStreamOfTrackedEvents@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@60688a97]; rollback [true]
2018-07-02 18:24:23,340 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@79454d8e, testMethod = testLoadPartialStreamOfTrackedEvents@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:23,342 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@58c16efd, testMethod = testStoreAndLoadEvents@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@60688a97]; rollback [true]
2018-07-02 18:24:23,356 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@58c16efd, testMethod = testStoreAndLoadEvents@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:23,358 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@4a490518, testMethod = testCreateTokenWithUnorderedEvents@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@60688a97]; rollback [true]
2018-07-02 18:24:23,369 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@4a490518, testMethod = testCreateTokenWithUnorderedEvents@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:23,371 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@ecb8b3e, testMethod = testReturnedEventMessageBehavior@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@60688a97]; rollback [true]
2018-07-02 18:24:23,380 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@ecb8b3e, testMethod = testReturnedEventMessageBehavior@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:23,381 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@40239b34, testMethod = testReadPartialStream@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@60688a97]; rollback [true]
2018-07-02 18:24:23,394 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@40239b34, testMethod = testReadPartialStream@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:23,396 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@477906cf, testMethod = testLoadTrackedEvents@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@60688a97]; rollback [true]
2018-07-02 18:24:23,436 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@477906cf, testMethod = testLoadTrackedEvents@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:23,439 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@35e3f3b8, testMethod = testStoreAndLoadEventsArray@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@60688a97]; rollback [true]
2018-07-02 18:24:23,447 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@35e3f3b8, testMethod = testStoreAndLoadEventsArray@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:23,449 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@4be1c797, testMethod = testStoreAndLoadApplicationEvent@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@60688a97]; rollback [true]
2018-07-02 18:24:23,468 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@4be1c797, testMethod = testStoreAndLoadApplicationEvent@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:23,470 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@6f071d0c, testMethod = testStoreAndLoadSnapshot@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@60688a97]; rollback [true]
2018-07-02 18:24:23,483 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@780129bc testClass = JpaEventStorageEngineTest, testInstance = org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest@6f071d0c, testMethod = testStoreAndLoadSnapshot@EventStorageEngineTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5ca22e19 testClass = JpaEventStorageEngineTest, locations = '{classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
Tests run: 27, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 5.316 sec - in org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngineTest
Running org.axonframework.eventsourcing.eventstore.jpa.DomainEventEntryTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.eventsourcing.eventstore.jpa.DomainEventEntryTest
Running org.axonframework.eventsourcing.eventstore.GapAwareTrackingTokenTest
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.009 sec - in org.axonframework.eventsourcing.eventstore.GapAwareTrackingTokenTest
Running org.axonframework.eventsourcing.eventstore.GlobalSequenceTrackingTokenTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventsourcing.eventstore.GlobalSequenceTrackingTokenTest
Running org.axonframework.eventsourcing.eventstore.TrackingTokenSerializationTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.296 sec - in org.axonframework.eventsourcing.eventstore.TrackingTokenSerializationTest
Running org.axonframework.eventsourcing.eventstore.EqualRevisionPredicateTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.013 sec - in org.axonframework.eventsourcing.eventstore.EqualRevisionPredicateTest
Running org.axonframework.eventsourcing.eventstore.jdbc.MysqlJdbcEventStorageEngineTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 1, Time elapsed: 0.139 sec - in org.axonframework.eventsourcing.eventstore.jdbc.MysqlJdbcEventStorageEngineTest
Running org.axonframework.eventsourcing.eventstore.jdbc.JdbcEventStorageEngineTest
2018-07-02 18:24:24,125 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 27, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.408 sec - in org.axonframework.eventsourcing.eventstore.jdbc.JdbcEventStorageEngineTest
Running org.axonframework.eventsourcing.eventstore.TrackingTokenParameterResolverFactoryTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventsourcing.eventstore.TrackingTokenParameterResolverFactoryTest
Running org.axonframework.eventsourcing.eventstore.ConcatenatingDomainEventStreamTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 sec - in org.axonframework.eventsourcing.eventstore.ConcatenatingDomainEventStreamTest
Running org.axonframework.eventsourcing.eventstore.inmemory.InMemoryEventStorageEngineTest
Tests run: 14, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.026 sec - in org.axonframework.eventsourcing.eventstore.inmemory.InMemoryEventStorageEngineTest
Running org.axonframework.eventsourcing.eventstore.EmbeddedEventStoreTest
2018-07-02 18:24:24,643 [main] WARN  AbstractEventStore              - Error reading snapshot for aggregate [aggregate]. Reconstructing from entire event stream.
org.axonframework.common.MockException: Mock
2018-07-02 18:24:25,126 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:25,261 [EmbeddedEventStore-1] WARN  EmbeddedEventStore              - An event processor fell behind the tail end of the event store cache. This usually indicates a badly performing event processor.
Tests run: 15, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.946 sec - in org.axonframework.eventsourcing.eventstore.EmbeddedEventStoreTest
Running org.axonframework.eventsourcing.eventstore.FilteringDomainEventStreamTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.eventsourcing.eventstore.FilteringDomainEventStreamTest
Running org.axonframework.eventsourcing.eventstore.EventUtilsTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.016 sec - in org.axonframework.eventsourcing.eventstore.EventUtilsTest
Running org.axonframework.eventsourcing.eventstore.SequenceEventStorageEngineTest
Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.03 sec - in org.axonframework.eventsourcing.eventstore.SequenceEventStorageEngineTest
Running org.axonframework.eventsourcing.AggregateSnapshotterTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.066 sec - in org.axonframework.eventsourcing.AggregateSnapshotterTest
Running org.axonframework.eventsourcing.FilteringEventStorageEngineTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.eventsourcing.FilteringEventStorageEngineTest
Running org.axonframework.eventsourcing.NoSnapshotTriggerDefinitionTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventsourcing.NoSnapshotTriggerDefinitionTest
Running org.axonframework.eventsourcing.GenericAggregateFactoryTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventsourcing.GenericAggregateFactoryTest
Running org.axonframework.eventsourcing.DomainEventStreamTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventsourcing.DomainEventStreamTest
Running org.axonframework.eventsourcing.AbstractSnapshotterTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.111 sec - in org.axonframework.eventsourcing.AbstractSnapshotterTest
Running org.axonframework.eventsourcing.CachingEventSourcingRepositoryTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.472 sec - in org.axonframework.eventsourcing.CachingEventSourcingRepositoryTest
Running org.axonframework.eventsourcing.NestedUnitOfWorkTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.061 sec - in org.axonframework.eventsourcing.NestedUnitOfWorkTest
Running org.axonframework.eventsourcing.CachingRepositoryWithNestedUnitOfWorkTest
2018-07-02 18:24:26,127 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.058 sec - in org.axonframework.eventsourcing.CachingRepositoryWithNestedUnitOfWorkTest
Running org.axonframework.eventsourcing.EventCountSnapshotTriggerDefinitionTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.011 sec - in org.axonframework.eventsourcing.EventCountSnapshotTriggerDefinitionTest
Running org.axonframework.eventsourcing.EventSourcingRepositoryTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.022 sec - in org.axonframework.eventsourcing.EventSourcingRepositoryTest
Running org.axonframework.eventsourcing.GenericDomainEventMessageTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventsourcing.GenericDomainEventMessageTest
Running org.axonframework.eventsourcing.EventSourcingRepositoryIntegrationTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.037 sec - in org.axonframework.eventsourcing.EventSourcingRepositoryIntegrationTest
Running org.axonframework.commandhandling.AggregateAnnotationCommandHandlerTest
2018-07-02 18:24:26,337 [main] INFO  LoggingCallback                 - Command executed successfully: org.axonframework.commandhandling.AggregateAnnotationCommandHandlerTest$CreateCommand
2018-07-02 18:24:26,370 [main] INFO  LoggingCallback                 - Command executed successfully: org.axonframework.commandhandling.AggregateAnnotationCommandHandlerTest$CreateFactoryMethodCommand
Tests run: 22, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.185 sec - in org.axonframework.commandhandling.AggregateAnnotationCommandHandlerTest
Running org.axonframework.commandhandling.callbacks.VoidCallbackTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.commandhandling.callbacks.VoidCallbackTest
Running org.axonframework.commandhandling.callbacks.FutureCallbackTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.commandhandling.callbacks.FutureCallbackTest
Running org.axonframework.commandhandling.model.AnnotatedAggregateTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 sec - in org.axonframework.commandhandling.model.AnnotatedAggregateTest
Running org.axonframework.commandhandling.model.AggregateScopeDescriptorSerializationTest
<org.axonframework.commandhandling.model.AggregateScopeDescriptor serialization="custom"><org.axonframework.commandhandling.model.AggregateScopeDescriptor><default><identifier class="string">identifier</identifier><type>aggregateType</type></default></org.axonframework.commandhandling.model.AggregateScopeDescriptor></org.axonframework.commandhandling.model.AggregateScopeDescriptor>
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.016 sec - in org.axonframework.commandhandling.model.AggregateScopeDescriptorSerializationTest
Running org.axonframework.commandhandling.model.AbstractRepositoryTest
Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.065 sec - in org.axonframework.commandhandling.model.AbstractRepositoryTest
Running org.axonframework.commandhandling.model.LockingRepositoryTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.062 sec - in org.axonframework.commandhandling.model.LockingRepositoryTest
Running org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest
2018-07-02 18:24:26,595 [main] INFO  DefaultTestContextBootstrapper  - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2018-07-02 18:24:26,596 [main] INFO  DefaultTestContextBootstrapper  - Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [javax/servlet/ServletContext]
2018-07-02 18:24:26,596 [main] INFO  DefaultTestContextBootstrapper  - Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@62604ed4, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@1bfc6e50, org.springframework.test.context.support.DirtiesContextTestExecutionListener@4f74edbf, org.springframework.test.context.transaction.TransactionalTestExecutionListener@3c1f2651, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@5ce9c9e8]
2018-07-02 18:24:26,596 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/jpa-repository-context.xml]
2018-07-02 18:24:26,607 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-07-02 18:24:26,626 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@249fa2cb: startup date [Mon Jul 02 18:24:26 CEST 2018]; root of context hierarchy
2018-07-02 18:24:26,644 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:24:26,678 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-07-02 18:24:26,683 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:26,683 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:24:26,724 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:24:26,839 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:24:26,839 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:26,913 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@73ae084e testClass = JpaRepositoryIntegrationTest, testInstance = org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest@363a1d8d, testMethod = testUpdateAnAggregate@JpaRepositoryIntegrationTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5c91b751 testClass = JpaRepositoryIntegrationTest, locations = '{classpath:/META-INF/spring/jpa-repository-context.xml, classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@7ed0e5db]; rollback [true]
2018-07-02 18:24:26,924 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@73ae084e testClass = JpaRepositoryIntegrationTest, testInstance = org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest@363a1d8d, testMethod = testUpdateAnAggregate@JpaRepositoryIntegrationTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5c91b751 testClass = JpaRepositoryIntegrationTest, locations = '{classpath:/META-INF/spring/jpa-repository-context.xml, classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:26,925 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@73ae084e testClass = JpaRepositoryIntegrationTest, testInstance = org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest@1201c2f6, testMethod = testStoreAndLoadNewAggregate@JpaRepositoryIntegrationTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5c91b751 testClass = JpaRepositoryIntegrationTest, locations = '{classpath:/META-INF/spring/jpa-repository-context.xml, classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@7ed0e5db]; rollback [true]
2018-07-02 18:24:26,927 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-07-02 18:24:26,930 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@73ae084e testClass = JpaRepositoryIntegrationTest, testInstance = org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest@1201c2f6, testMethod = testStoreAndLoadNewAggregate@JpaRepositoryIntegrationTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5c91b751 testClass = JpaRepositoryIntegrationTest, locations = '{classpath:/META-INF/spring/jpa-repository-context.xml, classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:26,932 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@73ae084e testClass = JpaRepositoryIntegrationTest, testInstance = org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest@3bfbe2a6, testMethod = testDeleteAnAggregate@JpaRepositoryIntegrationTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5c91b751 testClass = JpaRepositoryIntegrationTest, locations = '{classpath:/META-INF/spring/jpa-repository-context.xml, classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@7ed0e5db]; rollback [true]
2018-07-02 18:24:26,939 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@73ae084e testClass = JpaRepositoryIntegrationTest, testInstance = org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest@3bfbe2a6, testMethod = testDeleteAnAggregate@JpaRepositoryIntegrationTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@5c91b751 testClass = JpaRepositoryIntegrationTest, locations = '{classpath:/META-INF/spring/jpa-repository-context.xml, classpath:/META-INF/spring/db-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.348 sec - in org.axonframework.commandhandling.model.JpaRepositoryIntegrationTest
Running org.axonframework.commandhandling.model.GenericJpaRepositoryTest
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.053 sec - in org.axonframework.commandhandling.model.GenericJpaRepositoryTest
Running org.axonframework.commandhandling.model.inspection.AnnotatedAggregateMetaModelFactoryTest
Tests run: 15, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.025 sec - in org.axonframework.commandhandling.model.inspection.AnnotatedAggregateMetaModelFactoryTest
Running org.axonframework.commandhandling.model.inspection.ModelInspectorTest
Tests run: 14, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.019 sec - in org.axonframework.commandhandling.model.inspection.ModelInspectorTest
Running org.axonframework.commandhandling.model.EventSourcingRepositoryTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 sec - in org.axonframework.commandhandling.model.EventSourcingRepositoryTest
Running org.axonframework.commandhandling.model.EntityEventForwardingModelInspectorTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.011 sec - in org.axonframework.commandhandling.model.EntityEventForwardingModelInspectorTest
Running org.axonframework.commandhandling.disruptor.DisruptorRepositoryTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.029 sec - in org.axonframework.commandhandling.disruptor.DisruptorRepositoryTest
Running org.axonframework.commandhandling.disruptor.DisruptorConfigurationTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.commandhandling.disruptor.DisruptorConfigurationTest
Running org.axonframework.commandhandling.disruptor.DisruptorCommandBusTest
2018-07-02 18:24:27,129 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:28,137 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:29,138 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:29,165 [pool-1-thread-4] INFO  DisruptorCommandBus             - Reset notification for 148d7afc-1aff-42c3-87cd-3decf83965cb received. The aggregate is removed from the blacklist
2018-07-02 18:24:29,180 [pool-1-thread-4] INFO  DisruptorCommandBus             - Reset notification for 148d7afc-1aff-42c3-87cd-3decf83965cb received. The aggregate is removed from the blacklist
2018-07-02 18:24:29,194 [pool-1-thread-4] INFO  DisruptorCommandBus             - Reset notification for 148d7afc-1aff-42c3-87cd-3decf83965cb received. The aggregate is removed from the blacklist
2018-07-02 18:24:29,206 [pool-1-thread-4] INFO  DisruptorCommandBus             - Reset notification for 148d7afc-1aff-42c3-87cd-3decf83965cb received. The aggregate is removed from the blacklist
2018-07-02 18:24:29,215 [pool-1-thread-4] INFO  DisruptorCommandBus             - Reset notification for 148d7afc-1aff-42c3-87cd-3decf83965cb received. The aggregate is removed from the blacklist
2018-07-02 18:24:29,225 [pool-1-thread-4] INFO  DisruptorCommandBus             - Reset notification for 148d7afc-1aff-42c3-87cd-3decf83965cb received. The aggregate is removed from the blacklist
2018-07-02 18:24:29,233 [pool-1-thread-4] INFO  DisruptorCommandBus             - Reset notification for 148d7afc-1aff-42c3-87cd-3decf83965cb received. The aggregate is removed from the blacklist
2018-07-02 18:24:29,240 [pool-1-thread-4] INFO  DisruptorCommandBus             - Reset notification for 148d7afc-1aff-42c3-87cd-3decf83965cb received. The aggregate is removed from the blacklist
2018-07-02 18:24:29,247 [pool-1-thread-4] INFO  DisruptorCommandBus             - Reset notification for 148d7afc-1aff-42c3-87cd-3decf83965cb received. The aggregate is removed from the blacklist
2018-07-02 18:24:29,253 [pool-1-thread-4] INFO  DisruptorCommandBus             - Reset notification for 148d7afc-1aff-42c3-87cd-3decf83965cb received. The aggregate is removed from the blacklist
2018-07-02 18:24:30,139 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:30,518 [DisruptorCommandBus-6] INFO  DisruptorCommandBus             - An error occurred while handling a command [org.axonframework.commandhandling.disruptor.DisruptorCommandBusTest$ErrorCommand].
org.axonframework.common.MockException: This is a failing event. EventStore refuses to store that
2018-07-02 18:24:30,519 [DisruptorCommandBus-3] INFO  DisruptorCommandBus             - An error occurred while handling a command [org.axonframework.commandhandling.disruptor.DisruptorCommandBusTest$ErrorCommand].
org.axonframework.common.MockException: This is a failing event. EventStore refuses to store that
2018-07-02 18:24:30,519 [DisruptorCommandBus-1] INFO  DisruptorCommandBus             - Reset notification for 0e48eb1f-e10b-44b0-8ac8-c7fe310ff752 received. The aggregate is removed from the blacklist
2018-07-02 18:24:30,519 [DisruptorCommandBus-1] INFO  DisruptorCommandBus             - Reset notification for bbff8317-f6a2-4d29-940a-c03e0e98ee7a received. The aggregate is removed from the blacklist
2018-07-02 18:24:31,140 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:32,141 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:33,142 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:33,805 [pool-3-thread-4] INFO  DisruptorCommandBus             - Reset notification for 0422b13b-32b8-4e29-8b7d-67dfcc328798 received. The aggregate is removed from the blacklist
2018-07-02 18:24:33,813 [pool-3-thread-4] INFO  DisruptorCommandBus             - Reset notification for 0422b13b-32b8-4e29-8b7d-67dfcc328798 received. The aggregate is removed from the blacklist
2018-07-02 18:24:33,824 [pool-3-thread-4] INFO  DisruptorCommandBus             - Reset notification for 0422b13b-32b8-4e29-8b7d-67dfcc328798 received. The aggregate is removed from the blacklist
2018-07-02 18:24:33,834 [pool-3-thread-4] INFO  DisruptorCommandBus             - Reset notification for 0422b13b-32b8-4e29-8b7d-67dfcc328798 received. The aggregate is removed from the blacklist
2018-07-02 18:24:33,842 [pool-3-thread-4] INFO  DisruptorCommandBus             - Reset notification for 0422b13b-32b8-4e29-8b7d-67dfcc328798 received. The aggregate is removed from the blacklist
2018-07-02 18:24:33,854 [pool-3-thread-4] INFO  DisruptorCommandBus             - Reset notification for 0422b13b-32b8-4e29-8b7d-67dfcc328798 received. The aggregate is removed from the blacklist
2018-07-02 18:24:33,859 [pool-3-thread-4] INFO  DisruptorCommandBus             - Reset notification for 0422b13b-32b8-4e29-8b7d-67dfcc328798 received. The aggregate is removed from the blacklist
2018-07-02 18:24:33,865 [pool-3-thread-4] INFO  DisruptorCommandBus             - Reset notification for 0422b13b-32b8-4e29-8b7d-67dfcc328798 received. The aggregate is removed from the blacklist
2018-07-02 18:24:33,870 [pool-3-thread-4] INFO  DisruptorCommandBus             - Reset notification for 0422b13b-32b8-4e29-8b7d-67dfcc328798 received. The aggregate is removed from the blacklist
2018-07-02 18:24:33,875 [pool-3-thread-4] INFO  DisruptorCommandBus             - Reset notification for 0422b13b-32b8-4e29-8b7d-67dfcc328798 received. The aggregate is removed from the blacklist
2018-07-02 18:24:34,144 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:35,145 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:36,146 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:36,430 [DisruptorCommandBus-1] INFO  DisruptorCommandBus             - Reset notification for 28cd4dab-e470-45c8-8b7c-3a17e8c090a8 received. The aggregate is removed from the blacklist
2018-07-02 18:24:36,430 [DisruptorCommandBus-2] WARN  DisruptorCommandBus             - Failed sending message [GenericDeadlineMessage{payload={org.axonframework.commandhandling.disruptor.DisruptorCommandBusTest$FailingEvent@6bba2c51}, metadata={}, messageIdentifier='6895ba2d-c87a-4e06-a515-a0401c8b4e50', timestamp='2018-07-02T16:24:36.430Z}] to aggregate with id [28cd4dab-e470-45c8-8b7c-3a17e8c090a8]
2018-07-02 18:24:37,147 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:38,148 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:39,149 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:40,151 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:41,153 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:42,156 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:43,158 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:43,185 [pool-6-thread-5] INFO  DisruptorCommandBus             - Reset notification for c270f0b4-3c27-4453-8c86-657acc45f248 received. The aggregate is removed from the blacklist
2018-07-02 18:24:43,193 [pool-6-thread-5] INFO  DisruptorCommandBus             - Reset notification for c270f0b4-3c27-4453-8c86-657acc45f248 received. The aggregate is removed from the blacklist
2018-07-02 18:24:43,201 [pool-6-thread-5] INFO  DisruptorCommandBus             - Reset notification for c270f0b4-3c27-4453-8c86-657acc45f248 received. The aggregate is removed from the blacklist
2018-07-02 18:24:43,210 [pool-6-thread-5] INFO  DisruptorCommandBus             - Reset notification for c270f0b4-3c27-4453-8c86-657acc45f248 received. The aggregate is removed from the blacklist
2018-07-02 18:24:43,221 [pool-6-thread-5] INFO  DisruptorCommandBus             - Reset notification for c270f0b4-3c27-4453-8c86-657acc45f248 received. The aggregate is removed from the blacklist
2018-07-02 18:24:43,229 [pool-6-thread-5] INFO  DisruptorCommandBus             - Reset notification for c270f0b4-3c27-4453-8c86-657acc45f248 received. The aggregate is removed from the blacklist
2018-07-02 18:24:43,243 [pool-6-thread-5] INFO  DisruptorCommandBus             - Reset notification for c270f0b4-3c27-4453-8c86-657acc45f248 received. The aggregate is removed from the blacklist
2018-07-02 18:24:43,276 [pool-6-thread-5] INFO  DisruptorCommandBus             - Reset notification for c270f0b4-3c27-4453-8c86-657acc45f248 received. The aggregate is removed from the blacklist
2018-07-02 18:24:43,283 [pool-6-thread-5] INFO  DisruptorCommandBus             - Reset notification for c270f0b4-3c27-4453-8c86-657acc45f248 received. The aggregate is removed from the blacklist
2018-07-02 18:24:43,306 [pool-6-thread-5] INFO  DisruptorCommandBus             - Reset notification for c270f0b4-3c27-4453-8c86-657acc45f248 received. The aggregate is removed from the blacklist
2018-07-02 18:24:44,160 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:45,160 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:46,161 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 17, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 19.481 sec - in org.axonframework.commandhandling.disruptor.DisruptorCommandBusTest
Running org.axonframework.commandhandling.disruptor.CommandHandlerInvokerTest
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.044 sec - in org.axonframework.commandhandling.disruptor.CommandHandlerInvokerTest
Running org.axonframework.commandhandling.disruptor.DisruptorCommandBusTest_MultiThreaded
2018-07-02 18:24:46,667 [DisruptorCommandBus-4] INFO  DisruptorCommandBus             - Reset notification for ca1a2c47-c031-4922-8004-02e739c744c2 received. The aggregate is removed from the blacklist
2018-07-02 18:24:46,667 [DisruptorCommandBus-2] INFO  DisruptorCommandBus             - Reset notification for 3f6d24f4-3f5e-4e8d-bbc4-b93f00de58c4 received. The aggregate is removed from the blacklist
2018-07-02 18:24:46,667 [DisruptorCommandBus-3] INFO  DisruptorCommandBus             - Reset notification for 9c743e89-37d0-44cd-8fb1-ee25bf64af2a received. The aggregate is removed from the blacklist
2018-07-02 18:24:46,668 [DisruptorCommandBus-4] INFO  DisruptorCommandBus             - Reset notification for 2cb981f5-6927-492a-8b26-5d778f404912 received. The aggregate is removed from the blacklist
2018-07-02 18:24:46,671 [DisruptorCommandBus-2] INFO  DisruptorCommandBus             - Reset notification for f6aebbff-e550-47e5-a2ec-102c2714446d received. The aggregate is removed from the blacklist
2018-07-02 18:24:46,671 [DisruptorCommandBus-3] INFO  DisruptorCommandBus             - Reset notification for eb8dbeb6-b5f8-402e-b34a-698e5ccb1d51 received. The aggregate is removed from the blacklist
2018-07-02 18:24:46,671 [DisruptorCommandBus-3] INFO  DisruptorCommandBus             - Reset notification for 6323c2ad-fdd0-43e7-aa6d-a81a4add8959 received. The aggregate is removed from the blacklist
2018-07-02 18:24:46,671 [DisruptorCommandBus-4] INFO  DisruptorCommandBus             - Reset notification for c0af6d35-2aff-431c-8305-cd8aa22db3eb received. The aggregate is removed from the blacklist
2018-07-02 18:24:46,673 [DisruptorCommandBus-3] INFO  DisruptorCommandBus             - Reset notification for e2237712-72e2-4b1e-9482-013d8dedd33c received. The aggregate is removed from the blacklist
2018-07-02 18:24:46,674 [DisruptorCommandBus-2] INFO  DisruptorCommandBus             - Reset notification for 4e9b557a-129e-4ab4-97c8-a483d73f68de received. The aggregate is removed from the blacklist
2018-07-02 18:24:47,162 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.1 sec - in org.axonframework.commandhandling.disruptor.DisruptorCommandBusTest_MultiThreaded
Running org.axonframework.commandhandling.conflictresolution.DefaultConflictResolverTest
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 sec - in org.axonframework.commandhandling.conflictresolution.DefaultConflictResolverTest
Running org.axonframework.commandhandling.conflictresolution.ConflictResolutionIntegrationTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.014 sec - in org.axonframework.commandhandling.conflictresolution.ConflictResolutionIntegrationTest
Running org.axonframework.commandhandling.conflictresolution.ConflictResolutionTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 sec - in org.axonframework.commandhandling.conflictresolution.ConflictResolutionTest
Running org.axonframework.commandhandling.conflictresolution.ConflictsTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.commandhandling.conflictresolution.ConflictsTest
Running org.axonframework.commandhandling.SpawningNewAggregateTest
2018-07-02 18:24:47,792 [main] INFO  LoggingCallback                 - Command executed successfully: org.axonframework.commandhandling.SpawningNewAggregateTest$CreateAggregate1Command
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.042 sec - in org.axonframework.commandhandling.SpawningNewAggregateTest
Running org.axonframework.commandhandling.distributed.ConsistentHashTest
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.013 sec - in org.axonframework.commandhandling.distributed.ConsistentHashTest
Running org.axonframework.commandhandling.distributed.commandfilter.CommandFilterTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 sec - in org.axonframework.commandhandling.distributed.commandfilter.CommandFilterTest
Running org.axonframework.commandhandling.distributed.CommandCallbackRepositoryTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.commandhandling.distributed.CommandCallbackRepositoryTest
Running org.axonframework.commandhandling.distributed.AnnotationRoutingStrategyTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec - in org.axonframework.commandhandling.distributed.AnnotationRoutingStrategyTest
Running org.axonframework.commandhandling.distributed.DistributedCommandBusTest
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.041 sec - in org.axonframework.commandhandling.distributed.DistributedCommandBusTest
Running org.axonframework.commandhandling.CommandHandlerInterceptorTest
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.065 sec - in org.axonframework.commandhandling.CommandHandlerInterceptorTest
Running org.axonframework.commandhandling.CurrentUnitOfWorkParameterResolverFactoryTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.056 sec - in org.axonframework.commandhandling.CurrentUnitOfWorkParameterResolverFactoryTest
Running org.axonframework.commandhandling.gateway.DefaultCommandGatewayTest
2018-07-02 18:24:48,021 [main] WARN  DefaultCommandGateway           - Command 'java.lang.String' resulted in java.lang.RuntimeException(java.lang.RuntimeException)
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.041 sec - in org.axonframework.commandhandling.gateway.DefaultCommandGatewayTest
Running org.axonframework.commandhandling.gateway.CommandGatewayFactoryTest
Tests run: 30, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.073 sec - in org.axonframework.commandhandling.gateway.CommandGatewayFactoryTest
Running org.axonframework.commandhandling.AnnotationCommandHandlerAdapterTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.037 sec - in org.axonframework.commandhandling.AnnotationCommandHandlerAdapterTest
Running org.axonframework.commandhandling.SimpleCommandBusTest
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 sec - in org.axonframework.commandhandling.SimpleCommandBusTest
Running org.axonframework.commandhandling.AnnotationCommandTargetResolverTest
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 sec - in org.axonframework.commandhandling.AnnotationCommandTargetResolverTest
Running org.axonframework.commandhandling.AsynchronousCommandBusTest
2018-07-02 18:24:48,163 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:48,174 [main] INFO  LoggingCallback                 - Command executed successfully: java.lang.Object
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.02 sec - in org.axonframework.commandhandling.AsynchronousCommandBusTest
Running org.axonframework.commandhandling.GenericCommandMessageTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.commandhandling.GenericCommandMessageTest
Running org.axonframework.commandhandling.CommandHandlingTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.commandhandling.CommandHandlingTest
Running org.axonframework.common.AssertTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.common.AssertTest
Running org.axonframework.common.property.UniformPropertyAccessStrategyTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.common.property.UniformPropertyAccessStrategyTest
Running org.axonframework.common.property.PropertyAccessStrategyTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.common.property.PropertyAccessStrategyTest
Running org.axonframework.common.property.DirectPropertyAccessStrategyTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.common.property.DirectPropertyAccessStrategyTest
Running org.axonframework.common.property.BeanPropertyAccessStrategyTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.common.property.BeanPropertyAccessStrategyTest
Running org.axonframework.common.lock.PessimisticLockFactoryTest
2018-07-02 18:24:49,164 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.409 sec - in org.axonframework.common.lock.PessimisticLockFactoryTest
Running org.axonframework.common.lock.LockFactoryTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.023 sec - in org.axonframework.common.lock.LockFactoryTest
Running org.axonframework.common.IdentifierValidatorTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.common.IdentifierValidatorTest
Running org.axonframework.common.annotation.PriorityAnnotationComparatorTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.004 sec - in org.axonframework.common.annotation.PriorityAnnotationComparatorTest
Running org.axonframework.common.annotation.AnnotationUtilsTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec - in org.axonframework.common.annotation.AnnotationUtilsTest
Running org.axonframework.common.caching.WeakReferenceCacheTest
2018-07-02 18:24:50,164 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.651 sec - in org.axonframework.common.caching.WeakReferenceCacheTest
Running org.axonframework.common.caching.NoCacheTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.common.caching.NoCacheTest
Running org.axonframework.common.ReflectionUtilsTest
Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 sec - in org.axonframework.common.ReflectionUtilsTest
Running org.axonframework.common.AxonThreadFactoryTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.common.AxonThreadFactoryTest
Running org.axonframework.common.CollectionUtilsTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.common.CollectionUtilsTest
Running org.axonframework.common.jdbc.ConnectionWrapperFactoryTest
Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.028 sec - in org.axonframework.common.jdbc.ConnectionWrapperFactoryTest
Running org.axonframework.common.jdbc.JdbcUtilsTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.177 sec - in org.axonframework.common.jdbc.JdbcUtilsTest
Running org.axonframework.common.DateTimeUtilsTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.common.DateTimeUtilsTest
Running org.axonframework.eventhandling.saga.repository.LockingSagaRepositoryTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.032 sec - in org.axonframework.eventhandling.saga.repository.LockingSagaRepositoryTest
Running org.axonframework.eventhandling.saga.repository.AssociationValueMapTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.053 sec - in org.axonframework.eventhandling.saga.repository.AssociationValueMapTest
Running org.axonframework.eventhandling.saga.repository.jdbc.JdbcSagaStoreTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.08 sec - in org.axonframework.eventhandling.saga.repository.jdbc.JdbcSagaStoreTest
Running org.axonframework.eventhandling.saga.repository.CachingSagaStoreTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.08 sec - in org.axonframework.eventhandling.saga.repository.CachingSagaStoreTest
Running org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest
2018-07-02 18:24:50,763 [main] INFO  DefaultTestContextBootstrapper  - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2018-07-02 18:24:50,764 [main] INFO  DefaultTestContextBootstrapper  - Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [javax/servlet/ServletContext]
2018-07-02 18:24:50,764 [main] INFO  DefaultTestContextBootstrapper  - Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@7c4c091a, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@7960e87a, org.springframework.test.context.support.DirtiesContextTestExecutionListener@3be4e71c, org.springframework.test.context.transaction.TransactionalTestExecutionListener@83b0d9f, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@14a3d15b]
2018-07-02 18:24:50,764 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/saga-repository-test.xml]
2018-07-02 18:24:50,779 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-07-02 18:24:50,794 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@6afed88d: startup date [Mon Jul 02 18:24:50 CEST 2018]; root of context hierarchy
2018-07-02 18:24:50,803 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:24:50,824 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-07-02 18:24:50,828 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:50,829 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:24:50,870 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:24:50,967 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:24:50,967 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:50,999 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@8922006 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@3d5a6aca, testMethod = testEndSaga@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@1972346b testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@2a4edf0b]; rollback [true]
2018-07-02 18:24:51,008 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-07-02 18:24:51,093 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@8922006 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@3d5a6aca, testMethod = testEndSaga@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@1972346b testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:51,093 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@6afed88d: startup date [Mon Jul 02 18:24:50 CEST 2018]; root of context hierarchy
2018-07-02 18:24:51,094 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:51,095 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/saga-repository-test.xml]
2018-07-02 18:24:51,138 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-07-02 18:24:51,148 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@4a729612: startup date [Mon Jul 02 18:24:51 CEST 2018]; root of context hierarchy
2018-07-02 18:24:51,159 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:24:51,165 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:51,182 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-07-02 18:24:51,185 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:51,186 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:24:51,252 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:24:51,381 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:24:51,381 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:51,400 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@8922006 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@2e138608, testMethod = testAddingAnInactiveSagaDoesntStoreIt@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@1972346b testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@39c8101c]; rollback [true]
2018-07-02 18:24:51,402 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-07-02 18:24:51,418 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@8922006 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@2e138608, testMethod = testAddingAnInactiveSagaDoesntStoreIt@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@1972346b testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:51,418 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@4a729612: startup date [Mon Jul 02 18:24:51 CEST 2018]; root of context hierarchy
2018-07-02 18:24:51,419 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:51,419 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/saga-repository-test.xml]
2018-07-02 18:24:51,431 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-07-02 18:24:51,442 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@2ba0948f: startup date [Mon Jul 02 18:24:51 CEST 2018]; root of context hierarchy
2018-07-02 18:24:51,449 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:24:51,473 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-07-02 18:24:51,476 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:51,476 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:24:51,521 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:24:51,609 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:24:51,609 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:51,627 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@8922006 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@f7dc1aa, testMethod = testLoadSaga_AssociationValueRemoved@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@1972346b testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@5ec5a449]; rollback [true]
2018-07-02 18:24:51,630 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-07-02 18:24:51,650 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@8922006 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@f7dc1aa, testMethod = testLoadSaga_AssociationValueRemoved@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@1972346b testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:51,650 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@2ba0948f: startup date [Mon Jul 02 18:24:51 CEST 2018]; root of context hierarchy
2018-07-02 18:24:51,650 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:51,651 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/saga-repository-test.xml]
2018-07-02 18:24:51,662 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-07-02 18:24:51,671 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@bd074d7: startup date [Mon Jul 02 18:24:51 CEST 2018]; root of context hierarchy
2018-07-02 18:24:51,678 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:24:51,698 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-07-02 18:24:51,702 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:51,702 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:24:51,748 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:24:51,833 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:24:51,833 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:51,849 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@8922006 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@276d3d00, testMethod = testStoreSagaWithCustomEntity@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@1972346b testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@7356f0e0]; rollback [true]
2018-07-02 18:24:51,851 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-07-02 18:24:51,877 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@8922006 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@276d3d00, testMethod = testStoreSagaWithCustomEntity@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@1972346b testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:51,878 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@bd074d7: startup date [Mon Jul 02 18:24:51 CEST 2018]; root of context hierarchy
2018-07-02 18:24:51,878 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:51,879 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/saga-repository-test.xml]
2018-07-02 18:24:51,890 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-07-02 18:24:51,901 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@8b62702: startup date [Mon Jul 02 18:24:51 CEST 2018]; root of context hierarchy
2018-07-02 18:24:51,910 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:24:51,937 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-07-02 18:24:51,940 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:51,940 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:24:51,987 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:24:52,080 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:24:52,080 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:52,099 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@8922006 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@7e3e1b7b, testMethod = testAddAndLoadSaga_ByAssociationValue@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@1972346b testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@58178c5e]; rollback [true]
2018-07-02 18:24:52,101 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-07-02 18:24:52,119 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@8922006 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@7e3e1b7b, testMethod = testAddAndLoadSaga_ByAssociationValue@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@1972346b testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:52,119 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@8b62702: startup date [Mon Jul 02 18:24:51 CEST 2018]; root of context hierarchy
2018-07-02 18:24:52,120 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:52,120 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/saga-repository-test.xml]
2018-07-02 18:24:52,132 [main] INFO  XmlBeanDefinitionReader         - Loading XML bean definitions from class path resource [META-INF/spring/db-context.xml]
2018-07-02 18:24:52,142 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@1c078424: startup date [Mon Jul 02 18:24:52 CEST 2018]; root of context hierarchy
2018-07-02 18:24:52,149 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:24:52,166 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:52,179 [main] INFO  DriverManagerDataSource         - Loaded JDBC driver: org.hsqldb.jdbcDriver
2018-07-02 18:24:52,182 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:52,182 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:24:52,230 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:24:52,357 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:24:52,358 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:24:52,389 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@8922006 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@59ea8f1b, testMethod = testAddAndLoadSaga_ByIdentifier@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@1972346b testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@7393a461]; rollback [true]
2018-07-02 18:24:52,394 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-07-02 18:24:52,431 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@8922006 testClass = JpaSagaStoreTest, testInstance = org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest@59ea8f1b, testMethod = testAddAndLoadSaga_ByIdentifier@JpaSagaStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@1972346b testClass = JpaSagaStoreTest, locations = '{classpath:/META-INF/spring/saga-repository-test.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:24:52,432 [main] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@1c078424: startup date [Mon Jul 02 18:24:52 CEST 2018]; root of context hierarchy
2018-07-02 18:24:52,432 [main] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.673 sec - in org.axonframework.eventhandling.saga.repository.jpa.JpaSagaStoreTest
Running org.axonframework.eventhandling.saga.repository.AnnotatedSagaRepositoryTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 sec - in org.axonframework.eventhandling.saga.repository.AnnotatedSagaRepositoryTest
Running org.axonframework.eventhandling.saga.metamodel.AnnotationSagaMetaModelFactoryTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.012 sec - in org.axonframework.eventhandling.saga.metamodel.AnnotationSagaMetaModelFactoryTest
Running org.axonframework.eventhandling.saga.SagaManagerTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.021 sec - in org.axonframework.eventhandling.saga.SagaManagerTest
Running org.axonframework.eventhandling.saga.AssociationValuesImplTest
Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventhandling.saga.AssociationValuesImplTest
Running org.axonframework.eventhandling.saga.SimpleResourceInjectorTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec - in org.axonframework.eventhandling.saga.SimpleResourceInjectorTest
Running org.axonframework.eventhandling.saga.AnnotatedSagaManagerTest
Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.064 sec - in org.axonframework.eventhandling.saga.AnnotatedSagaManagerTest
Running org.axonframework.eventhandling.saga.AnnotatedSagaTest
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 sec - in org.axonframework.eventhandling.saga.AnnotatedSagaTest
Running org.axonframework.eventhandling.async.SequentialPolicyTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventhandling.async.SequentialPolicyTest
Running org.axonframework.eventhandling.async.SequentialPerAggregatePolicyTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventhandling.async.SequentialPerAggregatePolicyTest
Running org.axonframework.eventhandling.async.AsynchronousEventProcessingStrategyTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 sec - in org.axonframework.eventhandling.async.AsynchronousEventProcessingStrategyTest
Running org.axonframework.eventhandling.async.AsynchronousEventProcessorConcurrencyTest
2018-07-02 18:24:53,167 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:54,174 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:55,175 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:56,176 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 3.951 sec - in org.axonframework.eventhandling.async.AsynchronousEventProcessorConcurrencyTest
Running org.axonframework.eventhandling.async.FullConcurrencyPolicyTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.eventhandling.async.FullConcurrencyPolicyTest
Running org.axonframework.eventhandling.AbstractEventBusTest
Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.036 sec - in org.axonframework.eventhandling.AbstractEventBusTest
Running org.axonframework.eventhandling.AbstractEventProcessorTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.009 sec - in org.axonframework.eventhandling.AbstractEventProcessorTest
Running org.axonframework.eventhandling.SegmentTest
2018-07-02 18:24:57,177 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:58,178 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.401 sec - in org.axonframework.eventhandling.SegmentTest
Running org.axonframework.eventhandling.AnnotatedParameterResolverFactoryTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.eventhandling.AnnotatedParameterResolverFactoryTest
Running org.axonframework.eventhandling.scheduling.quartz.QuartzEventSchedulerTest
2018-07-02 18:24:59,008 [main] INFO  StdSchedulerFactory             - Using default implementation for ThreadExecutor
2018-07-02 18:24:59,011 [main] INFO  SimpleThreadPool                - Job execution threads will use class loader of thread: main
2018-07-02 18:24:59,024 [main] INFO  SchedulerSignalerImpl           - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2018-07-02 18:24:59,024 [main] INFO  QuartzScheduler                 - Quartz Scheduler v.2.2.1 created.
2018-07-02 18:24:59,025 [main] INFO  RAMJobStore                     - RAMJobStore initialized.
2018-07-02 18:24:59,026 [main] INFO  QuartzScheduler                 - Scheduler meta-data: Quartz Scheduler (v2.2.1) 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

2018-07-02 18:24:59,026 [main] INFO  StdSchedulerFactory             - Quartz scheduler 'DefaultQuartzScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
2018-07-02 18:24:59,026 [main] INFO  StdSchedulerFactory             - Quartz scheduler version: 2.2.1
2018-07-02 18:24:59,026 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-07-02 18:24:59,074 [DefaultQuartzScheduler_Worker-1] INFO  FireEventJob                    - Job successfully executed. Scheduled Event [StubEvent] has been published.
2018-07-02 18:24:59,077 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutting down.
2018-07-02 18:24:59,077 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED paused.
2018-07-02 18:24:59,178 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:24:59,518 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutdown complete.
2018-07-02 18:24:59,521 [main] INFO  StdSchedulerFactory             - Using default implementation for ThreadExecutor
2018-07-02 18:24:59,521 [main] INFO  SimpleThreadPool                - Job execution threads will use class loader of thread: main
2018-07-02 18:24:59,522 [main] INFO  SchedulerSignalerImpl           - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2018-07-02 18:24:59,522 [main] INFO  QuartzScheduler                 - Quartz Scheduler v.2.2.1 created.
2018-07-02 18:24:59,523 [main] INFO  RAMJobStore                     - RAMJobStore initialized.
2018-07-02 18:24:59,523 [main] INFO  QuartzScheduler                 - Scheduler meta-data: Quartz Scheduler (v2.2.1) 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

2018-07-02 18:24:59,523 [main] INFO  StdSchedulerFactory             - Quartz scheduler 'DefaultQuartzScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
2018-07-02 18:24:59,523 [main] INFO  StdSchedulerFactory             - Quartz scheduler version: 2.2.1
2018-07-02 18:24:59,523 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-07-02 18:24:59,564 [DefaultQuartzScheduler_Worker-1] ERROR FireEventJob                    - Exception occurred while publishing scheduled event [org.axonframework.eventhandling.scheduling.quartz.QuartzEventSchedulerTest$StubEvent]
org.axonframework.common.MockException: Mock
2018-07-02 18:24:59,570 [DefaultQuartzScheduler_Worker-1] INFO  JobRunShell                     - Job TestGroup.event-0796ebc2-9a23-426f-9609-e8b3233f44da threw a JobExecutionException: 
org.quartz.JobExecutionException: org.axonframework.common.MockException: Mock [See nested exception: org.axonframework.common.MockException: Mock]
	at org.axonframework.eventhandling.scheduling.quartz.FireEventJob.execute(FireEventJob.java:87)
	at org.quartz.core.JobRunShell.run(JobRunShell.java:202)
	at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)
Caused by: org.axonframework.common.MockException: Mock
2018-07-02 18:24:59,570 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutting down.
2018-07-02 18:24:59,570 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED paused.
2018-07-02 18:25:00,035 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutdown complete.
2018-07-02 18:25:00,039 [main] INFO  StdSchedulerFactory             - Using default implementation for ThreadExecutor
2018-07-02 18:25:00,039 [main] INFO  SimpleThreadPool                - Job execution threads will use class loader of thread: main
2018-07-02 18:25:00,040 [main] INFO  SchedulerSignalerImpl           - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2018-07-02 18:25:00,040 [main] INFO  QuartzScheduler                 - Quartz Scheduler v.2.2.1 created.
2018-07-02 18:25:00,040 [main] INFO  RAMJobStore                     - RAMJobStore initialized.
2018-07-02 18:25:00,040 [main] INFO  QuartzScheduler                 - Scheduler meta-data: Quartz Scheduler (v2.2.1) 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

2018-07-02 18:25:00,040 [main] INFO  StdSchedulerFactory             - Quartz scheduler 'DefaultQuartzScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
2018-07-02 18:25:00,040 [main] INFO  StdSchedulerFactory             - Quartz scheduler version: 2.2.1
2018-07-02 18:25:00,040 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-07-02 18:25:00,079 [DefaultQuartzScheduler_Worker-1] INFO  FireEventJob                    - Job successfully executed. Scheduled Event [StubEvent] has been published.
2018-07-02 18:25:00,085 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutting down.
2018-07-02 18:25:00,085 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED paused.
2018-07-02 18:25:00,179 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:00,585 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutdown complete.
2018-07-02 18:25:00,589 [main] INFO  StdSchedulerFactory             - Using default implementation for ThreadExecutor
2018-07-02 18:25:00,589 [main] INFO  SimpleThreadPool                - Job execution threads will use class loader of thread: main
2018-07-02 18:25:00,590 [main] INFO  SchedulerSignalerImpl           - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2018-07-02 18:25:00,590 [main] INFO  QuartzScheduler                 - Quartz Scheduler v.2.2.1 created.
2018-07-02 18:25:00,590 [main] INFO  RAMJobStore                     - RAMJobStore initialized.
2018-07-02 18:25:00,591 [main] INFO  QuartzScheduler                 - Scheduler meta-data: Quartz Scheduler (v2.2.1) 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

2018-07-02 18:25:00,591 [main] INFO  StdSchedulerFactory             - Quartz scheduler 'DefaultQuartzScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
2018-07-02 18:25:00,591 [main] INFO  StdSchedulerFactory             - Quartz scheduler version: 2.2.1
2018-07-02 18:25:00,591 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-07-02 18:25:00,595 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutting down.
2018-07-02 18:25:00,595 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED paused.
2018-07-02 18:25:01,101 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED shutdown complete.
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.125 sec - in org.axonframework.eventhandling.scheduling.quartz.QuartzEventSchedulerTest
Running org.axonframework.eventhandling.scheduling.ScheduleTokenJacksonSerializationTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.015 sec - in org.axonframework.eventhandling.scheduling.ScheduleTokenJacksonSerializationTest
Running org.axonframework.eventhandling.scheduling.java.SimpleEventSchedulerTest
2018-07-02 18:25:01,180 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.158 sec - in org.axonframework.eventhandling.scheduling.java.SimpleEventSchedulerTest
Running org.axonframework.eventhandling.SimpleEventHandlerInvokerTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.eventhandling.SimpleEventHandlerInvokerTest
Running org.axonframework.eventhandling.replay.ReplayParameterResolverFactoryTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.eventhandling.replay.ReplayParameterResolverFactoryTest
Running org.axonframework.eventhandling.replay.ReplayAwareMessageHandlerWrapperTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.eventhandling.replay.ReplayAwareMessageHandlerWrapperTest
Running org.axonframework.eventhandling.TimestampParameterResolverFactoryTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventhandling.TimestampParameterResolverFactoryTest
Running org.axonframework.eventhandling.tokenstore.inmemory.InMemoryTokenStoreTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.011 sec - in org.axonframework.eventhandling.tokenstore.inmemory.InMemoryTokenStoreTest
Running org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest
2018-07-02 18:25:01,307 [main] INFO  AbstractContextLoader           - Could not detect default resource locations for test class [org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest]: no resource found for suffixes {-context.xml}.
2018-07-02 18:25:01,309 [main] INFO  ctDelegatingSmartContextLoader  - AnnotationConfigContextLoader detected default configuration classes for context configuration [ContextConfigurationAttributes@29323270 declaringClass = 'org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', locations = '{}', inheritLocations = true, initializers = '{}', inheritInitializers = true, name = [null], contextLoaderClass = 'org.springframework.test.context.ContextLoader'].
2018-07-02 18:25:01,310 [main] INFO  DefaultTestContextBootstrapper  - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2018-07-02 18:25:01,311 [main] INFO  DefaultTestContextBootstrapper  - Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [javax/servlet/ServletContext]
2018-07-02 18:25:01,311 [main] INFO  DefaultTestContextBootstrapper  - Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@1eb08757, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@4bcb5415, org.springframework.test.context.support.DirtiesContextTestExecutionListener@177aef4f, org.springframework.test.context.transaction.TransactionalTestExecutionListener@61f94cac, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@7be9e5fb]
2018-07-02 18:25:01,319 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@2ad3e7e5: startup date [Mon Jul 02 18:25:01 CEST 2018]; root of context hierarchy
2018-07-02 18:25:01,354 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:25:01,458 [main] WARN  JdbcTokenStore                  - Releasing claim of token stealing/0 failed. It was owned by another node.
2018-07-02 18:25:01,468 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@5db94eaf testClass = JdbcTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest@15bb7acd, testMethod = testInitializeTokensWhileAlreadyPresent@JdbcTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@60d46bd7 testClass = JdbcTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.jdbc.datasource.DataSourceTransactionManager@1ea83b58]; rollback [true]
2018-07-02 18:25:01,472 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@5db94eaf testClass = JdbcTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest@15bb7acd, testMethod = testInitializeTokensWhileAlreadyPresent@JdbcTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@60d46bd7 testClass = JdbcTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:25:01,475 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@5db94eaf testClass = JdbcTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest@44f2d195, testMethod = testInitializeTokens@JdbcTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@60d46bd7 testClass = JdbcTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.jdbc.datasource.DataSourceTransactionManager@1ea83b58]; rollback [true]
2018-07-02 18:25:01,478 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@5db94eaf testClass = JdbcTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest@44f2d195, testMethod = testInitializeTokens@JdbcTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@60d46bd7 testClass = JdbcTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:25:01,478 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@5db94eaf testClass = JdbcTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest@61c3b31c, testMethod = testQuerySegments@JdbcTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@60d46bd7 testClass = JdbcTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.jdbc.datasource.DataSourceTransactionManager@1ea83b58]; rollback [true]
2018-07-02 18:25:01,483 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@5db94eaf testClass = JdbcTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest@61c3b31c, testMethod = testQuerySegments@JdbcTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@60d46bd7 testClass = JdbcTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:25:01,492 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@5db94eaf testClass = JdbcTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest@2a6e710e, testMethod = testInitializeTokensAtGivenPosition@JdbcTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@60d46bd7 testClass = JdbcTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.jdbc.datasource.DataSourceTransactionManager@1ea83b58]; rollback [true]
2018-07-02 18:25:01,504 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@5db94eaf testClass = JdbcTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest@2a6e710e, testMethod = testInitializeTokensAtGivenPosition@JdbcTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@60d46bd7 testClass = JdbcTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.207 sec - in org.axonframework.eventhandling.tokenstore.jdbc.JdbcTokenStoreTest
Running org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest
2018-07-02 18:25:01,515 [main] INFO  AbstractContextLoader           - Could not detect default resource locations for test class [org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest]: no resource found for suffixes {-context.xml}.
2018-07-02 18:25:01,516 [main] INFO  ctDelegatingSmartContextLoader  - AnnotationConfigContextLoader detected default configuration classes for context configuration [ContextConfigurationAttributes@2591343 declaringClass = 'org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', locations = '{}', inheritLocations = true, initializers = '{}', inheritInitializers = true, name = [null], contextLoaderClass = 'org.springframework.test.context.ContextLoader'].
2018-07-02 18:25:01,517 [main] INFO  DefaultTestContextBootstrapper  - Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener]
2018-07-02 18:25:01,518 [main] INFO  DefaultTestContextBootstrapper  - Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [javax/servlet/ServletContext]
2018-07-02 18:25:01,518 [main] INFO  DefaultTestContextBootstrapper  - Using TestExecutionListeners: [org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@36ebd261, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@70fd1f5c, org.springframework.test.context.support.DirtiesContextTestExecutionListener@7b7eb8c, org.springframework.test.context.transaction.TransactionalTestExecutionListener@26d443e3, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@4e44f582]
2018-07-02 18:25:01,519 [main] INFO  GenericApplicationContext       - Refreshing org.springframework.context.support.GenericApplicationContext@6e886e25: startup date [Mon Jul 02 18:25:01 CEST 2018]; root of context hierarchy
2018-07-02 18:25:01,526 [main] INFO  redAnnotationBeanPostProcessor  - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
2018-07-02 18:25:01,543 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:25:01,556 [main] INFO  tainerEntityManagerFactoryBean  - Building JPA container EntityManagerFactory for persistence unit 'default'
2018-07-02 18:25:01,557 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: default
	...]
2018-07-02 18:25:01,598 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-07-02 18:25:01,599 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:testdb]
2018-07-02 18:25:01,599 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-07-02 18:25:01,599 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-07-02 18:25:01,601 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
Hibernate: drop table TokenEntry if exists
Hibernate: create table TokenEntry (processorName varchar(255) not null, segment integer not null, owner varchar(255), timestamp varchar(255) not null, token blob(10000), tokenType varchar(255), primary key (processorName, segment))
2018-07-02 18:25:01,637 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@1b53e1ae'
2018-07-02 18:25:01,641 [main] INFO  tainerEntityManagerFactoryBean  - Initialized JPA EntityManagerFactory for persistence unit 'default'
2018-07-02 18:25:01,673 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@495b3b23, testMethod = testStealToken@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3b85a820]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
2018-07-02 18:25:01,677 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: update TokenEntry set owner=null where owner=? and processorName=? and segment=?
2018-07-02 18:25:01,680 [main] WARN  JpaTokenStore                   - Releasing claim of token stealing/0 failed. It was not owned by local
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
2018-07-02 18:25:01,681 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@495b3b23, testMethod = testStealToken@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
2018-07-02 18:25:01,693 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@4e4892bf, testMethod = testInitializeTokensWhileAlreadyPresent@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3b85a820]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select tokenentry0_.segment as col_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? order by tokenentry0_.segment ASC
2018-07-02 18:25:01,700 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@4e4892bf, testMethod = testInitializeTokensWhileAlreadyPresent@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:25:01,701 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@6bd721e1, testMethod = testStealingFromOtherThreadFailsWithRowLock@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3b85a820]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
2018-07-02 18:25:01,977 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@6bd721e1, testMethod = testStealingFromOtherThreadFailsWithRowLock@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
2018-07-02 18:25:01,982 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@49efc5ba, testMethod = testInitializeTokens@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3b85a820]; rollback [true]
Hibernate: select tokenentry0_.segment as col_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? order by tokenentry0_.segment ASC
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select tokenentry0_.segment as col_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? order by tokenentry0_.segment ASC
2018-07-02 18:25:01,986 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@49efc5ba, testMethod = testInitializeTokens@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:25:01,990 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@47cdae47, testMethod = testQuerySegments@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3b85a820]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: select tokenentry0_.segment as col_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? order by tokenentry0_.segment ASC
Hibernate: select tokenentry0_.segment as col_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? order by tokenentry0_.segment ASC
Hibernate: select tokenentry0_.segment as col_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? order by tokenentry0_.segment ASC
2018-07-02 18:25:02,003 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@47cdae47, testMethod = testQuerySegments@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:25:02,005 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@25b33665, testMethod = testClaimTokenConcurrently@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3b85a820]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
2018-07-02 18:25:02,006 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@25b33665, testMethod = testClaimTokenConcurrently@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:25:02,007 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@3b8f7c0b, testMethod = testExtendingLostClaimFails@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3b85a820]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: update TokenEntry set timestamp=? where processorName=? and segment=? and owner=?
2018-07-02 18:25:02,011 [main] WARN  SqlExceptionHelper              - SQL Warning Code: -1100, SQLState: 02000
2018-07-02 18:25:02,011 [main] WARN  SqlExceptionHelper              - no data
2018-07-02 18:25:02,011 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@3b8f7c0b, testMethod = testExtendingLostClaimFails@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:25:02,012 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@4cb15553, testMethod = testUpdateNullToken@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3b85a820]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: select tokenentry0_.processorName as processo1_0_, tokenentry0_.segment as segment2_0_, tokenentry0_.owner as owner3_0_, tokenentry0_.timestamp as timestam4_0_, tokenentry0_.token as token5_0_, tokenentry0_.tokenType as tokenTyp6_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=?
2018-07-02 18:25:02,021 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@4cb15553, testMethod = testUpdateNullToken@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:25:02,022 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@3b24595e, testMethod = testInitializeTokensAtGivenPosition@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3b85a820]; rollback [true]
Hibernate: select tokenentry0_.segment as col_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? order by tokenentry0_.segment ASC
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select tokenentry0_.segment as col_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? order by tokenentry0_.segment ASC
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
2018-07-02 18:25:02,042 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@3b24595e, testMethod = testInitializeTokensAtGivenPosition@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
2018-07-02 18:25:02,043 [main] INFO  TransactionContext              - Began transaction (1) for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@3ae866ee, testMethod = testClaimAndUpdateToken@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3b85a820]; rollback [true]
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=? for update
Hibernate: insert into TokenEntry (owner, timestamp, token, tokenType, processorName, segment) values (?, ?, ?, ?, ?, ?)
Hibernate: select processorName from TokenEntry where processorName =? and segment =? for update
Hibernate: update TokenEntry set owner=?, timestamp=?, token=?, tokenType=? where processorName=? and segment=?
Hibernate: select tokenentry0_.processorName as processo1_0_, tokenentry0_.segment as segment2_0_, tokenentry0_.owner as owner3_0_, tokenentry0_.timestamp as timestam4_0_, tokenentry0_.token as token5_0_, tokenentry0_.tokenType as tokenTyp6_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=?
Hibernate: update TokenEntry set owner=null where owner=? and processorName=? and segment=?
Hibernate: select tokenentry0_.processorName as processo1_0_0_, tokenentry0_.segment as segment2_0_0_, tokenentry0_.owner as owner3_0_0_, tokenentry0_.timestamp as timestam4_0_0_, tokenentry0_.token as token5_0_0_, tokenentry0_.tokenType as tokenTyp6_0_0_ from TokenEntry tokenentry0_ where tokenentry0_.processorName=? and tokenentry0_.segment=?
2018-07-02 18:25:02,048 [main] INFO  TransactionContext              - Rolled back transaction for test context [DefaultTestContext@7c644bd5 testClass = JpaTokenStoreTest, testInstance = org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest@3ae866ee, testMethod = testClaimAndUpdateToken@JpaTokenStoreTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@283693af testClass = JpaTokenStoreTest, locations = '{}', classes = '{class org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest$Context}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{}', contextCustomizers = set[[empty]], contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]].
Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.535 sec - in org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStoreTest
Running org.axonframework.eventhandling.TrackingEventProcessorTest_MultiThreaded
2018-07-02 18:25:02,184 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:02,273 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:02,286 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-07-02 18:25:02,291 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-07-02 18:25:02,292 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:02,293 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=2} for segment: Segment[1/1]
2018-07-02 18:25:02,293 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=1} for segment: Segment[0/1]
2018-07-02 18:25:03,188 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:03,301 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:03,302 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=0} for segment: Segment[0/0]
2018-07-02 18:25:03,308 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:04,189 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:04,311 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-07-02 18:25:04,311 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-07-02 18:25:04,312 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/1]
2018-07-02 18:25:04,312 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[1/1]
2018-07-02 18:25:04,322 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:05,190 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:05,326 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-07-02 18:25:05,326 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-07-02 18:25:05,327 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/1]
2018-07-02 18:25:05,327 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[1/1]
2018-07-02 18:25:05,331 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:06,190 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:06,334 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-07-02 18:25:06,334 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=1} for segment: Segment[0/1]
2018-07-02 18:25:06,533 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:07,191 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:07,337 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/3]}
2018-07-02 18:25:07,337 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-07-02 18:25:07,338 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/3]
2018-07-02 18:25:07,338 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[1/1]
2018-07-02 18:25:07,344 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:08,191 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:08,349 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/3]}
2018-07-02 18:25:08,350 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/3]}
2018-07-02 18:25:08,350 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/3]
2018-07-02 18:25:08,351 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[1/3]
2018-07-02 18:25:08,549 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:09,192 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:09,355 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:09,355 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/0]
2018-07-02 18:25:09,360 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Error occurred. Starting retry mode.
org.axonframework.common.MockException: Mock
2018-07-02 18:25:09,360 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Releasing claim on token and preparing for retry in 1s
2018-07-02 18:25:10,193 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:10,360 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/0]
2018-07-02 18:25:10,363 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:11,194 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:11,368 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-07-02 18:25:11,368 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-07-02 18:25:11,369 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/1]
2018-07-02 18:25:11,369 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[1/1]
2018-07-02 18:25:11,379 [Time-limited test] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:12,195 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:12,378 [EventProcessor[test]-3] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-07-02 18:25:12,379 [EventProcessor[test]-3] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-07-02 18:25:12,380 [EventProcessor[test]-4] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=1} for segment: Segment[0/1]
2018-07-02 18:25:12,380 [EventProcessor[test]-5] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=1} for segment: Segment[1/1]
2018-07-02 18:25:12,385 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:13,195 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:13,387 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-07-02 18:25:13,387 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-07-02 18:25:13,387 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/1]
2018-07-02 18:25:13,387 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[1/1]
2018-07-02 18:25:13,388 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:14,196 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:14,391 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/7]}
2018-07-02 18:25:14,391 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/7]}
2018-07-02 18:25:14,392 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[2/3]}
2018-07-02 18:25:14,392 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/7]
2018-07-02 18:25:14,392 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[3/3]}
2018-07-02 18:25:14,392 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[1/7]
2018-07-02 18:25:14,393 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[4/7]}
2018-07-02 18:25:14,393 [EventProcessor[test]-3] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[2/3]
2018-07-02 18:25:14,393 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[5/7]}
2018-07-02 18:25:14,393 [EventProcessor[test]-4] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[3/3]
2018-07-02 18:25:14,394 [EventProcessor[test]-5] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[4/7]
2018-07-02 18:25:14,394 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:14,394 [EventProcessor[test]-6] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[5/7]
2018-07-02 18:25:15,197 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:15,397 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-07-02 18:25:15,398 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-07-02 18:25:15,398 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/1]
2018-07-02 18:25:15,398 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[1/1]
2018-07-02 18:25:15,402 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:16,198 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:16,404 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/1]}
2018-07-02 18:25:16,405 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=test, segment=Segment[1/1]}
2018-07-02 18:25:16,405 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=1} for segment: Segment[0/1]
2018-07-02 18:25:16,405 [EventProcessor[test]-2] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=2} for segment: Segment[1/1]
2018-07-02 18:25:16,609 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:17,198 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 14, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 15.563 sec - in org.axonframework.eventhandling.TrackingEventProcessorTest_MultiThreaded
Running org.axonframework.eventhandling.SimpleEventBusTest
2018-07-02 18:25:17,614 [main] INFO  AbstractEventBus                - EventProcessor [Mock for Consumer, hashCode: 2053734612] not added. It was already subscribed
2018-07-02 18:25:17,614 [main] INFO  AbstractEventBus                - EventListener Mock for Consumer, hashCode: 1869680039 not removed. It was already unsubscribed
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.eventhandling.SimpleEventBusTest
Running org.axonframework.eventhandling.GenericEventMessageTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.009 sec - in org.axonframework.eventhandling.GenericEventMessageTest
Running org.axonframework.eventhandling.ConcludesBatchParameterResolverFactoryTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 sec - in org.axonframework.eventhandling.ConcludesBatchParameterResolverFactoryTest
Running org.axonframework.eventhandling.ReplayTokenTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 sec - in org.axonframework.eventhandling.ReplayTokenTest
Running org.axonframework.eventhandling.TrackingEventProcessorTest
2018-07-02 18:25:17,660 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:17,661 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:17,664 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:17,664 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/0]
2018-07-02 18:25:17,667 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:17,673 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:17,674 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: ReplayToken{currentToken=IndexTrackingToken{globalIndex=1}, tokenAtReset=IndexTrackingToken{globalIndex=3}} for segment: Segment[0/0]
2018-07-02 18:25:17,677 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:18,199 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:18,684 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - An error occurred while attempting to claim a token for segment: 0. Will retry later...
java.lang.RuntimeException: Faking a recoverable issue
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.lambda$run$1(TrackingEventProcessor.java:713)
	at org.axonframework.eventhandling.TrackingEventProcessorTest.lambda$setUp$1(TrackingEventProcessorTest.java:127)
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:712)
	at org.axonframework.eventhandling.TrackingEventProcessor$CountingRunnable.run(TrackingEventProcessor.java:579)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:18,684 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:18,684 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-07-02 18:25:18,882 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:19,200 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:19,887 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:19,887 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/0]
2018-07-02 18:25:19,889 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:19,903 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:19,903 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: ReplayToken{currentToken=IndexTrackingToken{globalIndex=-1}, tokenAtReset=IndexTrackingToken{globalIndex=3}} for segment: Segment[0/0]
2018-07-02 18:25:19,905 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:20,201 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:20,913 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Fetch Segments for Processor 'test' failed: Faking issue during fetchSegments. Preparing for retry in 1s
2018-07-02 18:25:20,913 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Fetch Segments for Processor 'test' failed: Could not initialize segments. Some segments were already present.. Preparing for retry in 1s
2018-07-02 18:25:20,914 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:20,914 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-07-02 18:25:21,202 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:22,203 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:23,204 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:23,409 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:23,920 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:23,920 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-07-02 18:25:24,121 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:24,205 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:25,125 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:25,126 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-07-02 18:25:25,211 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:25,327 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:25,327 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Error occurred. Starting retry mode.
org.axonframework.common.MockException: Mock
2018-07-02 18:25:25,328 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Releasing claim on token and preparing for retry in 1s
2018-07-02 18:25:25,333 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:25,334 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-07-02 18:25:25,336 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Error occurred. Starting retry mode.
org.axonframework.common.MockException: Mock
2018-07-02 18:25:25,336 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Releasing claim on token and preparing for retry in 1s
2018-07-02 18:25:25,533 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:25,541 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:25,541 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=0} for segment: Segment[0/0]
2018-07-02 18:25:25,741 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:26,212 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:26,548 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:26,548 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-07-02 18:25:26,750 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:27,213 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:27,751 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:27,753 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:27,754 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-07-02 18:25:27,954 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:27,956 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:27,957 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:27,960 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:27,961 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/0]
2018-07-02 18:25:27,962 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:27,967 [EventProcessor[test]-0] ERROR TrackingEventProcessor          - An unrecoverable error has occurred wile attempting to claim a token for segment: 0. Shutting down processor [test].
org.axonframework.serialization.SerializationException: Faking a serialization issue
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.lambda$run$1(TrackingEventProcessor.java:713)
	at org.axonframework.eventhandling.TrackingEventProcessorTest.lambda$setUp$1(TrackingEventProcessorTest.java:127)
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:712)
	at org.axonframework.eventhandling.TrackingEventProcessor$CountingRunnable.run(TrackingEventProcessor.java:579)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:27,968 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:27,971 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:27,971 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-07-02 18:25:28,171 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:28,214 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:29,173 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:29,186 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:29,186 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-07-02 18:25:29,187 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:29,188 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:29,188 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: ReplayToken{currentToken=null, tokenAtReset=GapAwareTrackingToken{index=5, gaps=[3, 4]}} for segment: Segment[0/0]
2018-07-02 18:25:29,196 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:29,198 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:29,198 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/0]
2018-07-02 18:25:29,200 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Error occurred. Starting retry mode.
org.axonframework.common.MockException: Mock
2018-07-02 18:25:29,200 [EventProcessor[test]-0] WARN  TrackingEventProcessor          - Releasing claim on token and preparing for retry in 1s
2018-07-02 18:25:29,215 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:30,203 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/0]
2018-07-02 18:25:30,205 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:30,216 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:31,209 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:31,209 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-07-02 18:25:31,217 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:31,410 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:32,218 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:32,415 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:32,415 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=1} for segment: Segment[0/0]
2018-07-02 18:25:32,416 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:32,418 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:32,418 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: ReplayToken{currentToken=IndexTrackingToken{globalIndex=1}, tokenAtReset=IndexTrackingToken{globalIndex=3}} for segment: Segment[0/0]
2018-07-02 18:25:32,420 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:33,219 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:33,428 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:33,429 [EventProcessor[test]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-07-02 18:25:33,629 [Time-limited test] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:33,631 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=test, segment=Segment[0/0]}
2018-07-02 18:25:33,631 [EventProcessor[test]-1] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=1} for segment: Segment[0/0]
2018-07-02 18:25:34,220 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:34,631 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'test'. Awaiting termination...
2018-07-02 18:25:35,221 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 22, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 17.993 sec - in org.axonframework.eventhandling.TrackingEventProcessorTest
Running org.axonframework.eventhandling.SubscribingEventProcessorTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.eventhandling.SubscribingEventProcessorTest
Running org.axonframework.eventhandling.DirectEventProcessingStrategyTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.eventhandling.DirectEventProcessingStrategyTest
Running org.axonframework.eventhandling.AnnotationEventListenerAdapterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 sec - in org.axonframework.eventhandling.AnnotationEventListenerAdapterTest
Running org.axonframework.serialization.xml.Dom4JToByteArrayConverterTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.032 sec - in org.axonframework.serialization.xml.Dom4JToByteArrayConverterTest
Running org.axonframework.serialization.xml.InputStreamToDom4jConverterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.032 sec - in org.axonframework.serialization.xml.InputStreamToDom4jConverterTest
Running org.axonframework.serialization.xml.XStreamSerializerTest
Tests run: 12, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.092 sec - in org.axonframework.serialization.xml.XStreamSerializerTest
Running org.axonframework.serialization.xml.InputStreamToXomConverterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 sec - in org.axonframework.serialization.xml.InputStreamToXomConverterTest
Running org.axonframework.serialization.xml.XomToStringConverterTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.xml.XomToStringConverterTest
Running org.axonframework.serialization.AnnotationRevisionResolverTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.AnnotationRevisionResolverTest
Running org.axonframework.serialization.SerializationAwareTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.serialization.SerializationAwareTest
Running org.axonframework.serialization.upcasting.event.AbstractEventMultiUpcasterTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.094 sec - in org.axonframework.serialization.upcasting.event.AbstractEventMultiUpcasterTest
Running org.axonframework.serialization.upcasting.event.AbstractContextAwareSingleEventUpcasterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.013 sec - in org.axonframework.serialization.upcasting.event.AbstractContextAwareSingleEventUpcasterTest
Running org.axonframework.serialization.upcasting.event.AbstractSingleEventUpcasterTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.016 sec - in org.axonframework.serialization.upcasting.event.AbstractSingleEventUpcasterTest
Running org.axonframework.serialization.upcasting.event.EventUpcasterChainTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.014 sec - in org.axonframework.serialization.upcasting.event.EventUpcasterChainTest
Running org.axonframework.serialization.upcasting.event.AbstractContextAwareEventMultiUpcasterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.011 sec - in org.axonframework.serialization.upcasting.event.AbstractContextAwareEventMultiUpcasterTest
Running org.axonframework.serialization.upcasting.GenericUpcasterChainTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec - in org.axonframework.serialization.upcasting.GenericUpcasterChainTest
Running org.axonframework.serialization.converters.ByteArrayToStringConverterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.converters.ByteArrayToStringConverterTest
Running org.axonframework.serialization.converters.StringToByteArrayConverterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.converters.StringToByteArrayConverterTest
Running org.axonframework.serialization.converters.InputStreamToByteArrayConverterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.converters.InputStreamToByteArrayConverterTest
Running org.axonframework.serialization.SerialVersionUIDRevisionResolverTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.SerialVersionUIDRevisionResolverTest
Running org.axonframework.serialization.json.JsonNodeToByteArrayConverterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.json.JsonNodeToByteArrayConverterTest
Running org.axonframework.serialization.json.MetaDataDeserializerTest
Tests run: 20, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.095 sec - in org.axonframework.serialization.json.MetaDataDeserializerTest
Running org.axonframework.serialization.json.JacksonSerializerTest
2018-07-02 18:25:36,222 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.423 sec - in org.axonframework.serialization.json.JacksonSerializerTest
Running org.axonframework.serialization.json.ByteArrayToJsonNodeConverterTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.json.ByteArrayToJsonNodeConverterTest
Running org.axonframework.serialization.SerializedMetaDataValueTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.SerializedMetaDataValueTest
Running org.axonframework.serialization.LazyDeserializingObjectTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.011 sec - in org.axonframework.serialization.LazyDeserializingObjectTest
Running org.axonframework.serialization.ChainedConverterTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.014 sec - in org.axonframework.serialization.ChainedConverterTest
Running org.axonframework.serialization.MessageSerializerTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 sec - in org.axonframework.serialization.MessageSerializerTest
Running org.axonframework.serialization.MavenArtifactRevisionResolverTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.serialization.MavenArtifactRevisionResolverTest
Running org.axonframework.serialization.FixedValueRevisionResolverTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0 sec - in org.axonframework.serialization.FixedValueRevisionResolverTest
Running org.axonframework.serialization.JavaSerializerTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.008 sec - in org.axonframework.serialization.JavaSerializerTest
Running org.axonframework.serialization.SerializedMessageTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 sec - in org.axonframework.serialization.SerializedMessageTest
Running org.axonframework.config.MessageMonitorFactoryBuilderTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.009 sec - in org.axonframework.config.MessageMonitorFactoryBuilderTest
Running org.axonframework.config.ConfigurationResourceInjectorTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.001 sec - in org.axonframework.config.ConfigurationResourceInjectorTest
Running org.axonframework.config.EventHandlingConfigurationTest
2018-07-02 18:25:36,584 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=tracking, segment=Segment[0/0]}
2018-07-02 18:25:36,584 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/0]
2018-07-02 18:25:36,585 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'tracking'. Awaiting termination...
2018-07-02 18:25:37,222 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:37,600 [EventProcessor[concurrent]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=concurrent, segment=Segment[0/0]}
2018-07-02 18:25:37,600 [EventProcessor[concurrent]-0] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/0]
2018-07-02 18:25:37,605 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=tracking, segment=Segment[0/0]}
2018-07-02 18:25:37,605 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/0]
2018-07-02 18:25:37,607 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'tracking'. Awaiting termination...
2018-07-02 18:25:38,223 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:38,615 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=tracking, segment=Segment[0/0]}
2018-07-02 18:25:38,615 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/0]
2018-07-02 18:25:38,616 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'tracking'. Awaiting termination...
2018-07-02 18:25:38,620 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=tracking, segment=Segment[0/0]}
2018-07-02 18:25:38,620 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/0]
2018-07-02 18:25:38,621 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'tracking'. Awaiting termination...
2018-07-02 18:25:39,224 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:39,626 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Using current Thread for last segment segment worker: TrackingSegmentWorker{processor=tracking, segment=Segment[0/0]}
2018-07-02 18:25:39,626 [EventProcessor[tracking]-0] INFO  TrackingEventProcessor          - Fetched token: IndexTrackingToken{globalIndex=-1} for segment: Segment[0/0]
2018-07-02 18:25:39,627 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'tracking'. Awaiting termination...
2018-07-02 18:25:40,225 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.07 sec - in org.axonframework.config.EventHandlingConfigurationTest
Running org.axonframework.config.SingleEventProcessorAssigningToMultipleInvokersTest
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.021 sec - in org.axonframework.config.SingleEventProcessorAssigningToMultipleInvokersTest
Running org.axonframework.config.SagaConfigurationTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.045 sec - in org.axonframework.config.SagaConfigurationTest
Running org.axonframework.config.DefaultConfigurerTest
2018-07-02 18:25:40,747 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:25:40,801 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-07-02 18:25:40,801 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-07-02 18:25:40,801 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-07-02 18:25:40,802 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-07-02 18:25:40,802 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-07-02 18:25:40,824 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:25:40,894 [main] WARN  ExceptionHandlerLoggedImpl      - GenerationTarget encountered exception accepting command : Unable to execute command [drop sequence hibernate_sequence]
org.hibernate.tool.schema.spi.CommandAcceptanceException: Unable to execute command [drop sequence hibernate_sequence]
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:63)
	at org.hibernate.tool.schema.internal.SchemaDropperImpl.applySqlString(SchemaDropperImpl.java:370)
	at org.hibernate.tool.schema.internal.SchemaDropperImpl.applySqlStrings(SchemaDropperImpl.java:355)
	at org.hibernate.tool.schema.internal.SchemaDropperImpl.dropFromMetadata(SchemaDropperImpl.java:245)
	at org.hibernate.tool.schema.internal.SchemaDropperImpl.performDrop(SchemaDropperImpl.java:153)
	at org.hibernate.tool.schema.internal.SchemaDropperImpl.doDrop(SchemaDropperImpl.java:125)
	at org.hibernate.tool.schema.internal.SchemaDropperImpl.doDrop(SchemaDropperImpl.java:111)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:137)
	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:64)
	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:458)
	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:465)
	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:881)
	at org.hibernate.jpa.HibernatePersistenceProvider.createEntityManagerFactory(HibernatePersistenceProvider.java:58)
	at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:55)
	at org.axonframework.config.DefaultConfigurerTest.setUp(DefaultConfigurerTest.java:67)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:367)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:274)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:161)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:290)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:242)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:121)
Caused by: java.sql.SQLSyntaxErrorException: user lacks privilege or object not found: HIBERNATE_SEQUENCE in statement [drop sequence hibernate_sequence]
	at org.hsqldb.jdbc.JDBCUtil.sqlException(Unknown Source)
	at org.hsqldb.jdbc.JDBCUtil.sqlException(Unknown Source)
	at org.hsqldb.jdbc.JDBCStatement.fetchResult(Unknown Source)
	at org.hsqldb.jdbc.JDBCStatement.execute(Unknown Source)
	at org.hibernate.tool.schema.internal.exec.GenerationTargetToDatabase.accept(GenerationTargetToDatabase.java:51)
	... 39 more
Caused by: org.hsqldb.HsqlException: user lacks privilege or object not found: HIBERNATE_SEQUENCE
	at org.hsqldb.error.Error.error(Unknown Source)
	at org.hsqldb.error.Error.error(Unknown Source)
	at org.hsqldb.StatementSchema.getResult(Unknown Source)
	at org.hsqldb.StatementSchema.execute(Unknown Source)
	at org.hsqldb.Session.executeCompiledStatement(Unknown Source)
	at org.hsqldb.Session.executeDirectStatement(Unknown Source)
	at org.hsqldb.Session.execute(Unknown Source)
	... 42 more
2018-07-02 18:25:40,905 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@1b53e1ae'
2018-07-02 18:25:40,917 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:25:40,923 [EventProcessor[org.axonframework.config]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=org.axonframework.config, segment=Segment[0/1]}
2018-07-02 18:25:40,924 [EventProcessor[org.axonframework.config]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=org.axonframework.config, segment=Segment[1/1]}
2018-07-02 18:25:40,924 [EventProcessor[org.axonframework.config]-1] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[0/1]
2018-07-02 18:25:40,924 [EventProcessor[org.axonframework.config]-2] INFO  TrackingEventProcessor          - Fetched token: null for segment: Segment[1/1]
2018-07-02 18:25:40,925 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'org.axonframework.config'. Awaiting termination...
2018-07-02 18:25:41,226 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:41,939 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:25:41,993 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-07-02 18:25:41,993 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-07-02 18:25:41,993 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-07-02 18:25:41,993 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-07-02 18:25:41,993 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-07-02 18:25:41,994 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:25:42,074 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@1b53e1ae'
2018-07-02 18:25:42,083 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:25:42,092 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:25:42,137 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-07-02 18:25:42,137 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-07-02 18:25:42,137 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-07-02 18:25:42,137 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-07-02 18:25:42,137 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-07-02 18:25:42,138 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:25:42,177 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@1b53e1ae'
2018-07-02 18:25:42,184 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:25:42,200 [main] INFO  ueryTranslatorFactoryInitiator  - HHH000397: Using ASTQueryTranslatorFactory
2018-07-02 18:25:42,216 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:25:42,227 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:42,261 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-07-02 18:25:42,261 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-07-02 18:25:42,261 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-07-02 18:25:42,261 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-07-02 18:25:42,261 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-07-02 18:25:42,262 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:25:42,302 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@1b53e1ae'
2018-07-02 18:25:42,310 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:25:42,313 [EventProcessor[org.axonframework.config]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=org.axonframework.config, segment=Segment[0/1]}
2018-07-02 18:25:42,313 [main] INFO  TrackingEventProcessor          - Shutdown state set for Processor 'org.axonframework.config'. Awaiting termination...
2018-07-02 18:25:42,313 [EventProcessor[org.axonframework.config]-0] INFO  TrackingEventProcessor          - Dispatching new tracking segment worker: TrackingSegmentWorker{processor=org.axonframework.config, segment=Segment[1/1]}
2018-07-02 18:25:42,319 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:25:42,363 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-07-02 18:25:42,364 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-07-02 18:25:42,364 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-07-02 18:25:42,364 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-07-02 18:25:42,364 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-07-02 18:25:42,364 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:25:42,410 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@1b53e1ae'
2018-07-02 18:25:42,419 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:25:42,425 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:25:42,475 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-07-02 18:25:42,475 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-07-02 18:25:42,475 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-07-02 18:25:42,475 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-07-02 18:25:42,475 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-07-02 18:25:42,476 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:25:42,540 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@1b53e1ae'
2018-07-02 18:25:42,552 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:25:42,563 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:25:42,617 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-07-02 18:25:42,617 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-07-02 18:25:42,617 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-07-02 18:25:42,617 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-07-02 18:25:42,617 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-07-02 18:25:42,618 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:25:42,689 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@1b53e1ae'
2018-07-02 18:25:42,701 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:25:42,778 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:25:42,837 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-07-02 18:25:42,837 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-07-02 18:25:42,837 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-07-02 18:25:42,837 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-07-02 18:25:42,838 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-07-02 18:25:42,838 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:25:42,882 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@1b53e1ae'
2018-07-02 18:25:42,892 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:25:42,908 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:25:42,961 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-07-02 18:25:42,961 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-07-02 18:25:42,961 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-07-02 18:25:42,961 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-07-02 18:25:42,961 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-07-02 18:25:42,961 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:25:43,001 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@1b53e1ae'
2018-07-02 18:25:43,009 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:25:43,015 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:25:43,063 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-07-02 18:25:43,063 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-07-02 18:25:43,063 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-07-02 18:25:43,063 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-07-02 18:25:43,063 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-07-02 18:25:43,064 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:25:43,106 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@1b53e1ae'
2018-07-02 18:25:43,113 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
2018-07-02 18:25:43,142 [main] INFO  LogHelper                       - HHH000204: Processing PersistenceUnitInfo [
	name: eventStore
	...]
2018-07-02 18:25:43,196 [main] WARN  connections                     - HHH10001002: Using Hibernate built-in connection pool (not for production use!)
2018-07-02 18:25:43,196 [main] INFO  connections                     - HHH10001005: using driver [null] at URL [jdbc:hsqldb:mem:axontest]
2018-07-02 18:25:43,196 [main] INFO  connections                     - HHH10001001: Connection properties: {}
2018-07-02 18:25:43,196 [main] INFO  connections                     - HHH10001003: Autocommit mode: false
2018-07-02 18:25:43,196 [main] INFO  rManagerConnectionProviderImpl  - HHH000115: Hibernate connection pool size: 20 (min=1)
2018-07-02 18:25:43,197 [main] INFO  Dialect                         - HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
2018-07-02 18:25:43,227 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:43,242 [main] INFO  SchemaCreatorImpl               - HHH000476: Executing import script 'org.hibernate.tool.schema.internal.exec.ScriptSourceInputNonExistentImpl@1b53e1ae'
2018-07-02 18:25:43,251 [main] WARN  EntityManagerFactoryRegistry    - HHH000436: Entity manager factory name (eventStore) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
Tests run: 11, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.628 sec - in org.axonframework.config.DefaultConfigurerTest
Running org.axonframework.config.ConfigurationParameterResolverFactoryTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.025 sec - in org.axonframework.config.ConfigurationParameterResolverFactoryTest
Running org.axonframework.queryhandling.responsetypes.InstanceResponseTypeTest
Tests run: 35, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.005 sec - in org.axonframework.queryhandling.responsetypes.InstanceResponseTypeTest
Running org.axonframework.queryhandling.responsetypes.MultipleInstancesResponseTypeTest
2018-07-02 18:25:43,364 [main] INFO  MultipleInstancesResponseType   - The given response is an Iterable without any contents, hence we cannot verify if the contained type is assignable to the expected type.
Tests run: 45, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.013 sec - in org.axonframework.queryhandling.responsetypes.MultipleInstancesResponseTypeTest
Running org.axonframework.queryhandling.responsetypes.ResponseTypesJacksonSerializationTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 sec - in org.axonframework.queryhandling.responsetypes.ResponseTypesJacksonSerializationTest
Running org.axonframework.queryhandling.annotation.AnnotationQueryHandlerAdapterTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.02 sec - in org.axonframework.queryhandling.annotation.AnnotationQueryHandlerAdapterTest
Running org.axonframework.queryhandling.DefaultQueryGatewayTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.002 sec - in org.axonframework.queryhandling.DefaultQueryGatewayTest
Running org.axonframework.queryhandling.SubscriptionQueryTest
2018-07-02 18:25:44,228 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.035 sec - in org.axonframework.queryhandling.SubscriptionQueryTest
Running org.axonframework.queryhandling.SimpleQueryBusTest
Tests run: 24, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.03 sec - in org.axonframework.queryhandling.SimpleQueryBusTest
Running org.axonframework.queryhandling.QueryEventHandlingTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.003 sec - in org.axonframework.queryhandling.QueryEventHandlingTest
Running org.axonframework.deadline.QuartzDeadlineManagerTest
2018-07-02 18:25:44,483 [main] INFO  StdSchedulerFactory             - Using default implementation for ThreadExecutor
2018-07-02 18:25:44,483 [main] INFO  SimpleThreadPool                - Job execution threads will use class loader of thread: main
2018-07-02 18:25:44,487 [main] INFO  SchedulerSignalerImpl           - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2018-07-02 18:25:44,487 [main] INFO  QuartzScheduler                 - Quartz Scheduler v.2.2.1 created.
2018-07-02 18:25:44,490 [main] INFO  RAMJobStore                     - RAMJobStore initialized.
2018-07-02 18:25:44,490 [main] INFO  QuartzScheduler                 - Scheduler meta-data: Quartz Scheduler (v2.2.1) 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

2018-07-02 18:25:44,490 [main] INFO  StdSchedulerFactory             - Quartz scheduler 'DefaultQuartzScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
2018-07-02 18:25:44,490 [main] INFO  StdSchedulerFactory             - Quartz scheduler version: 2.2.1
2018-07-02 18:25:44,497 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-07-02 18:25:45,229 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:45,546 [DefaultQuartzScheduler_Worker-1] INFO  DeadlineJob                     - Job successfully executed. Deadline message [Void] processed.
2018-07-02 18:25:45,619 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-07-02 18:25:46,229 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:46,652 [DefaultQuartzScheduler_Worker-2] INFO  DeadlineJob                     - Job successfully executed. Deadline message [DeadlinePayload] processed.
2018-07-02 18:25:46,728 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-07-02 18:25:47,230 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:47,763 [DefaultQuartzScheduler_Worker-3] INFO  DeadlineJob                     - Job successfully executed. Deadline message [DeadlinePayload] processed.
2018-07-02 18:25:47,840 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-07-02 18:25:48,231 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:48,953 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-07-02 18:25:49,232 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:49,486 [DefaultQuartzScheduler_Worker-4] INFO  DeadlineJob                     - Job successfully executed. Deadline message [ChildDeadlinePayload] processed.
2018-07-02 18:25:49,975 [DefaultQuartzScheduler_Worker-5] INFO  DeadlineJob                     - Job successfully executed. Deadline message [DeadlinePayload] processed.
2018-07-02 18:25:50,068 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-07-02 18:25:50,232 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:51,099 [DefaultQuartzScheduler_Worker-6] INFO  DeadlineJob                     - Job successfully executed. Deadline message [String] processed.
2018-07-02 18:25:51,182 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-07-02 18:25:51,233 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:52,212 [DefaultQuartzScheduler_Worker-7] INFO  DeadlineJob                     - Job successfully executed. Deadline message [Void] processed.
2018-07-02 18:25:52,234 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:52,292 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-07-02 18:25:53,234 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:53,312 [DefaultQuartzScheduler_Worker-8] INFO  DeadlineJob                     - Job successfully executed. Deadline message [String] processed.
2018-07-02 18:25:53,402 [main] INFO  QuartzScheduler                 - Scheduler DefaultQuartzScheduler_$_NON_CLUSTERED started.
2018-07-02 18:25:54,235 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 10.035 sec - in org.axonframework.deadline.QuartzDeadlineManagerTest
Running org.axonframework.deadline.SimpleDeadlineManagerTest
2018-07-02 18:25:55,236 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:56,237 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:57,238 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:58,239 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:25:59,239 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:26:00,240 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:26:01,241 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:26:02,242 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:26:03,243 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
2018-07-02 18:26:04,244 [EmbeddedEventStore-0] ERROR EmbeddedEventStore              - Failed to read events from the underlying event storage
java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.validateNotClosed(EntityManagerFactoryImpl.java:367)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.internalCreateEntityManager(EntityManagerFactoryImpl.java:316)
	at org.hibernate.jpa.internal.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:286)
	at sun.reflect.GeneratedMethodAccessor87.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:459)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:630)
	at com.sun.proxy.$Proxy53.createEntityManager(Unknown Source)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:292)
	at com.sun.proxy.$Proxy55.createQuery(Unknown Source)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.lambda$fetchTrackedEvents$1(JpaEventStorageEngine.java:234)
	at org.axonframework.common.transaction.TransactionManager.fetchInTransaction(TransactionManager.java:67)
	at org.axonframework.eventsourcing.eventstore.jpa.JpaEventStorageEngine.fetchTrackedEvents(JpaEventStorageEngine.java:230)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine.lambda$readEventData$1(BatchingEventStorageEngine.java:154)
	at org.axonframework.eventsourcing.eventstore.BatchingEventStorageEngine$EventStreamSpliterator.tryAdvance(BatchingEventStorageEngine.java:192)
	at java.util.Spliterator.forEachRemaining(Spliterator.java:326)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.fetchData(EmbeddedEventStore.java:237)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.run(EmbeddedEventStore.java:203)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore$EventProducer.access$2000(EmbeddedEventStore.java:182)
	at org.axonframework.eventsourcing.eventstore.EmbeddedEventStore.lambda$ensureProducerStarted$0(EmbeddedEventStore.java:132)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 9.967 sec - in org.axonframework.deadline.SimpleDeadlineManagerTest
Running org.axonframework.monitoring.MultiMessageMonitorTest
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.007 sec - in org.axonframework.monitoring.MultiMessageMonitorTest
2018-07-02 18:26:04,494 [Thread-70] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@2ad3e7e5: startup date [Mon Jul 02 18:25:01 CEST 2018]; root of context hierarchy
2018-07-02 18:26:04,494 [Thread-29] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@249fa2cb: startup date [Mon Jul 02 18:24:26 CEST 2018]; root of context hierarchy
2018-07-02 18:26:04,494 [Thread-71] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@6e886e25: startup date [Mon Jul 02 18:25:01 CEST 2018]; root of context hierarchy
2018-07-02 18:26:04,497 [Thread-7] INFO  GenericApplicationContext       - Closing org.springframework.context.support.GenericApplicationContext@346e5cc: startup date [Mon Jul 02 18:24:22 CEST 2018]; root of context hierarchy
2018-07-02 18:26:04,511 [Thread-7] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:26:04,511 [Thread-71] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'default'
2018-07-02 18:26:04,511 [Thread-29] INFO  tainerEntityManagerFactoryBean  - Closing JPA EntityManagerFactory for persistence unit 'eventStore'
2018-07-02 18:26:04,514 [Thread-71] INFO  pperImpl$DelayedDropActionImpl  - HHH000477: Starting delayed drop of schema as part of SessionFactory shut-down'
Hibernate: drop table TokenEntry if exists
2018-07-02 18:26:04,542 [Thread-71] INFO  connections                     - HHH10001008: Cleaning up connection pool [jdbc:hsqldb:mem:testdb]

Results :

Tests run: 1073, Failures: 0, Errors: 0, Skipped: 1

[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building Axon Framework Distributed CommandBus JGroups 3.3-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:resources (default-resources) @ axon-distributed-commandbus-jgroups ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory /root/workspace/AxonFramework/AxonFramework/399202464/distributed-commandbus-jgroups/src/main/resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:compile (default-compile) @ axon-distributed-commandbus-jgroups ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:testResources (default-testResources) @ axon-distributed-commandbus-jgroups ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 4 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:testCompile (default-testCompile) @ axon-distributed-commandbus-jgroups ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-surefire-plugin:2.19.1:test (default-test) @ axon-distributed-commandbus-jgroups ---

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.axonframework.jgroups.commandhandling.JGroupsConnectorTest
Tests run: 10, Failures: 0, Errors: 10, Skipped: 0, Time elapsed: 0.178 sec <<< FAILURE! - in org.axonframework.jgroups.commandhandling.JGroupsConnectorTest
testRingsProperlySynchronized_ChannelAlreadyConnectedToOtherCluster(org.axonframework.jgroups.commandhandling.JGroupsConnectorTest)  Time elapsed: 0.112 sec  <<< ERROR!
java.lang.ExceptionInInitializerError
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.createChannel(JGroupsConnectorTest.java:409)
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.setUp(JGroupsConnectorTest.java:69)
Caused by: java.lang.NullPointerException
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.createChannel(JGroupsConnectorTest.java:409)
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.setUp(JGroupsConnectorTest.java:69)

testUpdatesToMemberShipProcessedInOrder(org.axonframework.jgroups.commandhandling.JGroupsConnectorTest)  Time elapsed: 0 sec  <<< ERROR!
java.lang.NoClassDefFoundError: Could not initialize class org.jgroups.conf.XmlConfigurator
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.createChannel(JGroupsConnectorTest.java:409)
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.setUp(JGroupsConnectorTest.java:69)

testUnserializableResponseConvertedToNull(org.axonframework.jgroups.commandhandling.JGroupsConnectorTest)  Time elapsed: 0.001 sec  <<< ERROR!
java.lang.NoClassDefFoundError: Could not initialize class org.jgroups.conf.XmlConfigurator
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.createChannel(JGroupsConnectorTest.java:409)
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.setUp(JGroupsConnectorTest.java:69)

testDisconnectClosesJChannelConnection(org.axonframework.jgroups.commandhandling.JGroupsConnectorTest)  Time elapsed: 0.001 sec  <<< ERROR!
java.lang.NoClassDefFoundError: Could not initialize class org.jgroups.conf.XmlConfigurator
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.createChannel(JGroupsConnectorTest.java:409)
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.setUp(JGroupsConnectorTest.java:69)

testRingsProperlySynchronized_ChannelAlreadyConnected(org.axonframework.jgroups.commandhandling.JGroupsConnectorTest)  Time elapsed: 0.001 sec  <<< ERROR!
java.lang.NoClassDefFoundError: Could not initialize class org.jgroups.conf.XmlConfigurator
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.createChannel(JGroupsConnectorTest.java:409)
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.setUp(JGroupsConnectorTest.java:69)

testJoinMessageReceivedForDisconnectedHost(org.axonframework.jgroups.commandhandling.JGroupsConnectorTest)  Time elapsed: 0.001 sec  <<< ERROR!
java.lang.NoClassDefFoundError: Could not initialize class org.jgroups.conf.XmlConfigurator
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.createChannel(JGroupsConnectorTest.java:409)
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.setUp(JGroupsConnectorTest.java:69)

testConnectAndDispatchMessages_Balanced(org.axonframework.jgroups.commandhandling.JGroupsConnectorTest)  Time elapsed: 0.001 sec  <<< ERROR!
java.lang.NoClassDefFoundError: Could not initialize class org.jgroups.conf.XmlConfigurator
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.createChannel(JGroupsConnectorTest.java:409)
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.setUp(JGroupsConnectorTest.java:69)

testSetupOfReplyingCallback(org.axonframework.jgroups.commandhandling.JGroupsConnectorTest)  Time elapsed: 0.001 sec  <<< ERROR!
java.lang.NoClassDefFoundError: Could not initialize class org.jgroups.conf.XmlConfigurator
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.createChannel(JGroupsConnectorTest.java:409)
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.setUp(JGroupsConnectorTest.java:69)

testConnectAndDispatchMessages_SingleCandidate(org.axonframework.jgroups.commandhandling.JGroupsConnectorTest)  Time elapsed: 0.001 sec  <<< ERROR!
java.lang.NoClassDefFoundError: Could not initialize class org.jgroups.conf.XmlConfigurator
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.createChannel(JGroupsConnectorTest.java:409)
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.setUp(JGroupsConnectorTest.java:69)

testConnectAndDispatchMessages_CustomCommandName(org.axonframework.jgroups.commandhandling.JGroupsConnectorTest)  Time elapsed: 0.001 sec  <<< ERROR!
java.lang.NoClassDefFoundError: Could not initialize class org.jgroups.conf.XmlConfigurator
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.createChannel(JGroupsConnectorTest.java:409)
	at org.axonframework.jgroups.commandhandling.JGroupsConnectorTest.setUp(JGroupsConnectorTest.java:69)

Running org.axonframework.jgroups.commandhandling.JgroupsConnectorTest_Gossip
Tests run: 2, Failures: 0, Errors: 2, Skipped: 0, Time elapsed: 0 sec <<< FAILURE! - in org.axonframework.jgroups.commandhandling.JgroupsConnectorTest_Gossip
testConnectorRecoversWhenGossipRouterReconnects(org.axonframework.jgroups.commandhandling.JgroupsConnectorTest_Gossip)  Time elapsed: 0 sec  <<< ERROR!
java.lang.NoClassDefFoundError: Could not initialize class org.jgroups.conf.XmlConfigurator
	at org.axonframework.jgroups.commandhandling.JgroupsConnectorTest_Gossip.createChannel(JgroupsConnectorTest_Gossip.java:159)
	at org.axonframework.jgroups.commandhandling.JgroupsConnectorTest_Gossip.setUp(JgroupsConnectorTest_Gossip.java:67)

testDistributedCommandBusInvokesCallbackOnSerializationFailure(org.axonframework.jgroups.commandhandling.JgroupsConnectorTest_Gossip)  Time elapsed: 0 sec  <<< ERROR!
java.lang.NoClassDefFoundError: Could not initialize class org.jgroups.conf.XmlConfigurator
	at org.axonframework.jgroups.commandhandling.JgroupsConnectorTest_Gossip.createChannel(JgroupsConnectorTest_Gossip.java:159)
	at org.axonframework.jgroups.commandhandling.JgroupsConnectorTest_Gossip.setUp(JgroupsConnectorTest_Gossip.java:67)


Results :

Tests in error: 
  JGroupsConnectorTest.setUp:69->createChannel:409 » NoClassDefFound Could not i...
  JGroupsConnectorTest.setUp:69->createChannel:409 » NoClassDefFound Could not i...
  JGroupsConnectorTest.setUp:69->createChannel:409 » NoClassDefFound Could not i...
  JGroupsConnectorTest.setUp:69->createChannel:409 » NoClassDefFound Could not i...
  JGroupsConnectorTest.setUp:69->createChannel:409 » NoClassDefFound Could not i...
  JGroupsConnectorTest.setUp:69->createChannel:409 » NoClassDefFound Could not i...
  JGroupsConnectorTest.setUp:69->createChannel:409 » ExceptionInInitializer
  JGroupsConnectorTest.setUp:69->createChannel:409 » NoClassDefFound Could not i...
  JGroupsConnectorTest.setUp:69->createChannel:409 » NoClassDefFound Could not i...
  JGroupsConnectorTest.setUp:69->createChannel:409 » NoClassDefFound Could not i...
  JgroupsConnectorTest_Gossip.setUp:67->createChannel:159 » NoClassDefFound Coul...
  JgroupsConnectorTest_Gossip.setUp:67->createChannel:159 » NoClassDefFound Coul...

Tests run: 12, Failures: 0, Errors: 12, Skipped: 0

[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary:
[INFO] 
[INFO] Axon Framework ..................................... SUCCESS [  0.003 s]
[INFO] Axon Framework core ................................ SUCCESS [02:01 min]
[INFO] Axon Framework Distributed CommandBus JGroups ...... FAILURE [  1.255 s]
[INFO] Axon Framework Spring Support ...................... SKIPPED
[INFO] Axon AMQP .......................................... SKIPPED
[INFO] Axon Kafka ......................................... SKIPPED
[INFO] Axon Framework Distributed CommandBus Spring Cloud . SKIPPED
[INFO] Axon Metrics ....................................... SKIPPED
[INFO] Axon Framework Spring Boot Support ................. SKIPPED
[INFO] Axon Framework Test Fixtures ....................... SKIPPED
[INFO] Axon MongoDB Components ............................ SKIPPED
[INFO] Axon Integration tests ............................. SKIPPED
[INFO] Spring Boot Starter module for Axon Framework ...... SKIPPED
[INFO] Spring Boot Starter module for Axon with JGroups Distributed Command Bus SKIPPED
[INFO] Axon Legacy Components ............................. SKIPPED
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 02:04 min
[INFO] Finished at: 2018-07-02T18:26:06+02:00
[INFO] Final Memory: 56M/1398M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.19.1:test (default-test) on project axon-distributed-commandbus-jgroups: There are test failures.
[ERROR] 
[ERROR] Please refer to /root/workspace/AxonFramework/AxonFramework/399202464/distributed-commandbus-jgroups/target/surefire-reports for the individual test results.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
[ERROR] 
[ERROR] After correcting the problems, you can resume the build with the command
[ERROR]   mvn <goals> -rf :axon-distributed-commandbus-jgroups
