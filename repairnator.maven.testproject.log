[INFO] Scanning for projects...
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Build Order:
[INFO] 
[INFO] Singularity
[INFO] SingularityBase
[INFO] SingularityMesosClient
[INFO] SingularityUI
[INFO] SingularityService
[INFO] SingularityRunnerBase
[INFO] SingularityS3Base
[INFO] SingularityClient
[INFO] SingularityExecutor
[INFO] SingularityExecutorCleanup
[INFO] SingularityS3Uploader
[INFO] SingularityS3Downloader
[INFO] EmbedSingularityExample
[INFO] SingularityServiceIntegrationTests
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building Singularity 0.20.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- property-helper-maven-plugin:2.0:get (get-build-id) @ Singularity ---
[INFO] 
[INFO] --- dependency-scope-maven-plugin:0.8:check (check) @ Singularity ---
[INFO] No test dependency scope issues found
[INFO] 
[INFO] --- maven-enforcer-plugin:1.4.1:enforce (default) @ Singularity ---
[INFO] 
[INFO] --- maven-enforcer-plugin:1.4.1:enforce (basepom-banned-dependencies) @ Singularity ---
[INFO] 
[INFO] --- maven-dependency-versions-check-plugin:2.0.2:check (default) @ Singularity ---
[INFO] Checking dependency versions
[INFO] 
[INFO] --- dependency-management-maven-plugin:0.8:analyze (default) @ Singularity ---
[INFO] No dependency management issues found
[INFO] 
[INFO] --- maven-checkstyle-plugin:2.17:check (default) @ Singularity ---
[INFO] Starting audit...
Audit done.
[INFO] 
[INFO] --- git-commit-id-plugin:2.2.1:revision (default) @ Singularity ---
[INFO] 
[INFO] --- jacoco-maven-plugin:0.7.6.201602180812:prepare-agent (default) @ Singularity ---
[INFO] argLine set to -javaagent:/root/./workspace/HubSpot/Singularity/348290188/.m2/org/jacoco/org.jacoco.agent/0.7.6.201602180812/org.jacoco.agent-0.7.6.201602180812-runtime.jar=destfile=/root/workspace/HubSpot/Singularity/348290188/target/jacoco.exec
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building SingularityBase 0.20.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- property-helper-maven-plugin:2.0:get (get-build-id) @ SingularityBase ---
[INFO] 
[INFO] --- dependency-scope-maven-plugin:0.8:check (check) @ SingularityBase ---
[INFO] No test dependency scope issues found
[INFO] 
[INFO] --- maven-enforcer-plugin:1.4.1:enforce (default) @ SingularityBase ---
[INFO] 
[INFO] --- maven-enforcer-plugin:1.4.1:enforce (basepom-banned-dependencies) @ SingularityBase ---
[INFO] 
[INFO] --- maven-dependency-versions-check-plugin:2.0.2:check (default) @ SingularityBase ---
[INFO] Checking dependency versions
[INFO] 
[INFO] --- dependency-management-maven-plugin:0.8:analyze (default) @ SingularityBase ---
[INFO] No dependency management issues found
[INFO] 
[INFO] --- maven-checkstyle-plugin:2.17:check (default) @ SingularityBase ---
[INFO] Starting audit...
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityBase/src/main/java/com/hubspot/singularity/api/task/TaskCleanupType.java:18:3: Redundant 'private' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityBase/src/main/java/com/hubspot/singularity/api/task/SingularityShellCommandIF.java:17:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityBase/src/main/java/com/hubspot/singularity/api/task/SingularityShellCommandIF.java:20:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityBase/src/main/java/com/hubspot/singularity/api/task/SingularityShellCommandIF.java:23:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityBase/src/main/java/com/hubspot/singularity/api/task/SingularityShellCommandIF.java:26:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityBase/src/main/java/com/hubspot/singularity/api/request/RequestType.java:13:3: Redundant 'private' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityBase/src/main/java/com/hubspot/singularity/api/request/RequestCleanupType.java:17:3: Redundant 'private' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityBase/src/main/java/com/hubspot/singularity/api/request/RequestState.java:12:3: Redundant 'private' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityBase/src/main/java/com/hubspot/singularity/api/deploy/HealthcheckProtocol.java:12:3: Redundant 'private' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityBase/src/main/java/com/hubspot/singularity/api/deploy/DeployState.java:14:3: Redundant 'private' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityBase/src/main/java/com/hubspot/singularity/api/machines/SlaveMatchState.java:18:3: Redundant 'private' modifier. [RedundantModifier]
Audit done.
[INFO] 
[INFO] --- git-commit-id-plugin:2.2.1:revision (default) @ SingularityBase ---
[INFO] 
[INFO] --- jacoco-maven-plugin:0.7.6.201602180812:prepare-agent (default) @ SingularityBase ---
[INFO] argLine set to -javaagent:/root/./workspace/HubSpot/Singularity/348290188/.m2/org/jacoco/org.jacoco.agent/0.7.6.201602180812/org.jacoco.agent-0.7.6.201602180812-runtime.jar=destfile=/root/workspace/HubSpot/Singularity/348290188/SingularityBase/target/jacoco.exec
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:resources (default-resources) @ SingularityBase ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory /root/workspace/HubSpot/Singularity/348290188/SingularityBase/src/main/resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:compile (default-compile) @ SingularityBase ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:testResources (default-testResources) @ SingularityBase ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory /root/workspace/HubSpot/Singularity/348290188/SingularityBase/src/test/resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:testCompile (default-testCompile) @ SingularityBase ---
[INFO] No sources to compile
[INFO] 
[INFO] --- maven-surefire-plugin:2.19.1:test (default-test) @ SingularityBase ---
[INFO] No tests to run.
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building SingularityMesosClient 0.20.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- property-helper-maven-plugin:2.0:get (get-build-id) @ SingularityMesosClient ---
[INFO] 
[INFO] --- dependency-scope-maven-plugin:0.8:check (check) @ SingularityMesosClient ---
[INFO] No test dependency scope issues found
[INFO] 
[INFO] --- maven-enforcer-plugin:1.4.1:enforce (default) @ SingularityMesosClient ---
[INFO] 
[INFO] --- maven-enforcer-plugin:1.4.1:enforce (basepom-banned-dependencies) @ SingularityMesosClient ---
[INFO] 
[INFO] --- maven-dependency-versions-check-plugin:2.0.2:check (default) @ SingularityMesosClient ---
[INFO] Checking dependency versions
[INFO] 
[INFO] --- dependency-management-maven-plugin:0.8:analyze (default) @ SingularityMesosClient ---
[INFO] No dependency management issues found
[INFO] 
[INFO] --- maven-checkstyle-plugin:2.17:check (default) @ SingularityMesosClient ---
[INFO] Starting audit...
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityMesosClient/src/main/java/com/hubspot/mesos/client/MesosClient.java:13:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityMesosClient/src/main/java/com/hubspot/mesos/client/MesosClient.java:19:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityMesosClient/src/main/java/com/hubspot/mesos/client/MesosClient.java:21:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityMesosClient/src/main/java/com/hubspot/mesos/client/MesosClient.java:34:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityMesosClient/src/main/java/com/hubspot/mesos/client/MesosClient.java:36:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityMesosClient/src/main/java/com/hubspot/mesos/client/MesosClient.java:38:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityMesosClient/src/main/java/com/hubspot/mesos/client/MesosClient.java:40:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityMesosClient/src/main/java/com/hubspot/mesos/client/MesosClient.java:42:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityMesosClient/src/main/java/com/hubspot/mesos/client/MesosClient.java:44:3: Redundant 'public' modifier. [RedundantModifier]
Audit done.
[INFO] 
[INFO] --- git-commit-id-plugin:2.2.1:revision (default) @ SingularityMesosClient ---
[INFO] 
[INFO] --- jacoco-maven-plugin:0.7.6.201602180812:prepare-agent (default) @ SingularityMesosClient ---
[INFO] argLine set to -javaagent:/root/./workspace/HubSpot/Singularity/348290188/.m2/org/jacoco/org.jacoco.agent/0.7.6.201602180812/org.jacoco.agent-0.7.6.201602180812-runtime.jar=destfile=/root/workspace/HubSpot/Singularity/348290188/SingularityMesosClient/target/jacoco.exec
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:resources (default-resources) @ SingularityMesosClient ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory /root/workspace/HubSpot/Singularity/348290188/SingularityMesosClient/src/main/resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:compile (default-compile) @ SingularityMesosClient ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:testResources (default-testResources) @ SingularityMesosClient ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory /root/workspace/HubSpot/Singularity/348290188/SingularityMesosClient/src/test/resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:testCompile (default-testCompile) @ SingularityMesosClient ---
[INFO] No sources to compile
[INFO] 
[INFO] --- maven-surefire-plugin:2.19.1:test (default-test) @ SingularityMesosClient ---
[INFO] No tests to run.
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building SingularityUI 0.20.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- property-helper-maven-plugin:2.0:get (get-build-id) @ SingularityUI ---
[INFO] 
[INFO] --- dependency-scope-maven-plugin:0.8:check (check) @ SingularityUI ---
[INFO] No test dependency scope issues found
[INFO] 
[INFO] --- maven-enforcer-plugin:1.4.1:enforce (default) @ SingularityUI ---
[INFO] 
[INFO] --- maven-enforcer-plugin:1.4.1:enforce (basepom-banned-dependencies) @ SingularityUI ---
[INFO] 
[INFO] --- maven-dependency-versions-check-plugin:2.0.2:check (default) @ SingularityUI ---
[INFO] Checking dependency versions
[INFO] 
[INFO] --- dependency-management-maven-plugin:0.8:analyze (default) @ SingularityUI ---
[INFO] No dependency management issues found
[INFO] 
[INFO] --- maven-checkstyle-plugin:2.17:check (default) @ SingularityUI ---
[INFO] Starting audit...
Audit done.
[INFO] 
[INFO] --- git-commit-id-plugin:2.2.1:revision (default) @ SingularityUI ---
[INFO] 
[INFO] --- jacoco-maven-plugin:0.7.6.201602180812:prepare-agent (default) @ SingularityUI ---
[INFO] argLine set to -javaagent:/root/./workspace/HubSpot/Singularity/348290188/.m2/org/jacoco/org.jacoco.agent/0.7.6.201602180812/org.jacoco.agent-0.7.6.201602180812-runtime.jar=destfile=/root/workspace/HubSpot/Singularity/348290188/SingularityUI/target/jacoco.exec
[INFO] 
[INFO] --- frontend-maven-plugin:0.0.23:install-node-and-npm (install node and npm) @ SingularityUI ---
[INFO] Node v6.2.1 is already installed.
[INFO] Found NPM version 3.9.3
[INFO] 
[INFO] --- frontend-maven-plugin:0.0.23:npm (npm install) @ SingularityUI ---
[INFO] Running 'npm install --color=false' in /root/workspace/HubSpot/Singularity/348290188/SingularityUI
[INFO] SingularityUI@0.3.0 /root/workspace/HubSpot/Singularity/348290188/SingularityUI
[INFO] â”œâ”€â”€ UNMET PEER DEPENDENCY react@15.6.2
[INFO] â””â”€â”¬ swagger-ui@3.11.0
[INFO]   â”œâ”€â”¬ react-hot-loader@1.3.1 
[INFO]   â”‚ â”œâ”€â”€ react-hot-api@0.4.7 
[INFO]   â”‚ â””â”€â”€ source-map@0.4.4 
[INFO]   â”œâ”€â”€ UNMET PEER DEPENDENCY webpack@^2.2.0
[INFO]   â””â”€â”¬ webpack-dev-server@2.5.0 
[INFO]     â”œâ”€â”¬ bonjour@3.5.0 
[INFO]     â”‚ â”œâ”€â”€ array-flatten@2.1.1 
[INFO]     â”‚ â”œâ”€â”€ dns-equal@1.0.0 
[INFO]     â”‚ â”œâ”€â”¬ dns-txt@2.0.2 
[INFO]     â”‚ â”‚ â””â”€â”€ buffer-indexof@1.1.1 
[INFO]     â”‚ â”œâ”€â”¬ multicast-dns@6.2.3 
[INFO]     â”‚ â”‚ â”œâ”€â”¬ dns-packet@1.3.1 
[INFO]     â”‚ â”‚ â”‚ â””â”€â”€ ip@1.1.5 
[INFO]     â”‚ â”‚ â””â”€â”€ thunky@1.0.2 
[INFO]     â”‚ â””â”€â”€ multicast-dns-service-types@1.1.0 
[INFO]     â”œâ”€â”¬ del@3.0.0 
[INFO]     â”‚ â”œâ”€â”¬ globby@6.1.0 
[INFO]     â”‚ â”‚ â””â”€â”€ pify@2.3.0 
[INFO]     â”‚ â”œâ”€â”€ p-map@1.2.0 
[INFO]     â”‚ â””â”€â”€ pify@3.0.0 
[INFO]     â”œâ”€â”€ internal-ip@1.2.0 
[INFO]     â”œâ”€â”¬ portfinder@1.0.13 
[INFO]     â”‚ â””â”€â”€ async@1.5.2 
[INFO]     â”œâ”€â”¬ selfsigned@1.10.2 
[INFO]     â”‚ â””â”€â”€ node-forge@0.7.1 
[INFO]     â”œâ”€â”¬ sockjs@0.3.18 
[INFO]     â”‚ â””â”€â”€ uuid@2.0.3 
[INFO]     â”œâ”€â”¬ sockjs-client@1.1.2 
[INFO]     â”‚ â””â”€â”€ faye-websocket@0.11.1 
[INFO]     â”œâ”€â”¬ spdy@3.4.7 
[INFO]     â”‚ â”œâ”€â”€ handle-thing@1.2.5 
[INFO]     â”‚ â”œâ”€â”€ http-deceiver@1.2.7 
[INFO]     â”‚ â”œâ”€â”€ select-hose@2.0.0 
[INFO]     â”‚ â””â”€â”¬ spdy-transport@2.0.20 
[INFO]     â”‚   â”œâ”€â”€ detect-node@2.0.3 
[INFO]     â”‚   â”œâ”€â”€ hpack.js@2.1.6 
[INFO]     â”‚   â”œâ”€â”€ obuf@1.1.1 
[INFO]     â”‚   â””â”€â”¬ wbuf@1.7.2 
[INFO]     â”‚     â””â”€â”€ minimalistic-assert@1.0.0 
[INFO]     â””â”€â”¬ supports-color@3.2.3 
[INFO]       â””â”€â”€ has-flag@1.0.0 
[INFO] 
[ERROR] npm WARN optional Skipping failed optional dependency /chokidar/fsevents:
[ERROR] npm WARN notsup Not compatible with your operating system or architecture: fsevents@1.1.3
[ERROR] npm WARN commonmark-react-renderer@4.3.4 requires a peer of commonmark@^0.27.0 || ^0.26.0 || ^0.24.0 but none was installed.
[ERROR] npm WARN react-object-inspector@0.2.1 requires a peer of react@^0.14.0 but none was installed.
[ERROR] npm WARN react-addons-shallow-compare@0.14.8 requires a peer of react@^0.14.8 but none was installed.
[ERROR] npm WARN webpack-dev-server@2.5.0 requires a peer of webpack@^2.2.0 but none was installed.
[INFO] 
[INFO] --- frontend-maven-plugin:0.0.23:npm (npm test) @ SingularityUI ---
[INFO] Running 'npm test --color=false' in /root/workspace/HubSpot/Singularity/348290188/SingularityUI
[INFO] 
[INFO] > SingularityUI@0.3.0 test /root/workspace/HubSpot/Singularity/348290188/SingularityUI
[INFO] > mocha --compilers js:babel-core/register test/index.test
[INFO] 
[ERROR] Warning: Accessing PropTypes via the main React package is deprecated, and will be removed in  React v16.0. Use the latest available v15.* prop-types package from npm instead. For info on usage, compatibility, migration and more, see https://fb.me/prop-types-docs
[INFO] 
[INFO] 
[INFO]   Utils
[INFO]     getTaskDataFromTaskId()
[INFO]       âœ“ should grab all fields from a valid task id
[INFO] 
[INFO]   Reducers
[INFO]     tailerView
[INFO]       âœ“ should be properly initialized
[INFO]       âœ“ should populate the tailerId field
[INFO]       âœ“ should auto-populate the requestIds, taskIds, and paths fields
[INFO]       âœ“ should add tailer groups
[INFO]       âœ“ should remove tailer groups
[INFO]       âœ“ should pick an individual tailer group
[INFO] 
[INFO] 
[INFO]   7 passing (28ms)
[INFO] 
[INFO] 
[INFO] --- frontend-maven-plugin:0.0.23:gulp (gulp build) @ SingularityUI ---
[INFO] Running 'gulp build --no-color' in /root/workspace/HubSpot/Singularity/348290188/SingularityUI
[INFO] [16:46:45] Using gulpfile ~/workspace/HubSpot/Singularity/348290188/SingularityUI/gulpfile.js
[INFO] [16:46:45] Starting 'clean'...
[INFO] [16:46:45] Finished 'clean' after 43 ms
[INFO] [16:46:45] Starting 'static'...
[INFO] [16:46:45] Finished 'static' after 37 ms
[INFO] [16:46:45] Starting 'html'...
[INFO] [16:46:45] Finished 'html' after 19 ms
[INFO] [16:46:45] Starting 'build'...
[INFO] [16:48:58] Version: webpack [1m1.13.1[22m
[INFO] Time: [1m133195[22mms
[INFO]                                [1mAsset[22m     [1mSize[22m  [1mChunks[22m  [1m[22m           [1mChunk Names[22m
[INFO] [1m[32m89889688147bd7575d6327160d64e760.svg[39m[22m   109 kB        [1m[22m  [1m[32m[emitted][39m[22m  
[INFO]                  [1m[32mjs/vendor.bundle.js[39m[22m   613 kB       [1m0[22m  [1m[32m[emitted][39m[22m  js/vendor
[INFO]                     [1m[32mjs/app.bundle.js[39m[22m  3.54 MB       [1m1[22m  [1m[32m[emitted][39m[22m  js/app
[INFO]                          [1m[32mcss/app.css[39m[22m   377 kB       [1m1[22m  [1m[32m[emitted][39m[22m  js/app
[INFO]              [1m[32mjs/vendor.bundle.js.map[39m[22m  4.57 MB       [1m0[22m  [1m[32m[emitted][39m[22m  js/vendor
[INFO]                 [1m[32mjs/app.bundle.js.map[39m[22m  19.1 MB       [1m1[22m  [1m[32m[emitted][39m[22m  js/app
[INFO]                      [1m[32mcss/app.css.map[39m[22m   459 kB       [1m1[22m  [1m[32m[emitted][39m[22m  js/app
[INFO] Child [1mextract-text-webpack-plugin[22m:
[INFO]     
[INFO] Child [1mextract-text-webpack-plugin[22m:
[INFO]     
[INFO] Child [1mextract-text-webpack-plugin[22m:
[INFO]     
[INFO] Child [1mextract-text-webpack-plugin[22m:
[INFO]     
[INFO] Child [1mextract-text-webpack-plugin[22m:
[INFO]     
[INFO] Child [1mextract-text-webpack-plugin[22m:
[INFO]     
[INFO] Child [1mextract-text-webpack-plugin[22m:
[INFO]     
[INFO] [16:48:59] Finished 'build' after 2.22 min
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:copy-resources (copy-index.html-template) @ SingularityUI ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 1 resource
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:copy-resources (copy-ui) @ SingularityUI ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 17 resources
[INFO] 
[INFO] --- build-helper-maven-plugin:1.10:add-resource (add-generated-resources) @ SingularityUI ---
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:resources (default-resources) @ SingularityUI ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory /root/workspace/HubSpot/Singularity/348290188/SingularityUI/src/main/resources
[INFO] Copying 18 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:compile (default-compile) @ SingularityUI ---
[INFO] No sources to compile
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:testResources (default-testResources) @ SingularityUI ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory /root/workspace/HubSpot/Singularity/348290188/SingularityUI/src/test/resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:testCompile (default-testCompile) @ SingularityUI ---
[INFO] No sources to compile
[INFO] 
[INFO] --- maven-surefire-plugin:2.19.1:test (default-test) @ SingularityUI ---
[INFO] No tests to run.
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building SingularityService 0.20.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- property-helper-maven-plugin:2.0:get (get-build-id) @ SingularityService ---
[INFO] 
[INFO] --- dependency-scope-maven-plugin:0.8:check (check) @ SingularityService ---
[INFO] No test dependency scope issues found
[INFO] 
[INFO] --- maven-enforcer-plugin:1.4.1:enforce (default) @ SingularityService ---
[INFO] 
[INFO] --- maven-enforcer-plugin:1.4.1:enforce (basepom-banned-dependencies) @ SingularityService ---
[INFO] 
[INFO] --- maven-dependency-versions-check-plugin:2.0.2:check (default) @ SingularityService ---
[INFO] Checking dependency versions
[INFO] 
[INFO] --- dependency-management-maven-plugin:0.8:analyze (default) @ SingularityService ---
[INFO] No dependency management issues found
[INFO] 
[INFO] --- maven-checkstyle-plugin:2.17:check (default) @ SingularityService ---
[INFO] Starting audit...
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/config/UIConfiguration.java:22:10: Redundant 'static' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/data/zkmigrations/SingularityCmdLineArgsMigration.java:56:5: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/data/zkmigrations/SingularityRequestTypeMigration.java:83:9: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/data/zkmigrations/SingularityRequestTypeMigration.java:138:9: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/data/history/SingularityHistoryModule.java:126:5: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/data/CuratorManager.java:63:5: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/data/CuratorAsyncManager.java:45:5: Redundant 'private' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/mesos/OfferCache.java:12:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/mesos/OfferCache.java:14:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/mesos/OfferCache.java:16:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/mesos/OfferCache.java:18:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/mesos/OfferCache.java:20:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/mesos/OfferCache.java:22:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/mesos/OfferCache.java:24:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/mesos/OfferCache.java:26:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/mesos/SingularitySlaveUsageWithCalculatedScores.java:27:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/scheduler/SingularityExpiringUserActionPoller.java:174:5: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/scheduler/SingularityExpiringUserActionPoller.java:223:5: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/scheduler/SingularityExpiringUserActionPoller.java:248:5: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/scheduler/SingularityExpiringUserActionPoller.java:288:5: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/scheduler/SingularityExpiringUserActionPoller.java:314:5: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/hooks/LoadBalancerClientImpl.java:113:5: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/smtp/SmtpMailer.java:366:5: Redundant 'private' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/async/PermitSource.java:13:3: Redundant 'public' modifier. [RedundantModifier]
[WARN] /root/workspace/HubSpot/Singularity/348290188/SingularityService/src/main/java/com/hubspot/singularity/async/CompletableFutures.java:180:5: Redundant 'public' modifier. [RedundantModifier]
Audit done.
[INFO] 
[INFO] --- git-commit-id-plugin:2.2.1:revision (default) @ SingularityService ---
[INFO] 
[INFO] --- jacoco-maven-plugin:0.7.6.201602180812:prepare-agent (default) @ SingularityService ---
[INFO] argLine set to -javaagent:/root/./workspace/HubSpot/Singularity/348290188/.m2/org/jacoco/org.jacoco.agent/0.7.6.201602180812/org.jacoco.agent-0.7.6.201602180812-runtime.jar=destfile=/root/workspace/HubSpot/Singularity/348290188/SingularityService/target/jacoco.exec
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:resources (default-resources) @ SingularityService ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 9 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:compile (default-compile) @ SingularityService ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-resources-plugin:3.0.2:testResources (default-testResources) @ SingularityService ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 3 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:testCompile (default-testCompile) @ SingularityService ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-surefire-plugin:2.19.1:test (default-test) @ SingularityService ---
[INFO] Downloading: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19.1/surefire-junit4-2.19.1.pom
[INFO] Downloaded: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19.1/surefire-junit4-2.19.1.pom (4 KB at 14.3 KB/sec)
[INFO] Downloading: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-providers/2.19.1/surefire-providers-2.19.1.pom
[INFO] Downloaded: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-providers/2.19.1/surefire-providers-2.19.1.pom (3 KB at 131.7 KB/sec)
[INFO] Downloading: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19.1/surefire-junit4-2.19.1.jar
[INFO] Downloaded: https://repo.maven.apache.org/maven2/org/apache/maven/surefire/surefire-junit4/2.19.1/surefire-junit4-2.19.1.jar (74 KB at 1444.1 KB/sec)

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running com.hubspot.singularity.data.SandboxManagerTest
Running com.hubspot.singularity.scheduler.SingularitySlavePlacementTest
Running com.hubspot.singularity.SingularityAuthorizationHelperTest
Running com.hubspot.singularity.scheduler.SingularityHealthchecksTest
Running com.hubspot.singularity.scheduler.SingularityExpiringActionsTest
Running com.hubspot.singularity.SingularityHistoryTest
Running com.hubspot.singularity.data.InactiveSlaveManagerTest
Running com.hubspot.singularity.data.StateManagerTest
Running com.hubspot.singularity.mesos.SingularityMesosTaskBuilderTest
Running com.hubspot.singularity.scheduler.SingularityDeploysTest
Running com.hubspot.singularity.scheduler.SingularitySchedulerTest
Running com.hubspot.singularity.JavaUtilsTest
Running com.hubspot.singularity.scheduler.HistoryPersisterTest
Running com.hubspot.singularity.scheduler.SingularityCachedOffersTest
Running com.hubspot.singularity.data.BlendedHistoryTest
Running com.hubspot.singularity.scheduler.MesosUtilsTest
Running com.hubspot.singularity.config.MergingSourceProviderTest
Running com.hubspot.singularity.mesos.SingularityTaskShellCommandTest
Running com.hubspot.singularity.mesos.SingularityMesosOfferSchedulerTest
Running com.hubspot.singularity.scheduler.SingularityUsageTest
Running com.hubspot.singularity.SingularityS3Test
Running com.hubspot.singularity.scheduler.SingularityMachineStatesTest
Running com.hubspot.singularity.data.zkmigrations.ZkMigrationTest
Running com.hubspot.singularity.mesos.SingularityStartupTest
Running com.hubspot.singularity.helpers.RFC5545ScheduleTest
Running com.hubspot.singularity.data.ValidatorTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.105 sec - in com.hubspot.singularity.SingularityS3Test
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.708 sec - in com.hubspot.singularity.helpers.RFC5545ScheduleTest
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 5.357 sec - in com.hubspot.singularity.scheduler.MesosUtilsTest
16:49:28.276 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:28.332 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @9691ms
16:49:28.419 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:28.447 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @9795ms
16:49:28.475 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:28.504 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @9847ms
16:49:28.511 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@d5ce7ff
16:49:28.550 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@4515e059{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@5eea83f4,MANAGED}
16:49:28.546 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@e32b90b
16:49:28.562 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@50554bf8
16:49:28.583 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@7db7c691{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@5fc16175,MANAGED}
16:49:28.586 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@14f1161e
16:49:28.581 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@20f54cbd
16:49:28.588 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@53484ab2{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@70df49d7,MANAGED}
16:49:28.588 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@7d5065e5{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@1692404a,MANAGED}
16:49:28.631 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@623496b9{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@77cab449,MANAGED}
16:49:28.635 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@2453d708
16:49:28.644 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@a9d9b9e{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@2ac7433c,MANAGED}
16:49:28.672 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@70df49d7 added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:28.721 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@1692404a added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:28.726 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@70df49d7 added {[/tasks/*]=>tasks,POJO}
16:49:28.759 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@1692404a added {[/tasks/*]=>tasks,POJO}
16:49:28.798 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@2ac7433c added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:28.804 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:28.821 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @10175ms
16:49:28.812 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@2ac7433c added {[/tasks/*]=>tasks,POJO}
16:49:28.836 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:28.852 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @10201ms
16:49:28.873 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@1d56b47b
16:49:28.908 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@d9a6040{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@2d3aa3e4,MANAGED}
16:49:28.912 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@1afcfc8e
16:49:28.916 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@6a8bc681
16:49:28.920 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@49d0ad54{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@56e03bd8,MANAGED}
16:49:28.940 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@7ec32488{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@30a9fbc0,MANAGED}
16:49:28.944 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@63c648a5
16:49:28.945 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@2f3967bc{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@59a2045,MANAGED}
16:49:28.975 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@56e03bd8 added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:28.980 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@56e03bd8 added {[/tasks/*]=>tasks,POJO}
16:49:29.001 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@59a2045 added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:28.988 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:29.007 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@59a2045 added {[/tasks/*]=>tasks,POJO}
16:49:29.014 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @10360ms
16:49:29.049 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@25cb8c6b
16:49:29.071 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:29.082 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@b0edc63{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@eeaa9e9,MANAGED}
16:49:29.086 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@5548d5fa
16:49:29.088 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@5e0ec4fc{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@ab1c350,MANAGED}
16:49:29.098 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @10447ms
16:49:29.164 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@ab1c350 added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:29.169 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@ab1c350 added {[/tasks/*]=>tasks,POJO}
16:49:29.176 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@54516f47
16:49:29.234 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@111613da{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@51d297fe,MANAGED}
16:49:29.256 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@197b06c6
16:49:29.257 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@52bb842f{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@5867828e,MANAGED}
16:49:29.392 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:29.405 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @10752ms
16:49:29.364 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@5867828e added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:29.420 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:29.433 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@5867828e added {[/tasks/*]=>tasks,POJO}
16:49:29.442 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @10784ms
16:49:29.440 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:29.452 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@fef37d9
16:49:29.472 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @10818ms
16:49:29.475 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@7d17b36b{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@e056c62,MANAGED}
16:49:29.479 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@72155364
16:49:29.492 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@6617f6f5{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@18a955cf,MANAGED}
16:49:29.494 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@14b0d9b6
16:49:29.522 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@35834e8{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@5d9aecf9,MANAGED}
16:49:29.527 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@520d7245
16:49:29.528 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@33acd854{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@4f67d7db,MANAGED}
16:49:29.577 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@47ef660e
16:49:29.583 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@18a955cf added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:29.593 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@4f67d7db added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:29.601 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@4f67d7db added {[/tasks/*]=>tasks,POJO}
16:49:29.604 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@18a955cf added {[/tasks/*]=>tasks,POJO}
16:49:29.607 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@5175b0fd{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@4662fd95,MANAGED}
16:49:29.611 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@5df84b80
16:49:29.612 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@55e9e3ef{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@6fa79d23,MANAGED}
16:49:29.595 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:29.613 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:29.630 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @10971ms
16:49:29.631 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @10974ms
16:49:29.631 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:29.680 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@34909647
16:49:29.689 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@6fa79d23 added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:29.700 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @11057ms
16:49:29.682 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:29.717 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@6fa79d23 added {[/tasks/*]=>tasks,POJO}
16:49:29.722 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @11065ms
16:49:29.725 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@5be4a5c1{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@592fb29c,MANAGED}
16:49:29.729 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@2329fda3
16:49:29.730 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@3cf56e6{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@f818093,MANAGED}
16:49:29.746 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@38894988
16:49:29.764 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@70bb3300
16:49:29.763 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:29.788 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@560c534a{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@100da584,MANAGED}
16:49:29.793 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@2462c0a0
16:49:29.794 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@7576b4de{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@7892f070,MANAGED}
16:49:29.797 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@1b21e23e{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@4622f77c,MANAGED}
16:49:29.800 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@4807e6a2
16:49:29.789 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @11125ms
16:49:29.815 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@2d200b88
16:49:29.819 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@382b572e{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@3b948af9,MANAGED}
16:49:29.868 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@f818093 added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:29.874 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@7ea262e1{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@1499305a,MANAGED}
16:49:29.882 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@f818093 added {[/tasks/*]=>tasks,POJO}
16:49:29.883 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@4dadb372
16:49:29.887 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@3582771c{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@159294a4,MANAGED}
16:49:29.894 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@3b948af9 added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:29.916 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@7892f070 added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:29.891 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@368cd464
16:49:29.921 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@7892f070 added {[/tasks/*]=>tasks,POJO}
16:49:29.930 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@3b948af9 added {[/tasks/*]=>tasks,POJO}
16:49:29.976 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:29.995 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@159294a4 added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:29.987 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@11a4ca7c{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@4fa91aac,MANAGED}
16:49:30.002 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@2fb8852f
16:49:30.003 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@4394361e{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@6fdb88dc,MANAGED}
16:49:30.002 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @11351ms
16:49:30.028 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@159294a4 added {[/tasks/*]=>tasks,POJO}
16:49:30.065 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@6fdb88dc added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:30.084 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:30.082 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@6fdb88dc added {[/tasks/*]=>tasks,POJO}
16:49:30.095 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@57e15001
16:49:30.114 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @11473ms
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 9.01 sec - in com.hubspot.singularity.JavaUtilsTest
16:49:30.144 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@38e6874a{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@18ffae1a,MANAGED}
16:49:30.155 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@11aeb47e
16:49:30.157 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@2b820ce9{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@673584a,MANAGED}
16:49:30.211 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@43c0f32a
16:49:30.241 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@778fd5fe{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@5c879e8e,MANAGED}
16:49:30.245 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@7bb68601
16:49:30.246 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@59d7b41c{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@6cdd10b,MANAGED}
16:49:30.298 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@6cdd10b added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:30.266 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:30.295 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@673584a added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:30.315 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @11673ms
16:49:30.325 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@6cdd10b added {[/tasks/*]=>tasks,POJO}
16:49:30.334 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@673584a added {[/tasks/*]=>tasks,POJO}
16:49:30.460 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@7b1e9d44
16:49:30.504 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@75d3fc3c{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@b3c61e3,MANAGED}
16:49:30.526 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@57e81698
16:49:30.527 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@5ccd20ef{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@5fcaf38c,MANAGED}
16:49:30.616 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@5fcaf38c added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:30.622 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@5fcaf38c added {[/tasks/*]=>tasks,POJO}
16:49:30.868 [Time-limited test] DEBUG org.eclipse.jetty.util.log - Logging to Logger[org.eclipse.jetty.util.log] via org.eclipse.jetty.util.log.Slf4jLog
16:49:30.882 [Time-limited test] INFO org.eclipse.jetty.util.log - Logging initialized @12236ms
16:49:30.980 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@7103fe0
16:49:31.002 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@2cab3a9e{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@4bcc5f18,MANAGED}
16:49:31.013 [Time-limited test] DEBUG org.eclipse.jetty.util.DecoratedObjectFactory - Adding Decorator: org.eclipse.jetty.util.DeprecationWarning@2fb8cf22
16:49:31.024 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - i.d.j.MutableServletContextHandler@3fc21eb7{/,null,null} added {org.eclipse.jetty.servlet.ServletHandler@3623c0f1,MANAGED}
16:49:31.088 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@3623c0f1 added {tasks@6907b8e==io.dropwizard.servlets.tasks.TaskServlet,jsp=null,order=1,inst=true,AUTO}
16:49:31.107 [Time-limited test] DEBUG org.eclipse.jetty.util.component.ContainerLifeCycle - org.eclipse.jetty.servlet.ServletHandler@3623c0f1 added {[/tasks/*]=>tasks,POJO}
Tests run: 5, Failures: 0, Errors: 5, Skipped: 0, Time elapsed: 10.797 sec <<< FAILURE! - in com.hubspot.singularity.mesos.SingularityMesosOfferSchedulerTest
itCorrectlyUsesDefaults(com.hubspot.singularity.mesos.SingularityMesosOfferSchedulerTest)  Time elapsed: 0.021 sec  <<< ERROR!
org.mockito.exceptions.base.MockitoException: 

Cannot mock/spy class com.hubspot.singularity.api.task.SingularityPendingTask
Mockito cannot mock/spy because :
 - final class
	at com.hubspot.singularity.mesos.SingularityMesosOfferSchedulerTest.<init>(SingularityMesosOfferSchedulerTest.java:87)

itCorrectlyScoresMediumLongNonLongRunningTasks(com.hubspot.singularity.mesos.SingularityMesosOfferSchedulerTest)  Time elapsed: 0.001 sec  <<< ERROR!
org.mockito.exceptions.base.MockitoException: 

Cannot mock/spy class com.hubspot.singularity.api.task.SingularityPendingTask
Mockito cannot mock/spy because :
 - final class
	at com.hubspot.singularity.mesos.SingularityMesosOfferSchedulerTest.<init>(SingularityMesosOfferSchedulerTest.java:87)

itCorrectlyScoresLongRunningTasks(com.hubspot.singularity.mesos.SingularityMesosOfferSchedulerTest)  Time elapsed: 0.001 sec  <<< ERROR!
org.mockito.exceptions.base.MockitoException: 

Cannot mock/spy class com.hubspot.singularity.api.task.SingularityPendingTask
Mockito cannot mock/spy because :
 - final class
	at com.hubspot.singularity.mesos.SingularityMesosOfferSchedulerTest.<init>(SingularityMesosOfferSchedulerTest.java:87)

itCorrectlyScoresLongNonLongRunningTasks(com.hubspot.singularity.mesos.SingularityMesosOfferSchedulerTest)  Time elapsed: 0 sec  <<< ERROR!
org.mockito.exceptions.base.MockitoException: 

Cannot mock/spy class com.hubspot.singularity.api.task.SingularityPendingTask
Mockito cannot mock/spy because :
 - final class
	at com.hubspot.singularity.mesos.SingularityMesosOfferSchedulerTest.<init>(SingularityMesosOfferSchedulerTest.java:87)

itAccountsForExpectedTaskUsage(com.hubspot.singularity.mesos.SingularityMesosOfferSchedulerTest)  Time elapsed: 0.001 sec  <<< ERROR!
org.mockito.exceptions.base.MockitoException: 

Cannot mock/spy class com.hubspot.singularity.api.task.SingularityPendingTask
Mockito cannot mock/spy because :
 - final class
	at com.hubspot.singularity.mesos.SingularityMesosOfferSchedulerTest.<init>(SingularityMesosOfferSchedulerTest.java:87)

Tests run: 15, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 11.913 sec - in com.hubspot.singularity.SingularityAuthorizationHelperTest
Tests run: 9, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 13.392 sec - in com.hubspot.singularity.mesos.SingularityMesosTaskBuilderTest
16:49:45.072 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:45.237 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:45.496 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:45.548 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:45.583 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:45.707 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:45.834 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:45.868 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:45.963 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:46.079 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:46.194 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:46.248 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:46.361 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 25.17 sec - in com.hubspot.singularity.data.BlendedHistoryTest
16:49:46.502 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:46.776 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:47.427 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:47.617 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:49:47.634 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:47.821 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 26.578 sec - in com.hubspot.singularity.config.MergingSourceProviderTest
16:49:47.924 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1519998586404-1-host1-rack1
16:49:48.106 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1519998588017-1-host1-rack1
16:49:48.208 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1519998588140-1-host1-rack1
16:49:48.287 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1519998588234-1-host1-rack1
16:49:48.350 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1519998588309-1-host1-rack1
16:49:48.399 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1519998588363-1-host1-rack1
16:49:48.450 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1519998588414-1-host1-rack1
16:49:48.459 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009386792-1-host1-rack1
16:49:48.501 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1519998588462-1-host1-rack1
16:49:48.530 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009388491-1-host1-rack1
16:49:48.536 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1519998588511-1-host1-rack1
16:49:48.581 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1519998588547-1-host1-rack1
16:49:48.813 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.utils.ZKPaths.mkdirs(ZKPaths.java:232)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:702)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:49:48.999 [Time-limited test] WARN com.hubspot.singularity.scheduler.SingularityLeaderCache - savePendingTask SingularityPendingTask{user=Optional.empty, pendingTaskId=r1-d1-23-3-BOUNCE-1, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}, but not active
16:49:49.032 [Time-limited test] WARN com.hubspot.singularity.scheduler.SingularityLeaderCache - savePendingTask SingularityPendingTask{user=Optional.empty, pendingTaskId=r2-d3-231-1-UNPAUSED-23, cmdLineArgsList=Optional[[cmd line args]], runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}, but not active
16:49:49.062 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:49.078 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Not rewriting path r2-de, already correct
16:49:49.079 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Not rewriting path r1-d1, already correct
16:49:49.080 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Applied PendingRequestDataMigration to 0 requests in 00:00.018
16:49:49.105 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:49.209 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 28.293 sec - in com.hubspot.singularity.data.StateManagerTest
16:49:49.300 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:49.538 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 28.621 sec - in com.hubspot.singularity.data.InactiveSlaveManagerTest
16:49:49.589 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:49.652 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:49.699 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:49.761 [healthcheck-pool-0] WARN com.hubspot.singularity.scheduler.SingularityHealthchecker - Couldn't find a port for health check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='retry_test', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional.empty, startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional[2], failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-retry_test-1520009386573-1-IMMEDIATE-1520009386573, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer316}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-retry_test-1520009386573-1-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}
16:49:49.768 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while saving health check result for test-request-retry_test-1520009386573-1-host1-rack1, will re-enqueue
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.TaskManager.canSaveNewHealthcheck(TaskManager.java:329)
	at com.hubspot.singularity.data.TaskManager.saveHealthcheckResult(TaskManager.java:318)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:83)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 15 common frames omitted
16:49:49.772 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while re-enqueuing health check for test-request-retry_test-1520009386573-1-host1-rack1, aborting
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.getChildren(CuratorManager.java:137)
	at com.hubspot.singularity.data.TaskManager.getNumNonstartupHealthchecks(TaskManager.java:518)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheck(SingularityHealthchecker.java:98)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.reEnqueueOrAbort(SingularityHealthchecker.java:203)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:108)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.getChildren(CuratorFrameworkImpl.java:379)
	at com.hubspot.singularity.data.CuratorManager.getChildren(CuratorManager.java:130)
	... 15 common frames omitted
16:49:49.966 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:50.006 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.utils.ZKPaths.mkdirs(ZKPaths.java:232)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:702)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:49:50.021 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:50.040 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009389718-1-host1-rack1
16:49:50.099 [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:36079] WARN org.apache.zookeeper.server.NIOServerCnxn - caught end of stream exception
org.apache.zookeeper.server.ServerCnxn$EndOfStreamException: Unable to read additional data from client sessionid 0x161e79ea14e0000, likely client has closed socket
	at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:228)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:208)
	at java.lang.Thread.run(Thread.java:745)
16:49:50.174 [Time-limited test] WARN com.hubspot.singularity.data.history.SingularityRequestHistoryPersister - Failed to persist SingularityRequestHistory{createdAt=1519998590131, user=Optional.empty, eventType=CREATED, request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, message=Optional.empty} into History
java.lang.UnsupportedOperationException: NoopHistoryManager can not save
	at com.hubspot.singularity.data.history.NoopHistoryManager.saveRequestHistoryUpdate(NoopHistoryManager.java:26)
	at com.hubspot.singularity.data.history.SingularityRequestHistoryPersister.moveToHistory(SingularityRequestHistoryPersister.java:141)
	at com.hubspot.singularity.data.history.SingularityRequestHistoryPersister.moveToHistory(SingularityRequestHistoryPersister.java:25)
	at com.hubspot.singularity.data.history.SingularityHistoryPersister.moveToHistoryOrCheckForPurgeAndShouldDelete(SingularityHistoryPersister.java:63)
	at com.hubspot.singularity.data.history.SingularityHistoryPersister.moveToHistoryOrCheckForPurge(SingularityHistoryPersister.java:52)
	at com.hubspot.singularity.data.history.SingularityRequestHistoryPersister.runActionOnPoll(SingularityRequestHistoryPersister.java:119)
	at com.hubspot.singularity.scheduler.HistoryPersisterTest.testPurgingDoesntApplyIfDatabasePresent(HistoryPersisterTest.java:211)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:745)
16:49:50.228 [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:45790] WARN org.apache.zookeeper.server.NIOServerCnxn - caught end of stream exception
org.apache.zookeeper.server.ServerCnxn$EndOfStreamException: Unable to read additional data from client sessionid 0x161e79ea1970000, likely client has closed socket
	at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:228)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:208)
	at java.lang.Thread.run(Thread.java:745)
16:49:50.341 [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:45561] WARN org.apache.zookeeper.server.NIOServerCnxn - caught end of stream exception
org.apache.zookeeper.server.ServerCnxn$EndOfStreamException: Unable to read additional data from client sessionid 0x161e79ea28d0000, likely client has closed socket
	at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:228)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:208)
	at java.lang.Thread.run(Thread.java:745)
16:49:50.346 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
[oneOffRequest-oneOffDeploy1520009390321, immediateRequest-immediateDeploy, newDeployRequest-newDeploy]
16:49:50.363 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:50.365 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Not rewriting path oneOffRequest-oneOffDeploy1520009390321, already correct
16:49:50.366 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Rewriting path immediateRequest-immediateDeploy to immediateRequest-immediateDeploy1520009390321
16:49:50.372 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Not rewriting path newDeployRequest-newDeploy, already correct
16:49:50.372 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Applied PendingRequestDataMigration to 1 requests in 00:00.009
[oneOffRequest-oneOffDeploy1520009390321, immediateRequest-immediateDeploy1520009390321, newDeployRequest-newDeploy]
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 28.866 sec - in com.hubspot.singularity.data.zkmigrations.ZkMigrationTest
16:49:50.681 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:49:50.740 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009390413-1-host1-rack1
16:49:50.845 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:50.902 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:50.959 [Time-limited test] WARN com.hubspot.singularity.mesos.SingularityMesosScheduler - Lost a slave value: "slave1"

16:49:50.995 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:51.000 [Time-limited test] WARN com.hubspot.singularity.mesos.SingularityMesosScheduler - Lost a slave value: "slave1"

16:49:51.008 [Time-limited test] WARN com.hubspot.singularity.mesos.SingularityMesosScheduler - Lost a slave value: "slave1"

16:49:51.168 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009390911-1-host1-rack1
16:49:51.170 [status-updates-0] WARN com.hubspot.singularity.scheduler.SingularityScheduler - Not scheduling a new task, test-request is PAUSED
16:49:51.219 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:703)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:49:51.235 [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:46080] WARN org.apache.zookeeper.server.NIOServerCnxnFactory - Ignoring unexpected runtime exception
java.nio.channels.CancelledKeyException: null
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:187)
	at java.lang.Thread.run(Thread.java:745)
16:49:51.301 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:51.304 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:51.320 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:51.468 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:51.540 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:51.568 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:51.644 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:51.651 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009391500-1-host1-rack1
16:49:51.865 [Time-limited test-EventThread] ERROR com.hubspot.singularity.SingularityLeaderLatch - Can't find our node. Resetting. Index: -1
16:49:51.876 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:49:52.059 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:52.191 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:52.365 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 31.14 sec - in com.hubspot.singularity.mesos.SingularityTaskShellCommandTest
16:49:52.648 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-10000-1-host1-rack1
16:49:52.675 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-2-firstDeployId-15000-1-host1-rack1
16:49:52.674 [healthcheck-pool-0] WARN com.hubspot.singularity.scheduler.SingularityHealthchecker - Couldn't find a port for health check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional.empty, startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional.empty, failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009390649-1-IMMEDIATE-1520009390649, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer118}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009390649-1-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}
16:49:52.675 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while saving health check result for test-request-firstDeployId-1520009390649-1-host1-rack1, will re-enqueue
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.TaskManager.canSaveNewHealthcheck(TaskManager.java:329)
	at com.hubspot.singularity.data.TaskManager.saveHealthcheckResult(TaskManager.java:318)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:83)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 15 common frames omitted
16:49:52.677 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while re-enqueuing health check for test-request-firstDeployId-1520009390649-1-host1-rack1, aborting
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@6e443e65 rejected from java.util.concurrent.ScheduledThreadPoolExecutor@6083dddd[Shutting down, pool size = 2, active threads = 1, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2047)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:823)
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326)
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheckWithDelay(SingularityHealthchecker.java:184)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheck(SingularityHealthchecker.java:103)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.reEnqueueOrAbort(SingularityHealthchecker.java:203)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:108)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
16:49:52.684 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave3 for task test-request-2-firstDeployId-35000-3-host3-rack1
16:49:52.704 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave2 for task test-request-2-firstDeployId-25000-2-host2-rack1
16:49:52.805 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:52.809 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave2 for task test-request-firstDeployId-20000-2-host2-rack1
16:49:52.823 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave3 for task test-request-firstDeployId-30000-3-host3-rack1
16:49:52.831 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:52.844 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave7 for task test-request-2-firstDeployId-70000-7-host7-rack1
16:49:52.979 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:52.993 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:53.012 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:53.078 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:49:53.152 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:53.185 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:53.427 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 32.233 sec - in com.hubspot.singularity.scheduler.SingularityCachedOffersTest
16:49:53.551 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:1040)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:1073)
	at org.apache.curator.utils.ZKPaths.mkdirs(ZKPaths.java:215)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:702)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 33.206 sec - in com.hubspot.singularity.data.SandboxManagerTest
16:49:53.856 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:54.128 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:54.231 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:49:54.239 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:54.261 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:54.438 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:54.458 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:54.500 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1519998594287-1-host1-rack1
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 32.895 sec - in com.hubspot.singularity.mesos.SingularityStartupTest
16:49:54.847 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:54.862 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:55.021 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:55.031 [Time-limited test] WARN com.hubspot.singularity.mesos.SingularityMesosScheduler - Not using custom executor, will not send framework message to destroy task
16:49:55.041 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009394983-2-host1-rack1
[]
16:49:55.361 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:49:55.475 [check-new-task-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityNewTaskChecker - Uncaught throwable in task check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[true], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional.empty, skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1519998594444-2-IMMEDIATE-1519998594444, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer104}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1519998594444-2-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}, re-enqueing
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.DisasterManager.isDisabled(DisasterManager.java:55)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.hasHealthcheck(SingularityNewTaskChecker.java:96)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.getTaskState(SingularityNewTaskChecker.java:313)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.checkTask(SingularityNewTaskChecker.java:254)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.lambda$getTaskCheck$0(SingularityNewTaskChecker.java:209)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 13 common frames omitted
16:49:55.479 [check-new-task-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityNewTaskChecker - Uncaught throwable re-enqueuing task check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[true], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional.empty, skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1519998594444-2-IMMEDIATE-1519998594444, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer104}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1519998594444-2-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}, aborting
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@6e37da2a rejected from java.util.concurrent.ScheduledThreadPoolExecutor@8829760[Shutting down, pool size = 2, active threads = 1, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2047)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:823)
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326)
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.enqueueCheckWithDelay(SingularityNewTaskChecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.reEnqueueCheck(SingularityNewTaskChecker.java:236)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.reEnqueueCheckOrAbort(SingularityNewTaskChecker.java:227)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.lambda$getTaskCheck$0(SingularityNewTaskChecker.java:220)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
16:49:55.630 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:55.701 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:55.727 [Time-limited test] WARN com.hubspot.singularity.scheduler.SingularityDeployChecker - Deploy SingularityPendingDeploy{deployMarker=SingularityDeployMarker{requestId='test-request', deployId='timeout_test', timestamp=1520005795649, user=Optional.empty, message=Optional.empty}, lastLoadBalancerUpdate=Optional.empty, currentDeployState=WAITING, deployProgress=Optional[SingularityIncrementalDeployProgress{targetActiveInstances=1, currentActiveInstances=0, deployInstanceCountPerStep=1, deployStepWaitTimeMs=10, stepComplete=false, autoAdvanceDeploySteps=true, failedDeployTasks=[], timestamp=1520005795649}], updatedRequest=Optional.empty} is overdue (duration: 01:00:00.078), allowed: 00:01:00.000
16:49:56.030 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:56.225 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:56.345 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:56.482 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:49:56.520 [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:39738] WARN org.apache.zookeeper.server.NIOServerCnxn - caught end of stream exception
org.apache.zookeeper.server.ServerCnxn$EndOfStreamException: Unable to read additional data from client sessionid 0x161e79ebc080000, likely client has closed socket
	at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:228)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:208)
	at java.lang.Thread.run(Thread.java:745)
16:49:56.646 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
Tests run: 6, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 35.569 sec - in com.hubspot.singularity.scheduler.HistoryPersisterTest
16:49:56.870 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:56.980 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:57.020 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:57.198 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:57.608 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:49:57.642 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:57.649 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:58.171 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:58.365 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:58.496 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:58.517 [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:33173] WARN org.apache.zookeeper.server.NIOServerCnxn - caught end of stream exception
org.apache.zookeeper.server.ServerCnxn$EndOfStreamException: Unable to read additional data from client sessionid 0x161e79ec4030000, likely client has closed socket
	at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:228)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:208)
	at java.lang.Thread.run(Thread.java:745)
16:49:58.634 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009398550-1-host1-rack1
16:49:58.833 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:58.884 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:59.263 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:59.489 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:59.529 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:59.652 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:49:59.790 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009399682-1-host1-rack1
16:49:59.800 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:00.013 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:00.039 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:50:00.111 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:00.376 [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:43398] WARN org.apache.zookeeper.server.NIOServerCnxn - caught end of stream exception
org.apache.zookeeper.server.ServerCnxn$EndOfStreamException: Unable to read additional data from client sessionid 0x161e79ec99e0000, likely client has closed socket
	at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:228)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:208)
	at java.lang.Thread.run(Thread.java:745)
16:50:00.665 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:00.781 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:01.025 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:01.161 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:50:01.181 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:01.285 [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:44196] WARN org.apache.zookeeper.server.NIOServerCnxn - caught end of stream exception
org.apache.zookeeper.server.ServerCnxn$EndOfStreamException: Unable to read additional data from client sessionid 0x161e79ece5b0000, likely client has closed socket
	at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:228)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:208)
	at java.lang.Thread.run(Thread.java:745)
16:50:01.349 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:01.516 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:01.647 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:02.018 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:02.119 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 40.809 sec - in com.hubspot.singularity.scheduler.SingularityUsageTest
16:50:02.283 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:50:02.665 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:02.852 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:02.910 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:03.062 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while saving health check result for test-request-firstDeployId-1520009400880-2-host1-DEFAULT, will re-enqueue
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.TaskManager.canSaveNewHealthcheck(TaskManager.java:329)
	at com.hubspot.singularity.data.TaskManager.saveHealthcheckResult(TaskManager.java:318)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:83)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:302)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 15 common frames omitted
16:50:03.063 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while re-enqueuing health check for test-request-firstDeployId-1520009400880-2-host1-DEFAULT, aborting
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@18bc926d rejected from java.util.concurrent.ScheduledThreadPoolExecutor@2deaf501[Shutting down, pool size = 2, active threads = 1, queued tasks = 0, completed tasks = 1]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2047)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:823)
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326)
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheckWithDelay(SingularityHealthchecker.java:184)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheck(SingularityHealthchecker.java:103)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.reEnqueueOrAbort(SingularityHealthchecker.java:203)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:108)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:302)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 42.367 sec - in com.hubspot.singularity.scheduler.SingularityExpiringActionsTest
16:50:03.410 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:50:03.418 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:03.571 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009403446-1-host1-rack1
16:50:03.572 [status-updates-0] WARN com.hubspot.singularity.scheduler.SingularityScheduler - Not scheduling a new task, test-request is PAUSED
16:50:03.875 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:03.912 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:04.128 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
Tests run: 12, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 43.665 sec - in com.hubspot.singularity.scheduler.SingularitySlavePlacementTest
16:50:04.220 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:04.358 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1-1-host1-rack1
16:50:04.366 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:04.370 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave2 for task test-request-firstDeployId-2-2-host2-rack1
16:50:04.378 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave6 for task test-request-secondDeployId-6-6-host6-rack1
16:50:04.384 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave4 for task test-request-secondDeployId-4-4-host4-rack1
16:50:04.391 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave3 for task test-request-firstDeployId-3-3-host3-rack1
16:50:04.398 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave5 for task test-request-secondDeployId-5-5-host5-rack1
16:50:04.404 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave7 for task test-request-secondDeployId-7-7-host7-rack1
16:50:04.534 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:50:04.767 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:04.897 [Time-limited test] WARN com.hubspot.singularity.mesos.SingularityMesosScheduler - Not using custom executor, will not send framework message to destroy task
16:50:04.901 [Time-limited test] WARN com.hubspot.singularity.scheduler.SingularityCleaner - All tasks for requestId test-request are now killed, re-enqueueing request cleanup
16:50:04.909 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009404797-1-host1-rack1
16:50:04.911 [status-updates-0] WARN com.hubspot.singularity.scheduler.SingularityScheduler - Not scheduling a new task, test-request is DELETING
16:50:05.038 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:05.586 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:05.665 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
16:50:05.737 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:05.831 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-10000-1-host1-rack1
16:50:05.843 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave2 for task test-request-firstDeployId-20000-2-host2-rack1
16:50:05.853 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009405799-1-host1-rack1
16:50:05.855 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave6 for task test-request-secondDeployId-60000-6-host6-rack1
16:50:05.864 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave4 for task test-request-secondDeployId-40000-4-host4-rack1
16:50:05.883 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009405868-1-host1-rack1
16:50:05.921 [check-new-task-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityNewTaskChecker - Uncaught throwable in task check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional[2], skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional[81], protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional[0], startupIntervalSeconds=Optional.empty, intervalSeconds=Optional[0], responseTimeoutSeconds=Optional.empty, maxRetries=Optional.empty, failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009400795-2-UPDATED_REQUEST-1520009400761, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer667}, allOtherFields={url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009400880-2-host1-DEFAULT}, executor=null, labels=MesosLabels{labels=[]}, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[MesosResourceObject{name=cpus, ranges=null, allOtherFields={scalar={value=1.0}, type=SCALAR}}, MesosResourceObject{name=mem, ranges=null, allOtherFields={scalar={value=128.0}, type=SCALAR}}, MesosResourceObject{name=disk, ranges=null, allOtherFields={scalar={value=1024.0}, type=SCALAR}}], allOtherFields={command={uris=[], environment={variables=[{name=TASK_DEPLOY_ID, value=firstDeployId}, {name=INSTANCE_NO, value=2}, {name=TASK_REQUEST_ID, value=test-request}, {name=AVAILABILITY_ZONE, value=DEFAULT}, {name=ESTIMATED_INSTANCE_COUNT, value=2}, {name=TASK_HOST, value=host1}, {name=TASK_RACK_ID, value=DEFAULT}, {name=TASK_ID, value=test-request-firstDeployId-1520009400880-2-host1-DEFAULT}]}, value=sleep 100, arguments=[]}}, name=test-request}, rackId=Optional[DEFAULT]}, re-enqueing
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.DisasterManager.isDisabled(DisasterManager.java:55)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.hasHealthcheck(SingularityNewTaskChecker.java:96)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.getTaskState(SingularityNewTaskChecker.java:313)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.checkTask(SingularityNewTaskChecker.java:254)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.lambda$getTaskCheck$0(SingularityNewTaskChecker.java:209)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 13 common frames omitted
16:50:05.924 [check-new-task-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityNewTaskChecker - Uncaught throwable re-enqueuing task check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional[2], skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional[81], protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional[0], startupIntervalSeconds=Optional.empty, intervalSeconds=Optional[0], responseTimeoutSeconds=Optional.empty, maxRetries=Optional.empty, failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009400795-2-UPDATED_REQUEST-1520009400761, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer667}, allOtherFields={url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009400880-2-host1-DEFAULT}, executor=null, labels=MesosLabels{labels=[]}, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[MesosResourceObject{name=cpus, ranges=null, allOtherFields={scalar={value=1.0}, type=SCALAR}}, MesosResourceObject{name=mem, ranges=null, allOtherFields={scalar={value=128.0}, type=SCALAR}}, MesosResourceObject{name=disk, ranges=null, allOtherFields={scalar={value=1024.0}, type=SCALAR}}], allOtherFields={command={uris=[], environment={variables=[{name=TASK_DEPLOY_ID, value=firstDeployId}, {name=INSTANCE_NO, value=2}, {name=TASK_REQUEST_ID, value=test-request}, {name=AVAILABILITY_ZONE, value=DEFAULT}, {name=ESTIMATED_INSTANCE_COUNT, value=2}, {name=TASK_HOST, value=host1}, {name=TASK_RACK_ID, value=DEFAULT}, {name=TASK_ID, value=test-request-firstDeployId-1520009400880-2-host1-DEFAULT}]}, value=sleep 100, arguments=[]}}, name=test-request}, rackId=Optional[DEFAULT]}, aborting
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@5f76cf58 rejected from java.util.concurrent.ScheduledThreadPoolExecutor@5b49506e[Shutting down, pool size = 2, active threads = 1, queued tasks = 0, completed tasks = 1]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2047)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:823)
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326)
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.enqueueCheckWithDelay(SingularityNewTaskChecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.reEnqueueCheck(SingularityNewTaskChecker.java:236)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.reEnqueueCheckOrAbort(SingularityNewTaskChecker.java:227)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.lambda$getTaskCheck$0(SingularityNewTaskChecker.java:220)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
16:50:05.933 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave3 for task test-request-firstDeployId-30000-3-host3-rack1
16:50:05.943 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave5 for task test-request-secondDeployId-50000-5-host5-rack1
16:50:05.952 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave7 for task test-request-secondDeployId-70000-7-host7-rack1
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 45.097 sec - in com.hubspot.singularity.SingularityHistoryTest
16:50:06.069 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:06.205 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:06.799 [Time-limited test-EventThread] ERROR com.hubspot.singularity.SingularityLeaderLatch - Can't find our node. Resetting. Index: -1
16:50:06.802 [SingularityStatePoller] ERROR com.hubspot.singularity.SingularityLeaderController - Caught exception while saving state
java.lang.RuntimeException: java.lang.InterruptedException
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:118)
	at com.hubspot.singularity.SingularityLeaderController$StatePoller.run(SingularityLeaderController.java:199)
Caused by: java.lang.InterruptedException: null
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:502)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1342)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:781)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:696)
	at org.apache.curator.framework.imps.CreateBuilderImpl$11.call(CreateBuilderImpl.java:679)
	at org.apache.curator.RetryLoop.callWithRetry(RetryLoop.java:107)
	at org.apache.curator.framework.imps.CreateBuilderImpl.pathInForeground(CreateBuilderImpl.java:676)
	at org.apache.curator.framework.imps.CreateBuilderImpl.protectedPathInForeground(CreateBuilderImpl.java:453)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:443)
	at org.apache.curator.framework.imps.CreateBuilderImpl.forPath(CreateBuilderImpl.java:44)
	at com.hubspot.singularity.data.StateManager.save(StateManager.java:115)
	... 1 common frames omitted
Tests run: 18, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 45.017 sec - in com.hubspot.singularity.data.ValidatorTest
16:50:07.036 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:07.353 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:07.387 [healthcheck-pool-0] WARN com.hubspot.singularity.scheduler.SingularityHealthchecker - Couldn't find a port for health check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional.empty, startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional.empty, failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009404298-1-IMMEDIATE-1520009404298, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer797}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009404298-1-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}
16:50:07.437 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009404298-1-host1-rack1
16:50:08.377 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:08.631 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:08.687 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:09.417 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:10.021 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
Tests run: 16, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 48.621 sec - in com.hubspot.singularity.scheduler.SingularityMachineStatesTest
16:50:10.506 [healthcheck-pool-0] WARN com.hubspot.singularity.scheduler.SingularityHealthchecker - Couldn't find a port for health check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional[http://uri], healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional.empty, startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional.empty, failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009409416-1-IMMEDIATE-1520009409416, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer948}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009409416-1-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}
16:50:10.509 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while saving health check result for test-request-firstDeployId-1520009409416-1-host1-rack1, will re-enqueue
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.TaskManager.canSaveNewHealthcheck(TaskManager.java:329)
	at com.hubspot.singularity.data.TaskManager.saveHealthcheckResult(TaskManager.java:318)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:83)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 15 common frames omitted
16:50:10.511 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while re-enqueuing health check for test-request-firstDeployId-1520009409416-1-host1-rack1, aborting
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@6aa7a869 rejected from java.util.concurrent.ScheduledThreadPoolExecutor@33719ea5[Shutting down, pool size = 3, active threads = 1, queued tasks = 2, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2047)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:823)
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326)
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheckWithDelay(SingularityHealthchecker.java:184)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheck(SingularityHealthchecker.java:103)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.reEnqueueOrAbort(SingularityHealthchecker.java:203)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:108)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
16:50:10.526 [healthcheck-pool-1] WARN com.hubspot.singularity.scheduler.SingularityHealthchecker - Couldn't find a port for health check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional[2], skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional[http://uri], healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional.empty, startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional.empty, failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009412416-2-IMMEDIATE-1520009412416, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer57}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009412416-2-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}
16:50:10.527 [healthcheck-pool-1] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while saving health check result for test-request-firstDeployId-1520009412416-2-host1-rack1, will re-enqueue
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.TaskManager.canSaveNewHealthcheck(TaskManager.java:329)
	at com.hubspot.singularity.data.TaskManager.saveHealthcheckResult(TaskManager.java:318)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:83)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 15 common frames omitted
16:50:10.530 [healthcheck-pool-1] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while re-enqueuing health check for test-request-firstDeployId-1520009412416-2-host1-rack1, aborting
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@5501a624 rejected from java.util.concurrent.ScheduledThreadPoolExecutor@33719ea5[Shutting down, pool size = 3, active threads = 1, queued tasks = 1, completed tasks = 1]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2047)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:823)
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326)
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheckWithDelay(SingularityHealthchecker.java:184)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheck(SingularityHealthchecker.java:103)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.reEnqueueOrAbort(SingularityHealthchecker.java:203)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:108)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
16:50:10.555 [healthcheck-pool-2] WARN com.hubspot.singularity.scheduler.SingularityHealthchecker - Couldn't find a port for health check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional[2], skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional[http://uri], healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional.empty, startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional.empty, failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009412416-3-IMMEDIATE-1520009412416, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer619}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009412416-3-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}
16:50:10.556 [healthcheck-pool-2] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while saving health check result for test-request-firstDeployId-1520009412416-3-host1-rack1, will re-enqueue
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.TaskManager.canSaveNewHealthcheck(TaskManager.java:329)
	at com.hubspot.singularity.data.TaskManager.saveHealthcheckResult(TaskManager.java:318)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:83)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 15 common frames omitted
16:50:10.557 [healthcheck-pool-2] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while re-enqueuing health check for test-request-firstDeployId-1520009412416-3-host1-rack1, aborting
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@38aec69e rejected from java.util.concurrent.ScheduledThreadPoolExecutor@33719ea5[Shutting down, pool size = 3, active threads = 1, queued tasks = 0, completed tasks = 2]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2047)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:823)
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326)
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheckWithDelay(SingularityHealthchecker.java:184)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheck(SingularityHealthchecker.java:103)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.reEnqueueOrAbort(SingularityHealthchecker.java:203)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:108)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
16:50:10.811 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while saving health check result for test-request-firstDeployId-1520009408736-1-host1-DEFAULT, will re-enqueue
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.TaskManager.canSaveNewHealthcheck(TaskManager.java:329)
	at com.hubspot.singularity.data.TaskManager.saveHealthcheckResult(TaskManager.java:318)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:83)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:302)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 15 common frames omitted
16:50:10.812 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while re-enqueuing health check for test-request-firstDeployId-1520009408736-1-host1-DEFAULT, aborting
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@3b25b7ff rejected from java.util.concurrent.ScheduledThreadPoolExecutor@15d20e40[Shutting down, pool size = 2, active threads = 1, queued tasks = 0, completed tasks = 1]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2047)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:823)
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326)
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheckWithDelay(SingularityHealthchecker.java:184)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheck(SingularityHealthchecker.java:103)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.reEnqueueOrAbort(SingularityHealthchecker.java:203)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:108)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:302)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
16:50:11.695 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:11.987 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:12.023 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:13.067 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:13.099 [check-new-task-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityNewTaskChecker - Uncaught throwable in task check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[true], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional.empty, skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009412082-2-IMMEDIATE-1520009412082, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer438}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009412082-2-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}, re-enqueing
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.DisasterManager.isDisabled(DisasterManager.java:55)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.hasHealthcheck(SingularityNewTaskChecker.java:96)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.getTaskState(SingularityNewTaskChecker.java:313)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.checkTask(SingularityNewTaskChecker.java:254)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.lambda$getTaskCheck$0(SingularityNewTaskChecker.java:209)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 13 common frames omitted
16:50:13.102 [check-new-task-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityNewTaskChecker - Uncaught throwable re-enqueuing task check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[true], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional.empty, skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009412082-2-IMMEDIATE-1520009412082, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer438}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009412082-2-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}, aborting
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@132e2091 rejected from java.util.concurrent.ScheduledThreadPoolExecutor@232e0d34[Shutting down, pool size = 2, active threads = 1, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2047)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:823)
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326)
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.enqueueCheckWithDelay(SingularityNewTaskChecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.reEnqueueCheck(SingularityNewTaskChecker.java:236)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.reEnqueueCheckOrAbort(SingularityNewTaskChecker.java:227)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.lambda$getTaskCheck$0(SingularityNewTaskChecker.java:220)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
16:50:13.794 [check-new-task-pool-1] ERROR com.hubspot.singularity.scheduler.SingularityNewTaskChecker - Uncaught throwable in task check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional[2], skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional[Resources{cpus=1.0, memoryMb=64.0, numPorts=3, diskMb=0.0}], command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional[1], portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional[0], startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional.empty, failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009408710-1-UPDATED_REQUEST-1520009408685, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer252}, allOtherFields={url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009408736-1-host1-DEFAULT}, executor=null, labels=MesosLabels{labels=[]}, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[MesosResourceObject{name=ports, ranges=MesosRangesObject{range=[MesosRangeObject{begin=80, end=82}]}, allOtherFields={type=RANGES}}, MesosResourceObject{name=cpus, ranges=null, allOtherFields={scalar={value=1.0}, type=SCALAR}}, MesosResourceObject{name=mem, ranges=null, allOtherFields={scalar={value=64.0}, type=SCALAR}}, MesosResourceObject{name=disk, ranges=null, allOtherFields={scalar={value=0.0}, type=SCALAR}}], allOtherFields={command={uris=[], environment={variables=[{name=TASK_DEPLOY_ID, value=firstDeployId}, {name=INSTANCE_NO, value=1}, {name=TASK_REQUEST_ID, value=test-request}, {name=PORT0, value=80}, {name=AVAILABILITY_ZONE, value=DEFAULT}, {name=PORT, value=80}, {name=ESTIMATED_INSTANCE_COUNT, value=2}, {name=TASK_HOST, value=host1}, {name=TASK_RACK_ID, value=DEFAULT}, {name=PORT1, value=81}, {name=PORT2, value=82}, {name=TASK_ID, value=test-request-firstDeployId-1520009408736-1-host1-DEFAULT}]}, value=sleep 100, arguments=[]}}, name=test-request}, rackId=Optional[DEFAULT]}, re-enqueing
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.DisasterManager.isDisabled(DisasterManager.java:55)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.hasHealthcheck(SingularityNewTaskChecker.java:96)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.getTaskState(SingularityNewTaskChecker.java:313)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.checkTask(SingularityNewTaskChecker.java:254)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.lambda$getTaskCheck$0(SingularityNewTaskChecker.java:209)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 13 common frames omitted
16:50:13.797 [check-new-task-pool-1] ERROR com.hubspot.singularity.scheduler.SingularityNewTaskChecker - Uncaught throwable re-enqueuing task check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional[2], skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional[Resources{cpus=1.0, memoryMb=64.0, numPorts=3, diskMb=0.0}], command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional[1], portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional[0], startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional.empty, failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009408710-1-UPDATED_REQUEST-1520009408685, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer252}, allOtherFields={url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009408736-1-host1-DEFAULT}, executor=null, labels=MesosLabels{labels=[]}, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[MesosResourceObject{name=ports, ranges=MesosRangesObject{range=[MesosRangeObject{begin=80, end=82}]}, allOtherFields={type=RANGES}}, MesosResourceObject{name=cpus, ranges=null, allOtherFields={scalar={value=1.0}, type=SCALAR}}, MesosResourceObject{name=mem, ranges=null, allOtherFields={scalar={value=64.0}, type=SCALAR}}, MesosResourceObject{name=disk, ranges=null, allOtherFields={scalar={value=0.0}, type=SCALAR}}], allOtherFields={command={uris=[], environment={variables=[{name=TASK_DEPLOY_ID, value=firstDeployId}, {name=INSTANCE_NO, value=1}, {name=TASK_REQUEST_ID, value=test-request}, {name=PORT0, value=80}, {name=AVAILABILITY_ZONE, value=DEFAULT}, {name=PORT, value=80}, {name=ESTIMATED_INSTANCE_COUNT, value=2}, {name=TASK_HOST, value=host1}, {name=TASK_RACK_ID, value=DEFAULT}, {name=PORT1, value=81}, {name=PORT2, value=82}, {name=TASK_ID, value=test-request-firstDeployId-1520009408736-1-host1-DEFAULT}]}, value=sleep 100, arguments=[]}}, name=test-request}, rackId=Optional[DEFAULT]}, aborting
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@4dd00203 rejected from java.util.concurrent.ScheduledThreadPoolExecutor@4317e5c9[Shutting down, pool size = 2, active threads = 1, queued tasks = 0, completed tasks = 1]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2047)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:823)
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326)
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.enqueueCheckWithDelay(SingularityNewTaskChecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.reEnqueueCheck(SingularityNewTaskChecker.java:236)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.reEnqueueCheckOrAbort(SingularityNewTaskChecker.java:227)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.lambda$getTaskCheck$0(SingularityNewTaskChecker.java:220)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
16:50:14.148 [healthcheck-pool-0] WARN com.hubspot.singularity.scheduler.SingularityHealthchecker - Couldn't find a port for health check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='new_task_healthcheck', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional.empty, arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional.empty, startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional[1], failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-new_task_healthcheck-1520009412068-1-IMMEDIATE-1520009412068, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer117}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-new_task_healthcheck-1520009412068-1-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}
16:50:14.150 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while saving health check result for test-request-new_task_healthcheck-1520009412068-1-host1-rack1, will re-enqueue
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.TaskManager.canSaveNewHealthcheck(TaskManager.java:329)
	at com.hubspot.singularity.data.TaskManager.saveHealthcheckResult(TaskManager.java:318)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:83)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 15 common frames omitted
16:50:14.152 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while re-enqueuing health check for test-request-new_task_healthcheck-1520009412068-1-host1-rack1, aborting
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.getChildren(CuratorManager.java:137)
	at com.hubspot.singularity.data.TaskManager.getNumNonstartupHealthchecks(TaskManager.java:518)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheck(SingularityHealthchecker.java:98)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.reEnqueueOrAbort(SingularityHealthchecker.java:203)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:108)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.getChildren(CuratorFrameworkImpl.java:379)
	at com.hubspot.singularity.data.CuratorManager.getChildren(CuratorManager.java:130)
	... 15 common frames omitted
16:50:14.232 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:14.376 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:15.320 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:15.442 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:15.677 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:15.827 [Time-limited test] WARN com.hubspot.singularity.mesos.SingularityMesosScheduler - Not using custom executor, will not send framework message to destroy task
16:50:15.831 [Time-limited test] WARN com.hubspot.singularity.mesos.SingularityMesosScheduler - Not using custom executor, will not send framework message to destroy task
16:50:15.832 [Time-limited test] WARN com.hubspot.singularity.scheduler.SingularityCleaner - All tasks for requestId test-request are now killed, re-enqueueing request cleanup
16:50:15.838 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009415722-1-host1-rack1
16:50:15.840 [status-updates-0] WARN com.hubspot.singularity.scheduler.SingularityScheduler - Not scheduling a new task, test-request is DELETING
16:50:15.849 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009415794-2-host1-rack1
16:50:15.852 [status-updates-0] WARN com.hubspot.singularity.scheduler.SingularityScheduler - Not scheduling a new task, test-request is DELETING
16:50:16.703 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:17.012 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:17.449 [healthcheck-pool-0] WARN com.hubspot.singularity.scheduler.SingularityHealthchecker - Couldn't find a port for health check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='hc_test', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional.empty, startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional[2], failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-hc_test-1520009415395-1-IMMEDIATE-1520009415395, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer554}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-hc_test-1520009415395-1-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}
16:50:17.450 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while saving health check result for test-request-hc_test-1520009415395-1-host1-rack1, will re-enqueue
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.TaskManager.canSaveNewHealthcheck(TaskManager.java:329)
	at com.hubspot.singularity.data.TaskManager.saveHealthcheckResult(TaskManager.java:318)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:83)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 15 common frames omitted
16:50:17.452 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while re-enqueuing health check for test-request-hc_test-1520009415395-1-host1-rack1, aborting
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.getChildren(CuratorManager.java:137)
	at com.hubspot.singularity.data.TaskManager.getNumNonstartupHealthchecks(TaskManager.java:518)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheck(SingularityHealthchecker.java:98)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.reEnqueueOrAbort(SingularityHealthchecker.java:203)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:108)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.getChildren(CuratorFrameworkImpl.java:379)
	at com.hubspot.singularity.data.CuratorManager.getChildren(CuratorManager.java:130)
	... 15 common frames omitted
16:50:17.653 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:17.935 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:18.359 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:19.176 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:19.794 [healthcheck-pool-0] WARN com.hubspot.singularity.scheduler.SingularityHealthchecker - Couldn't find a port for health check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='timeout_test', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional.empty, startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional[2], failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional[86400000], considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-timeout_test-1520005817669-1-IMMEDIATE-1520005817669, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer329}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-timeout_test-1520005817669-1-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}
16:50:19.796 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while saving health check result for test-request-timeout_test-1520005817669-1-host1-rack1, will re-enqueue
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.TaskManager.canSaveNewHealthcheck(TaskManager.java:329)
	at com.hubspot.singularity.data.TaskManager.saveHealthcheckResult(TaskManager.java:318)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:83)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 15 common frames omitted
16:50:19.799 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while re-enqueuing health check for test-request-timeout_test-1520005817669-1-host1-rack1, aborting
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.getChildren(CuratorManager.java:137)
	at com.hubspot.singularity.data.TaskManager.getNumNonstartupHealthchecks(TaskManager.java:518)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheck(SingularityHealthchecker.java:98)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.reEnqueueOrAbort(SingularityHealthchecker.java:203)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:108)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.getChildren(CuratorFrameworkImpl.java:379)
	at com.hubspot.singularity.data.CuratorManager.getChildren(CuratorManager.java:130)
	... 15 common frames omitted
16:50:20.019 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:20.767 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:20.832 [Time-limited test] WARN com.hubspot.singularity.scheduler.SingularityDeployChecker - Deploy SingularityPendingDeploy{deployMarker=SingularityDeployMarker{requestId='test-request', deployId='firstDeployId', timestamp=1520009420769, user=Optional.empty, message=Optional.empty}, lastLoadBalancerUpdate=Optional.empty, currentDeployState=WAITING, deployProgress=Optional[SingularityIncrementalDeployProgress{targetActiveInstances=1, currentActiveInstances=0, deployInstanceCountPerStep=1, deployStepWaitTimeMs=10, stepComplete=false, autoAdvanceDeploySteps=true, failedDeployTasks=[], timestamp=1520009420769}], updatedRequest=Optional.empty} request was MISSING, removing deploy
16:50:21.636 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:21.776 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-secondDeployId-1520009421741-1-host1-rack1
16:50:21.789 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009421661-1-host1-rack1
16:50:21.969 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:22.110 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009421995-1-host1-rack1
16:50:22.112 [status-updates-0] WARN com.hubspot.singularity.scheduler.SingularityScheduler - Not scheduling a new task, test-request is PAUSED
16:50:22.158 [healthcheck-pool-0] WARN com.hubspot.singularity.scheduler.SingularityHealthchecker - Couldn't find a port for health check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='retry_test', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional.empty, startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional[3], failureStatusCodes=Optional[[404]]}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-retry_test-1520009420097-1-IMMEDIATE-1520009420097, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer57}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-retry_test-1520009420097-1-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}
16:50:22.159 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while saving health check result for test-request-retry_test-1520009420097-1-host1-rack1, will re-enqueue
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.TaskManager.canSaveNewHealthcheck(TaskManager.java:329)
	at com.hubspot.singularity.data.TaskManager.saveHealthcheckResult(TaskManager.java:318)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:83)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 15 common frames omitted
16:50:22.161 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while re-enqueuing health check for test-request-retry_test-1520009420097-1-host1-rack1, aborting
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.getChildren(CuratorManager.java:137)
	at com.hubspot.singularity.data.TaskManager.getNumNonstartupHealthchecks(TaskManager.java:518)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheck(SingularityHealthchecker.java:98)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.reEnqueueOrAbort(SingularityHealthchecker.java:203)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:108)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.getChildren(CuratorFrameworkImpl.java:379)
	at com.hubspot.singularity.data.CuratorManager.getChildren(CuratorManager.java:130)
	... 15 common frames omitted
16:50:22.373 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:22.953 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:23.246 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:24.494 [healthcheck-pool-0] WARN com.hubspot.singularity.scheduler.SingularityHealthchecker - Couldn't find a port for health check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='retry_test', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional.empty, startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional[1], failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-retry_test-1520009422441-1-IMMEDIATE-1520009422441, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer379}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-retry_test-1520009422441-1-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}
16:50:24.495 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while saving health check result for test-request-retry_test-1520009422441-1-host1-rack1, will re-enqueue
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.TaskManager.canSaveNewHealthcheck(TaskManager.java:329)
	at com.hubspot.singularity.data.TaskManager.saveHealthcheckResult(TaskManager.java:318)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:83)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 15 common frames omitted
16:50:24.497 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while re-enqueuing health check for test-request-retry_test-1520009422441-1-host1-rack1, aborting
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.getChildren(CuratorManager.java:137)
	at com.hubspot.singularity.data.TaskManager.getNumNonstartupHealthchecks(TaskManager.java:518)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheck(SingularityHealthchecker.java:98)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.reEnqueueOrAbort(SingularityHealthchecker.java:203)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:108)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.getChildren(CuratorFrameworkImpl.java:379)
	at com.hubspot.singularity.data.CuratorManager.getChildren(CuratorManager.java:130)
	... 15 common frames omitted
16:50:24.700 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:25.384 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
Tests run: 12, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 65.058 sec - in com.hubspot.singularity.scheduler.SingularityHealthchecksTest
16:50:25.984 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:27.181 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:27.303 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009427206-1-host1-rack1
16:50:27.319 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009427282-1-host1-rack1
16:50:27.350 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009427332-1-host1-rack1
16:50:27.982 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:28.050 [Time-limited test] WARN com.hubspot.singularity.scheduler.SingularityDeployChecker - Deploy SingularityPendingDeploy{deployMarker=SingularityDeployMarker{requestId='test-request', deployId='secondDeployId', timestamp=1520009428016, user=Optional.empty, message=Optional.empty}, lastLoadBalancerUpdate=Optional.empty, currentDeployState=WAITING, deployProgress=Optional[SingularityIncrementalDeployProgress{targetActiveInstances=1, currentActiveInstances=0, deployInstanceCountPerStep=1, deployStepWaitTimeMs=0, stepComplete=false, autoAdvanceDeploySteps=false, failedDeployTasks=[], timestamp=1520009428016}], updatedRequest=Optional.empty} request was PAUSED, removing deploy
16:50:28.486 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:29.183 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:29.691 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:30.926 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:31.572 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:32.230 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
Tests run: 25, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 71.722 sec - in com.hubspot.singularity.scheduler.SingularityDeploysTest
16:50:33.423 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:33.544 [Time-limited test] WARN com.hubspot.singularity.mesos.SingularityMesosScheduler - Not using custom executor, will not send framework message to destroy task
16:50:33.548 [Time-limited test] WARN com.hubspot.singularity.scheduler.SingularityCleaner - All tasks for requestId test-request are now killed, re-enqueueing request cleanup
16:50:33.555 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009433449-1-host1-rack1
16:50:33.559 [status-updates-0] WARN com.hubspot.singularity.scheduler.SingularityScheduler - Not scheduling a new task, test-request is DELETING
16:50:34.738 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:37.046 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:38.327 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:39.583 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:40.845 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:42.067 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:43.400 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:45.628 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:45.748 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009445651-1-host1-rack1
16:50:45.762 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009445709-2-host1-rack1
16:50:45.771 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009445722-3-host1-rack1
16:50:45.814 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009445776-1-host1-rack1
16:50:45.823 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009445788-2-host1-rack1
16:50:45.831 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009445799-3-host1-rack1
16:50:45.842 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009445733-4-host1-rack1
16:50:47.014 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:47.060 [Time-limited test] ERROR com.hubspot.singularity.scheduler.SingularityCleaner - LB delete request SingularityLoadBalancerUpdate{loadBalancerState=FAILED, message=Optional.empty, timestamp=1520009447058, uri=Optional.empty, method=CHECK_STATE, loadBalancerRequestId=test-request-1520009447054-DELETE-1} (test-request-1520009447054-DELETE-1) got unexpected response FAILED
16:50:48.200 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:50.475 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:51.769 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:51.869 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009451793-1-host1-rack1
16:50:53.018 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:53.101 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009453038-1-host1-rack1
16:50:53.118 [Time-limited test] ERROR com.hubspot.singularity.scheduler.SingularityCleaner - LB removal request SingularityLoadBalancerUpdate{loadBalancerState=FAILED, message=Optional.empty, timestamp=1520009453116, uri=Optional.empty, method=CHECK_STATE, loadBalancerRequestId=test-request-firstDeployId-1520009453038-1-host1-rack1-REMOVE-1} (test-request-firstDeployId-1520009453038-1-host1-rack1-REMOVE-1) got unexpected response FAILED
16:50:54.253 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:55.547 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:56.716 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:58.011 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:59.288 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:50:59.372 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009459311-1-host1-rack1
16:51:00.567 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:01.738 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:03.398 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:04.587 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:06.699 [healthcheck-pool-0] WARN com.hubspot.singularity.scheduler.SingularityHealthchecker - Couldn't find a port for health check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional.empty, startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional.empty, failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009464687-2-IMMEDIATE-1520009464687, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave2}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host2, id=MesosStringValue{value=offer702}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009464687-2-host2-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave2}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}
16:51:06.700 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while saving health check result for test-request-firstDeployId-1520009464687-2-host2-rack1, will re-enqueue
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.TaskManager.canSaveNewHealthcheck(TaskManager.java:329)
	at com.hubspot.singularity.data.TaskManager.saveHealthcheckResult(TaskManager.java:318)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:83)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 15 common frames omitted
16:51:06.701 [healthcheck-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while re-enqueuing health check for test-request-firstDeployId-1520009464687-2-host2-rack1, aborting
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@679bba15 rejected from java.util.concurrent.ScheduledThreadPoolExecutor@695c5896[Shutting down, pool size = 3, active threads = 1, queued tasks = 2, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2047)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:823)
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326)
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheckWithDelay(SingularityHealthchecker.java:184)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheck(SingularityHealthchecker.java:103)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.reEnqueueOrAbort(SingularityHealthchecker.java:203)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:108)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
16:51:06.754 [healthcheck-pool-2] WARN com.hubspot.singularity.scheduler.SingularityHealthchecker - Couldn't find a port for health check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional[2], skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional[SEPARATE_BY_REQUEST], requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional.empty, startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional.empty, failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009464732-2-BOUNCE-1520009464701, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave3}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host3, id=MesosStringValue{value=offer615}, allOtherFields={url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009464737-2-host3-DEFAULT}, executor=null, labels=MesosLabels{labels=[]}, agentId=MesosStringValue{value=slave3}, slaveId=null, resources=[MesosResourceObject{name=cpus, ranges=null, allOtherFields={scalar={value=1.0}, type=SCALAR}}, MesosResourceObject{name=mem, ranges=null, allOtherFields={scalar={value=128.0}, type=SCALAR}}, MesosResourceObject{name=disk, ranges=null, allOtherFields={scalar={value=1024.0}, type=SCALAR}}], allOtherFields={command={uris=[], environment={variables=[{name=TASK_DEPLOY_ID, value=firstDeployId}, {name=INSTANCE_NO, value=2}, {name=TASK_REQUEST_ID, value=test-request}, {name=AVAILABILITY_ZONE, value=DEFAULT}, {name=ESTIMATED_INSTANCE_COUNT, value=2}, {name=TASK_HOST, value=host3}, {name=TASK_RACK_ID, value=DEFAULT}, {name=TASK_ID, value=test-request-firstDeployId-1520009464737-2-host3-DEFAULT}]}, value=sleep 100, arguments=[]}}, name=test-request}, rackId=Optional[DEFAULT]}
16:51:06.757 [healthcheck-pool-2] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while saving health check result for test-request-firstDeployId-1520009464737-2-host3-DEFAULT, will re-enqueue
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.TaskManager.canSaveNewHealthcheck(TaskManager.java:329)
	at com.hubspot.singularity.data.TaskManager.saveHealthcheckResult(TaskManager.java:318)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:83)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 15 common frames omitted
16:51:06.759 [healthcheck-pool-2] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while re-enqueuing health check for test-request-firstDeployId-1520009464737-2-host3-DEFAULT, aborting
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@6b95b099 rejected from java.util.concurrent.ScheduledThreadPoolExecutor@695c5896[Shutting down, pool size = 3, active threads = 1, queued tasks = 1, completed tasks = 1]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2047)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:823)
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326)
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheckWithDelay(SingularityHealthchecker.java:184)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheck(SingularityHealthchecker.java:103)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.reEnqueueOrAbort(SingularityHealthchecker.java:203)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:108)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
16:51:06.809 [healthcheck-pool-1] WARN com.hubspot.singularity.scheduler.SingularityHealthchecker - Couldn't find a port for health check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional[2], skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional[SEPARATE_BY_REQUEST], requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[false], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional[HealthcheckOptions{uri='http://uri', portIndex=Optional.empty, portNumber=Optional.empty, protocol=Optional.empty, startupTimeoutSeconds=Optional.empty, startupDelaySeconds=Optional.empty, startupIntervalSeconds=Optional.empty, intervalSeconds=Optional.empty, responseTimeoutSeconds=Optional.empty, maxRetries=Optional.empty, failureStatusCodes=Optional.empty}], skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009464794-1-TASK_DONE-1520009464783, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer634}, allOtherFields={url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009464797-1-host1-DEFAULT}, executor=null, labels=MesosLabels{labels=[]}, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[MesosResourceObject{name=cpus, ranges=null, allOtherFields={scalar={value=1.0}, type=SCALAR}}, MesosResourceObject{name=mem, ranges=null, allOtherFields={scalar={value=128.0}, type=SCALAR}}, MesosResourceObject{name=disk, ranges=null, allOtherFields={scalar={value=1024.0}, type=SCALAR}}], allOtherFields={command={uris=[], environment={variables=[{name=TASK_DEPLOY_ID, value=firstDeployId}, {name=INSTANCE_NO, value=1}, {name=TASK_REQUEST_ID, value=test-request}, {name=AVAILABILITY_ZONE, value=DEFAULT}, {name=ESTIMATED_INSTANCE_COUNT, value=2}, {name=TASK_HOST, value=host1}, {name=TASK_RACK_ID, value=DEFAULT}, {name=TASK_ID, value=test-request-firstDeployId-1520009464797-1-host1-DEFAULT}]}, value=sleep 100, arguments=[]}}, name=test-request}, rackId=Optional[DEFAULT]}
16:51:06.810 [healthcheck-pool-1] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while saving health check result for test-request-firstDeployId-1520009464797-1-host1-DEFAULT, will re-enqueue
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.TaskManager.canSaveNewHealthcheck(TaskManager.java:329)
	at com.hubspot.singularity.data.TaskManager.saveHealthcheckResult(TaskManager.java:318)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:83)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 15 common frames omitted
16:51:06.812 [healthcheck-pool-1] ERROR com.hubspot.singularity.scheduler.SingularityHealthchecker - Caught throwable while re-enqueuing health check for test-request-firstDeployId-1520009464797-1-host1-DEFAULT, aborting
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@5357a32a rejected from java.util.concurrent.ScheduledThreadPoolExecutor@695c5896[Shutting down, pool size = 3, active threads = 1, queued tasks = 0, completed tasks = 2]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2047)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:823)
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326)
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheckWithDelay(SingularityHealthchecker.java:184)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.enqueueHealthcheck(SingularityHealthchecker.java:103)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.reEnqueueOrAbort(SingularityHealthchecker.java:203)
	at com.hubspot.singularity.scheduler.SingularityHealthcheckAsyncHandler.saveResult(SingularityHealthcheckAsyncHandler.java:108)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.saveFailure(SingularityHealthchecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.asyncHealthcheck(SingularityHealthchecker.java:280)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker.access$000(SingularityHealthchecker.java:45)
	at com.hubspot.singularity.scheduler.SingularityHealthchecker$1.run(SingularityHealthchecker.java:189)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
16:51:07.949 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:10.182 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:10.186 [status-updates-0] ERROR com.hubspot.singularity.mesos.SingularityMesosStatusUpdateHandler - Unexpected taskId task 
com.hubspot.singularity.data.transcoders.SingularityTranscoderException: java.lang.reflect.InvocationTargetException
	at com.hubspot.singularity.data.transcoders.IdTranscoder.fromString(IdTranscoder.java:44)
	at com.hubspot.singularity.mesos.SingularityMesosStatusUpdateHandler.getTaskId(SingularityMesosStatusUpdateHandler.java:146)
	at com.hubspot.singularity.mesos.SingularityMesosStatusUpdateHandler.lambda$null$2(SingularityMesosStatusUpdateHandler.java:264)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1590)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.reflect.InvocationTargetException: null
	at sun.reflect.GeneratedMethodAccessor253.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at com.hubspot.singularity.data.transcoders.IdTranscoder.fromString(IdTranscoder.java:42)
	... 6 common frames omitted
Caused by: com.hubspot.singularity.exceptions.InvalidSingularityTaskIdException: TaskId task was invalid (There must be at least 5 instances of - (there were 0))
	at com.hubspot.singularity.api.task.SingularityTaskId.valueOf(SingularityTaskId.java:133)
	... 10 common frames omitted
16:51:10.266 [status-updates-0] ERROR com.hubspot.singularity.mesos.SingularityMesosStatusUpdateHandler - Task test-request-firstDeployId-1520009470204-1-host1-rack1 is active but is missing task data
16:51:10.274 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009470204-1-host1-rack1
16:51:11.404 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:12.733 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:15.061 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:16.212 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:17.385 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:17.511 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1519998677418-1-host1-rack1
16:51:17.543 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009476918-1-host1-rack1
16:51:19.698 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:20.977 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:21.076 [Time-limited test] WARN com.hubspot.singularity.mesos.SingularityMesosScheduler - Not using custom executor, will not send framework message to destroy task
16:51:21.079 [Time-limited test] WARN com.hubspot.singularity.scheduler.SingularityCleaner - All tasks for requestId test-request are now killed, re-enqueueing request cleanup
16:51:21.084 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009481001-1-host1-rack1
16:51:21.087 [status-updates-0] WARN com.hubspot.singularity.scheduler.SingularityScheduler - Not scheduling a new task, test-request is DELETING
16:51:22.256 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:23.434 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:23.514 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009483456-1-host1-rack1
16:51:23.539 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009483522-1-host1-rack1
16:51:24.667 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:25.954 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:27.143 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:27.271 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task lowPriorityRequest-lowPriorityDeploy-2-1-host1-rack1
16:51:29.430 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:30.650 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:30.770 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009490689-1-host1-rack1
16:51:30.772 [status-updates-0] WARN com.hubspot.singularity.scheduler.SingularityScheduler - Not scheduling a new task, test-request is DELETING
16:51:30.783 [Time-limited test] WARN com.hubspot.singularity.mesos.SingularityMesosScheduler - Not using custom executor, will not send framework message to destroy task
16:51:30.786 [Time-limited test] WARN com.hubspot.singularity.scheduler.SingularityCleaner - All tasks for requestId test-request are now killed, re-enqueueing request cleanup
16:51:30.793 [status-updates-0] WARN com.hubspot.singularity.mesos.SingularitySlaveAndRackManager - Couldn't find slave with id slave1 for task test-request-firstDeployId-1520009490745-2-host1-rack1
16:51:30.795 [status-updates-0] WARN com.hubspot.singularity.scheduler.SingularityScheduler - Not scheduling a new task, test-request is DELETING
16:51:31.933 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:33.209 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:34.427 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:35.509 [check-new-task-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityNewTaskChecker - Uncaught throwable in task check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[true], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional.empty, skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009494454-1-IMMEDIATE-1520009494454, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer16}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009494454-1-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}, re-enqueing
java.lang.RuntimeException: java.lang.IllegalStateException: instance must be started before calling this method
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:116)
	at com.hubspot.singularity.data.CuratorManager.exists(CuratorManager.java:121)
	at com.hubspot.singularity.data.DisasterManager.isDisabled(DisasterManager.java:55)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.hasHealthcheck(SingularityNewTaskChecker.java:96)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.getTaskState(SingularityNewTaskChecker.java:313)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.checkTask(SingularityNewTaskChecker.java:254)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.lambda$getTaskCheck$0(SingularityNewTaskChecker.java:209)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.IllegalStateException: instance must be started before calling this method
	at com.google.common.base.Preconditions.checkState(Preconditions.java:444)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkExists(CuratorFrameworkImpl.java:355)
	at com.hubspot.singularity.data.CuratorManager.checkExists(CuratorManager.java:108)
	... 13 common frames omitted
16:51:35.511 [check-new-task-pool-0] ERROR com.hubspot.singularity.scheduler.SingularityNewTaskChecker - Uncaught throwable re-enqueuing task check for task SingularityTask{taskRequest=SingularityTaskRequest{request=SingularityRequest{id='test-request', requestType=WORKER, owners=Optional.empty, numRetriesOnFailure=Optional.empty, schedule=Optional.empty, quartzSchedule=Optional.empty, scheduleType=Optional.empty, scheduleTimeZone=Optional.empty, killOldNonLongRunningTasksAfterMillis=Optional.empty, taskExecutionTimeLimitMillis=Optional.empty, scheduledExpectedRuntimeMillis=Optional.empty, waitAtLeastMillisAfterTaskFinishesForReschedule=Optional.empty, instances=Optional.empty, skipHealthchecks=Optional.empty, rackSensitive=Optional.empty, rackAffinity=Optional.empty, slavePlacement=Optional.empty, requiredSlaveAttributes=Optional.empty, allowedSlaveAttributes=Optional.empty, loadBalanced=Optional[true], group=Optional.empty, requiredRole=Optional.empty, readWriteGroups=Optional.empty, readOnlyGroups=Optional.empty, bounceAfterScale=Optional.empty, emailConfigurationOverrides=Optional.empty, hideEvenNumberAcrossRacksHint=Optional.empty, taskLogErrorRegex=Optional.empty, taskLogErrorRegexCaseSensitive=Optional.empty, taskPriorityLevel=Optional.empty, maxTasksPerOffer=Optional.empty, allowBounceToSameHost=Optional.empty, dataCenter=Optional.empty}, deploy=SingularityDeploy{requestId='test-request', id='firstDeployId', version=Optional.empty, timestamp=Optional.empty, metadata=Optional.empty, containerInfo=Optional.empty, customExecutorCmd=Optional.empty, customExecutorId=Optional.empty, customExecutorSource=Optional.empty, customExecutorResources=Optional.empty, resources=Optional.empty, command=Optional[sleep 100], arguments=Optional.empty, env=Optional.empty, runImmediatelyOptional.empty, uris=Optional.empty, executorData=Optional.empty, labels=Optional.empty, mesosLabels=Optional.empty, taskLabels=Optional.empty, mesosTaskLabels=Optional.empty, taskEnv=Optional.empty, healthcheckUri=Optional.empty, healthcheckIntervalSeconds=Optional.empty, healthcheckTimeoutSeconds=Optional.empty, healthcheckPortIndex=Optional.empty, healthcheckProtocol=Optional.empty, healthcheckMaxRetries=Optional.empty, healthcheckMaxTotalTimeoutSeconds=Optional.empty, healthcheck=Optional.empty, skipHealthchecksOnDeploy=Optional.empty, deployHealthTimeoutSeconds=Optional.empty, considerHealthyAfterRunningForSeconds=Optional.empty, serviceBasePath=Optional.empty, loadBalancerGroups=Optional.empty, loadBalancerPortIndex=Optional.empty, loadBalancerOptions=Optional.empty, loadBalancerDomains=Optional.empty, loadBalancerAdditionalRoutes=Optional.empty, loadBalancerTemplate=Optional.empty, loadBalancerServiceIdOverride=Optional.empty, loadBalancerUpstreamGroup=Optional.empty, deployInstanceCountPerStep=Optional.empty, deployStepWaitTimeMs=Optional.empty, autoAdvanceDeploySteps=Optional.empty, maxTaskRetries=Optional.empty, shell=Optional.empty, user=Optional.empty}, pendingTask=SingularityPendingTask{user=Optional.empty, pendingTaskId=test-request-firstDeployId-1520009494454-1-IMMEDIATE-1520009494454, cmdLineArgsList=Optional.empty, runId=Optional.empty, skipHealthchecks=Optional.empty, message=Optional.empty, resources=Optional.empty, s3UploaderAdditionalFiles=[], runAsUserOverride=Optional.empty, envOverrides={}, extraArtifacts=[], actionId=Optional.empty}}, offer=[MesosOfferObject{agentId=MesosStringValue{value=slave1}, slaveId=null, frameworkId=MesosStringValue{value=framework1}, hostname=host1, id=MesosStringValue{value=offer16}, allOtherFields={resources=[{name=cpus, type=SCALAR, scalar={value=125.0}}, {name=mem, type=SCALAR, scalar={value=1024.0}}, {name=disk, type=SCALAR, scalar={value=2048.0}}, {name=ports, type=RANGES, ranges={range=[]}}], attributes=[{name=rackid, type=TEXT, text={value=DEFAULT}}], executorIds=[], url={scheme=scheme, address={port=8080}, query=[]}}}], mesosTask=MesosTaskObject{taskId=MesosStringValue{value=test-request-firstDeployId-1520009494454-1-host1-rack1}, executor=MesosExecutorInfo{executorId=MesosStringValue{value=executorID}, unknownFields={resources=[]}}, labels=null, agentId=MesosStringValue{value=slave1}, slaveId=null, resources=[], allOtherFields={}, name=name}, rackId=Optional[rack1]}, aborting
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@3d9cdf77 rejected from java.util.concurrent.ScheduledThreadPoolExecutor@86f9929[Shutting down, pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
	at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2047)
	at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:823)
	at java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:326)
	at java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:533)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.enqueueCheckWithDelay(SingularityNewTaskChecker.java:242)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.reEnqueueCheck(SingularityNewTaskChecker.java:236)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.reEnqueueCheckOrAbort(SingularityNewTaskChecker.java:227)
	at com.hubspot.singularity.scheduler.SingularityNewTaskChecker.lambda$getTaskCheck$0(SingularityNewTaskChecker.java:220)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
16:51:36.637 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:37.855 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
16:51:39.055 [Time-limited test] WARN com.hubspot.singularity.data.zkmigrations.PendingRequestDataMigration - Starting migration to re-write pending request paths
Tests run: 73, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 138.132 sec - in com.hubspot.singularity.scheduler.SingularitySchedulerTest

Results :

Tests in error: 
  SingularityMesosOfferSchedulerTest.<init>:87 Mockito 
Cannot mock/spy class co...
  SingularityMesosOfferSchedulerTest.<init>:87 Mockito 
Cannot mock/spy class co...
  SingularityMesosOfferSchedulerTest.<init>:87 Mockito 
Cannot mock/spy class co...
  SingularityMesosOfferSchedulerTest.<init>:87 Mockito 
Cannot mock/spy class co...
  SingularityMesosOfferSchedulerTest.<init>:87 Mockito 
Cannot mock/spy class co...

Tests run: 260, Failures: 0, Errors: 5, Skipped: 0

[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary:
[INFO] 
[INFO] Singularity ........................................ SUCCESS [  2.119 s]
[INFO] SingularityBase .................................... SUCCESS [  3.368 s]
[INFO] SingularityMesosClient ............................. SUCCESS [  2.251 s]
[INFO] SingularityUI ...................................... SUCCESS [02:37 min]
[INFO] SingularityService ................................. FAILURE [02:39 min]
[INFO] SingularityRunnerBase .............................. SKIPPED
[INFO] SingularityS3Base .................................. SKIPPED
[INFO] SingularityClient .................................. SKIPPED
[INFO] SingularityExecutor ................................ SKIPPED
[INFO] SingularityExecutorCleanup ......................... SKIPPED
[INFO] SingularityS3Uploader .............................. SKIPPED
[INFO] SingularityS3Downloader ............................ SKIPPED
[INFO] EmbedSingularityExample ............................ SKIPPED
[INFO] SingularityServiceIntegrationTests ................. SKIPPED
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 05:25 min
[INFO] Finished at: 2018-03-02T17:51:39+01:00
[INFO] Final Memory: 147M/2483M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.19.1:test (default-test) on project SingularityService: There are test failures.
[ERROR] 
[ERROR] Please refer to /root/workspace/HubSpot/Singularity/348290188/SingularityService/target/surefire-reports for the individual test results.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
[ERROR] 
[ERROR] After correcting the problems, you can resume the build with the command
[ERROR]   mvn <goals> -rf :SingularityService
