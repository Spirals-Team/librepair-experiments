<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>NameValidator.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">data-validation</a> &gt; <a href="index.source.html" class="el_package">org.molgenis.data.validation.meta</a> &gt; <span class="el_source">NameValidator.java</span></div><h1>NameValidator.java</h1><pre class="source lang-java linenums">package org.molgenis.data.validation.meta;

import com.google.common.collect.ImmutableSet;
import org.molgenis.data.MolgenisDataException;

import java.util.Set;

/**
 * Validates if metadata is internally consistent and correct.
 */
<span class="nc" id="L11">public class NameValidator</span>
{
	// some words are reserved for the RestAPI and default packages/entities/attributes, etc.
<span class="fc" id="L14">	public static final Set&lt;String&gt; KEYWORDS = ImmutableSet.of(&quot;login&quot;, &quot;logout&quot;, &quot;csv&quot;, &quot;base&quot;, &quot;exist&quot;, &quot;meta&quot;, &quot;_idValue&quot;);</span>

	/**
	 * Checks if a name is a reserved keyword.
	 */
	private static void checkForKeyword(String name)
	{
<span class="pc bpc" id="L21" title="1 of 4 branches missed.">		if (KEYWORDS.contains(name) || KEYWORDS.contains(name.toUpperCase()))</span>
		{
<span class="fc" id="L23">			throw new MolgenisDataException(&quot;Name [&quot; + name + &quot;] is not allowed because it is a reserved keyword.&quot;);</span>
		}
<span class="fc" id="L25">	}</span>

	/**
	 * Validates names of entities, packages and attributes. Rules: only [a-zA-Z0-9_#] are allowed, name must start with
	 * a letter
	 */
	public static void validateAttributeName(String name)
	{
<span class="fc" id="L33">		checkForKeyword(name);</span>

<span class="fc" id="L35">		validateName(name);</span>

<span class="fc bfc" id="L37" title="All 2 branches covered.">		if (!name.matches(&quot;[a-zA-Z0-9_#]+(-[a-z]{2,3})??$&quot;))</span>
		{
<span class="fc" id="L39">			throw new MolgenisDataException(&quot;Invalid characters in: [&quot; + name</span>
					+ &quot;] Only letters (a-z, A-Z), digits (0-9), underscores (_) and hashes (#) are allowed.&quot;);
		}

<span class="fc" id="L43">	}</span>

	public static void validateEntityName(String name)
	{
<span class="fc" id="L47">		checkForKeyword(name);</span>
<span class="fc" id="L48">		validateName(name);</span>
<span class="fc" id="L49">		checkForIllegalCharacters(name);</span>
<span class="fc" id="L50">	}</span>

	public static void validatePackageId(String name)
	{
<span class="fc" id="L54">		validateName(name);</span>
<span class="fc" id="L55">		checkForIllegalCharacters(name);</span>
<span class="fc" id="L56">	}</span>

	private static void validateName(String name)
	{
<span class="fc bfc" id="L60" title="All 2 branches covered.">		if (Character.isDigit(name.charAt(0)))</span>
		{
<span class="fc" id="L62">			throw new MolgenisDataException(&quot;Invalid name: [&quot; + name + &quot;] Names must start with a letter.&quot;);</span>
		}
<span class="fc" id="L64">	}</span>

	private static void checkForIllegalCharacters(String name)
	{
<span class="fc bfc" id="L68" title="All 2 branches covered.">		if (!name.matches(&quot;[a-zA-Z0-9_#]+(-[a-z]{2,3})??$&quot;)) // FIXME too restrictive</span>
		{
<span class="fc" id="L70">			throw new MolgenisDataException(&quot;Invalid characters in: [&quot; + name</span>
					+ &quot;] Only letters (a-z, A-Z), digits (0-9), underscores(_) and hashes (#) are allowed.&quot;);
		}
<span class="fc" id="L73">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>